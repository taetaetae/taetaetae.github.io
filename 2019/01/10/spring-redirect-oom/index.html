<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Spring MVC Redirect ì²˜ë¦¬ì¤‘ì— ë°œìƒí•œ Out Of Memory ì›ì¸ ë¶„ì„í•˜ê¸° - ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</title><meta name=Description content><meta property="og:title" content="Spring MVC Redirect ì²˜ë¦¬ì¤‘ì— ë°œìƒí•œ Out Of Memory ì›ì¸ ë¶„ì„í•˜ê¸°"><meta property="og:description" content="ì´ˆì°½ê¸° ì‹ ì…ì‹œì ˆì— ë°°ìš°ê±°ë‚˜ ì‚¬ìš©í–ˆë˜ ê¸°ìˆ ì ì¸ ë°©ë²•ë“¤ì´ ìˆë‹¤. ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ì™ ë§Œí•´ì„  ë‹¤ë¥¸ë°©ë²•ì€ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ í•˜ê³  ìŠµê´€ì²˜ëŸ¼ ê¸°ì¡´ì— ì‚¬ìš©í–ˆë˜ ë°©ë²•ì„ ê³ ìˆ˜í•˜ëŠ” ë²„ë¦‡ì´ ìˆë‹¤. ê·¸ ì´ìœ ëŠ” ê³¼ê±°ì— ì‚¬ìš©í–ˆì„ë•Œ ì•„ë¬´ íƒˆ ì—†ì´ ì˜ ë˜ì—ˆê¸° ë•Œë¬¸ì—, ê·¸ë¦¬ê³  ë¹ ë¥¸ êµ¬í˜„ ë•Œë¬¸ì´ë¼ëŠ” í•‘ê³„ì¼ ê²ƒ ê°™ë‹¤. ì´ëŸ¬í•œ ë²„ë¦‡ì€ ë¹„ë‹¨ ì´ ê¸€ì„ ì ê³ ìˆëŠ” í•„ì ë¿ë§Œì´ ì•„ë‹ˆë¼ ëŒ€ë¶€ë¶„ì˜ ê°œë°œìë“¤ì´ ê°€ì§€ê³  ìˆì„êº¼ë¼ ì¡°ì‹¬ìŠ¤ë ˆ ì¶”ì¸¡í•´ë³¸ë‹¤. (ì•„ë‹ˆë¼ë©´&mldr;ë”ìš± ë¶„ë°œ í•´ì•¼ê² ë‹¤&mldr;ã… ) ìµœê·¼ ìš´ì˜í•˜ê³  ìˆëŠ” ì„œë¹„ìŠ¤ì—ì„œ ì¥ì•  ìƒí™©ê¹Œì§€ ê°ˆìˆ˜ìˆëŠ” ìœ„í—˜í•œ ìƒí™©ì´ ìˆì—ˆëŠ”ë° íŒ€ë‚´ ì½”ë“œë¦¬ë·°ë¥¼ í†µí•´ ë¬¸ì œì ì„ íŒŒì•…í•  ìˆ˜ ìˆì—ˆë‹¤. ê·¸ ì›ì¸ì€ Spring MVC Controller ë ˆë²¨ì—ì„œ redirect ì²˜ë¦¬ë¥¼ í• ë•Œ returnê°’ì˜ Cardinalityê°€ ë†’ì„ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤ê³ &mldr;
@RequestMapping(value = &#34;/test&#34;, method = RequestMethod.GET) public String test() { String url = &#34;ì–´ë– í•œ ë¡œì§ì— ì˜í•´ ìƒì„±ë˜ëŠ” url&#34;; return &#34;redirect:&#34; + url; // <- ìœ„í—˜ í¬ì¸íŠ¸! } ì´ ì½”ë“œê°€ ì™œ? ì–´ë””ê°€ ì–´ë•Œì„œ? ì´ì œê¹Œì§€ Controller ë ˆë²¨ì—ì„œ redirect ì²˜ë¦¬ë¥¼ í• ë•Œ ì•„ë¬´ìƒê°ì—†ì´ ìœ„ì— ìˆëŠ” ì½”ë“œ í˜•íƒœë¡œ êµ¬í˜„ì„ í–ˆëŠ”ë° ì €ëŸ¬í•œ ì½”ë“œ ë•Œë¬¸ì— OOMì´ ë°œìƒí•˜ì—¬ fullGC ê°€ ì—¬ëŸ¬ë²ˆ ë°œìƒí•˜ê³ , ì¼ì‹œì ìœ¼ë¡œ ì„œë¹„ìŠ¤ê°€ ì§€ì—°ë˜ëŠ” í˜„ìƒì´ ë°œìƒí–ˆë‹¤ê³  í•œë‹¤. ìì£¼ ì‚¬ìš©í•˜ë˜ ë°©ë²•ì´ì˜€ëŠ”ë° ì¥ì• ë¥¼ ìœ ë°œí• ìˆ˜ ìˆëŠ” ìœ„í—˜í•œ ë°©ë²•ì´ì˜€ë‹¤ë‹ˆ&mldr; ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì´ëŸ¬í•œ ë°©ë²•ì´ ì™œ ì˜ëª»ë˜ì—ˆëŠ”ì§€ ì‹¤ì œë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ëª¸ì†Œ(?) ì²´ê°ì„ í•´ë³´ê³ , ê·¸ëŸ¼ ì–´ë–¤ ë°©ë²•ìœ¼ë¡œ redirect ì²˜ë¦¬ë¥¼ í•´ì•¼ í•˜ëŠ”ê°€ì™€ ê°œì„ ì„ í•¨ìœ¼ë¡œì¨ ê¸°ì¡´ë°©ì‹ì— ë¹„í•´ ì–´ë–¤ì ì´ ì¢‹ì•„ì¡ŒëŠ”ì§€ì— ëŒ€í•´ì„œ ì •ë¦¬í•´ë³´ê³ ì í•œë‹¤.
 ë­”ê°€ ë‚´ê²ƒìœ¼ë¡œ ë§Œë“¤ê¸° ì‹œë¦¬ì¦ˆë¬¼ì´ ë‚˜ì˜¬ê²ƒë§Œ ê°™ì€ ëŠë‚Œì´ë‹¤&mldr;
 ê¸°ì¡´ë°©ì‹ì˜ ë¬¸ì œì  ì¬í˜„ ë° ë‹¤ì–‘í•œ ì›ì¸ë¶„ì„ ê¸°ì¡´ë°©ì‹ìœ¼ë¡œ í–ˆì„ë•Œ ì™œ OOMì´ ë°œìƒí–ˆì„ê¹Œ? ìš°ë¦¬ëŠ” ê°œë°œìì´ê¸° ë•Œë¬¸ì— ì´ëŸ°ì €ëŸ° ê¸€ë“¤ë§Œ ë³´ê³  ì¶”ì¸¡ í• ê²ƒì´ ì•„ë‹ˆë¼ ì§ì ‘ ì¬í˜„ì„ í•´ë³´ê³  ë‹¤ì–‘í•œ ì‹œê°ì—ì„œ ì›ì¸ë¶„ì„ì„ í•´ë³´ì. ë¨¼ì € ê¸°ë³¸ì ì¸ Spring MVC ë¼ˆëŒ€ë¥¼ ë§Œë“¤ê³  redirect í•˜ëŠ” return ê°’ì˜ Cardinalityê°€ ë†’ë„ë¡ random string ì„ ë§Œë“¤ì–´ ì£¼ë„ë¡ í•œë‹¤. ì¦‰, /randomì„ í˜¸ì¶œí•˜ë©´ /result/ETmHfowFkUì²˜ëŸ¼ random string ì´ ë§Œë“¤ì–´ ì§€ë©° redirect ì²˜ë¦¬ê°€ ë˜ëŠ” ë§¤ìš° ì‹¬í”Œí•œ êµ¬ì¡°ì´ë‹¤.
// Spring ë²„ì „ì€ 4.0.6.RELEASE @Controller @RequestMapping(&#34;/&#34;) public class TestController { @RequestMapping(value = &#34;random&#34;, method = RequestMethod.GET) public String random() { return &#34;redirect:result/&#34; + UUID.randomUUID(); } @RequestMapping(value = &#34;result/{message}&#34;, method = RequestMethod.GET) public String result(ModelMap model, @PathVariable String message) { model.addAttribute(&#34;message&#34;, message); return &#34;result&#34;; } } ë˜í•œ í•´ë‹¹ í”„ë¡œì íŠ¸ì—ì„œëŠ” AOPë¥¼ ì‚¬ìš©í•˜ê³  ìˆì—ˆê¸° ë•Œë¬¸ì— ê·¸ë•Œì™€ ë™ì¼í•œ ìƒí™©ìœ¼ë¡œ ì¬í˜„ì„ í•˜ê¸° ìœ„í•´ AOPê´€ë ¨ ì„¤ì •ë„ ì¶”ê°€í•´ì¤€ë‹¤.
@Configuration @EnableWebMvc @EnableAspectJAutoProxy @ComponentScan public class HelloWorldConfiguration { @Bean(name=&#34;HelloWorld&#34;) public ViewResolver viewResolver() { InternalResourceViewResolver viewResolver = new InternalResourceViewResolver(); viewResolver.setViewClass(JstlView.class); viewResolver.setPrefix(&#34;/WEB-INF/views/&#34;); viewResolver.setSuffix(&#34;.jsp&#34;); return viewResolver; } } ì´ë ‡ê²Œ í•œë’¤ tomcatìœ¼ë¡œ ìµœëŒ€/ìµœì†Œ ë©”ëª¨ë¦¬ë¥¼ 256mìœ¼ë¡œ ì„¤ì •í›„ í•´ë‹¹ ëª¨ë“ˆì„ ë„ì›Œì¤€ë‹¤. ê·¸ë‹¤ìŒ ë©”ëª¨ë¦¬ ìƒíƒœë¥¼ ë³´ê¸° ìœ„í•´ tomcatì— pinpointë¥¼ ì—°ë™í•˜ê³  ë§ˆì§€ë§‰ìœ¼ë¡œ í˜¸ì¶œí…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ nGrinderì„ ì„¤ì •í•´ì¤€ë‹¤. íŠ¹ë³„í•œ ì„¤ì •ì€ ì—†ê³  ìœ„ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ url (/random) ì„ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œí•˜ë„ë¡ í•˜ì˜€ë‹¤. nGrinderì„ ì„¤ì •í•˜ëŠ”ëŒ€ì—ëŠ” ì´ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ ì°¸ê³ í•´ì„œ ì„¤ì •í•˜ì˜€ë‹¤.
ì, ì´ì œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•´ë³´ì. (ë§ˆì¹˜ ìˆ˜ìˆ  ì§‘ë„í•˜ëŠ”ê²ƒ ê°™ì€ ê¸°ë¶„ìœ¼ë¡œ&mldr;ê°„í˜¸ì‚¬~ ì¹¼!)
 nGrinder nGrinderì˜ ê¸°ë³¸ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ urlë§Œ í•´ë‹¹ ì„œë²„ë¡œ í˜¸ì¶œë˜ë„ë¡ ë°”ê¿”ì£¼ê³  ì´ ê°€ìƒ ì‚¬ìš©ìëŠ” 2,000ìœ¼ë¡œ ì‹œê°„ì€ 5ë¶„ìœ¼ë¡œ ì„¤ì •í›„ì— í…ŒìŠ¤íŠ¸ ì‹œì‘ì„ í•˜ì˜€ë”ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ ê·¸ë˜í”„ë¥¼ ë³¼ìˆ˜ ìˆì—ˆë‹¤.   TPSê°€ ë¶ˆì•ˆì •í•´ì§€ë‹¤ê°€ ì–´ëŠì‹œì ë¶€í„° ë‚®ì•„ì§€ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ê²Œ ì„œë¹„ìŠ¤ ì˜€ë‹¤ë©´ ì‚¬ìš©ìê°€ ì ‘ì†í•˜ëŠ”ë° ë¶ˆí¸ì„ ëŠê¼ˆì„êº¼ë¼ ì¶”ì¸¡ì„ í•´ë³¸ë‹¤. ë˜í•œ ì•„ì£¼ ê°„ë‹¨í•œ random string ì„ ë¦¬í„´í•˜ëŠ” í˜ì´ì§€ ì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ì—ëŸ¬ ì‘ë‹µì´ ì ì§€ ì•Šì€ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.
pinpoint ë©”ëª¨ë¦¬ ìƒíƒœëŠ” ì–´ë–¤ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ pinpointë¥¼ í™•ì¸í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê·¸ë˜í”„ë¥¼ ë³¼ìˆ˜ ìˆì—ˆë‹¤.   ë³´ê¸°ë§Œí•´ë„ ì‹¬ì¥ì´ ë²Œë ë²Œë (?) ë›¸ ì •ë„ë¡œ ë¬´ì„œìš´ ê·¸ë¦¼ì´ë‹¤. ì‹¤ì œë¡œ ì„œë¹„ìŠ¤ì— (ì´ì •ë„ê¹Œì§„ ì•„ë‹ˆì˜€ì§€ë§Œ) ë¹„ìŠ·í•œ ìƒí™©ì´ ë°œìƒí–ˆì—ˆë‹¤. ë©”ëª¨ë¦¬ê°€ í…ŒìŠ¤íŠ¸ë¥¼ ì ì  í•˜ë©´ í• ìˆ˜ë¡ ì˜¬ë¼ê°€ë‹¤ê°€ fullGCê°€ ë°œìƒí•˜ë”ë‹ˆ ëŒ€ë‚˜ë¬´ ìˆ²ì— ìˆëŠ” ëŒ€ë‚˜ë¬´ë§ˆëƒ¥ fullGCê°€ ë¹¼ê³¡íˆ ë°œìƒí•˜ì˜€ë‹¤. (ì´ëŸ¬ë‹ˆ&mldr; í˜ì´ì§€ ì ‘ê·¼ì— ì§€ì—°ì´ ìƒê¸´ê²ƒ ê°™ë‹¤."><meta property="og:type" content="article"><meta property="og:url" content="https://taetaetae.github.io/2019/01/10/spring-redirect-oom/"><meta property="og:image" content="https://taetaetae.github.io/images/spring-redirect-oom/test1-pinpoint.jpg"><meta property="article:published_time" content="2019-01-10T18:39:47+00:00"><meta property="article:modified_time" content="2019-01-10T18:39:47+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://taetaetae.github.io/images/spring-redirect-oom/test1-pinpoint.jpg"><meta name=twitter:title content="Spring MVC Redirect ì²˜ë¦¬ì¤‘ì— ë°œìƒí•œ Out Of Memory ì›ì¸ ë¶„ì„í•˜ê¸°"><meta name=twitter:description content="ì´ˆì°½ê¸° ì‹ ì…ì‹œì ˆì— ë°°ìš°ê±°ë‚˜ ì‚¬ìš©í–ˆë˜ ê¸°ìˆ ì ì¸ ë°©ë²•ë“¤ì´ ìˆë‹¤. ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ì™ ë§Œí•´ì„  ë‹¤ë¥¸ë°©ë²•ì€ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ í•˜ê³  ìŠµê´€ì²˜ëŸ¼ ê¸°ì¡´ì— ì‚¬ìš©í–ˆë˜ ë°©ë²•ì„ ê³ ìˆ˜í•˜ëŠ” ë²„ë¦‡ì´ ìˆë‹¤. ê·¸ ì´ìœ ëŠ” ê³¼ê±°ì— ì‚¬ìš©í–ˆì„ë•Œ ì•„ë¬´ íƒˆ ì—†ì´ ì˜ ë˜ì—ˆê¸° ë•Œë¬¸ì—, ê·¸ë¦¬ê³  ë¹ ë¥¸ êµ¬í˜„ ë•Œë¬¸ì´ë¼ëŠ” í•‘ê³„ì¼ ê²ƒ ê°™ë‹¤. ì´ëŸ¬í•œ ë²„ë¦‡ì€ ë¹„ë‹¨ ì´ ê¸€ì„ ì ê³ ìˆëŠ” í•„ì ë¿ë§Œì´ ì•„ë‹ˆë¼ ëŒ€ë¶€ë¶„ì˜ ê°œë°œìë“¤ì´ ê°€ì§€ê³  ìˆì„êº¼ë¼ ì¡°ì‹¬ìŠ¤ë ˆ ì¶”ì¸¡í•´ë³¸ë‹¤. (ì•„ë‹ˆë¼ë©´&mldr;ë”ìš± ë¶„ë°œ í•´ì•¼ê² ë‹¤&mldr;ã… ) ìµœê·¼ ìš´ì˜í•˜ê³  ìˆëŠ” ì„œë¹„ìŠ¤ì—ì„œ ì¥ì•  ìƒí™©ê¹Œì§€ ê°ˆìˆ˜ìˆëŠ” ìœ„í—˜í•œ ìƒí™©ì´ ìˆì—ˆëŠ”ë° íŒ€ë‚´ ì½”ë“œë¦¬ë·°ë¥¼ í†µí•´ ë¬¸ì œì ì„ íŒŒì•…í•  ìˆ˜ ìˆì—ˆë‹¤. ê·¸ ì›ì¸ì€ Spring MVC Controller ë ˆë²¨ì—ì„œ redirect ì²˜ë¦¬ë¥¼ í• ë•Œ returnê°’ì˜ Cardinalityê°€ ë†’ì„ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤ê³ &mldr;
@RequestMapping(value = &#34;/test&#34;, method = RequestMethod.GET) public String test() { String url = &#34;ì–´ë– í•œ ë¡œì§ì— ì˜í•´ ìƒì„±ë˜ëŠ” url&#34;; return &#34;redirect:&#34; + url; // <- ìœ„í—˜ í¬ì¸íŠ¸! } ì´ ì½”ë“œê°€ ì™œ? ì–´ë””ê°€ ì–´ë•Œì„œ? ì´ì œê¹Œì§€ Controller ë ˆë²¨ì—ì„œ redirect ì²˜ë¦¬ë¥¼ í• ë•Œ ì•„ë¬´ìƒê°ì—†ì´ ìœ„ì— ìˆëŠ” ì½”ë“œ í˜•íƒœë¡œ êµ¬í˜„ì„ í–ˆëŠ”ë° ì €ëŸ¬í•œ ì½”ë“œ ë•Œë¬¸ì— OOMì´ ë°œìƒí•˜ì—¬ fullGC ê°€ ì—¬ëŸ¬ë²ˆ ë°œìƒí•˜ê³ , ì¼ì‹œì ìœ¼ë¡œ ì„œë¹„ìŠ¤ê°€ ì§€ì—°ë˜ëŠ” í˜„ìƒì´ ë°œìƒí–ˆë‹¤ê³  í•œë‹¤. ìì£¼ ì‚¬ìš©í•˜ë˜ ë°©ë²•ì´ì˜€ëŠ”ë° ì¥ì• ë¥¼ ìœ ë°œí• ìˆ˜ ìˆëŠ” ìœ„í—˜í•œ ë°©ë²•ì´ì˜€ë‹¤ë‹ˆ&mldr; ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì´ëŸ¬í•œ ë°©ë²•ì´ ì™œ ì˜ëª»ë˜ì—ˆëŠ”ì§€ ì‹¤ì œë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ëª¸ì†Œ(?) ì²´ê°ì„ í•´ë³´ê³ , ê·¸ëŸ¼ ì–´ë–¤ ë°©ë²•ìœ¼ë¡œ redirect ì²˜ë¦¬ë¥¼ í•´ì•¼ í•˜ëŠ”ê°€ì™€ ê°œì„ ì„ í•¨ìœ¼ë¡œì¨ ê¸°ì¡´ë°©ì‹ì— ë¹„í•´ ì–´ë–¤ì ì´ ì¢‹ì•„ì¡ŒëŠ”ì§€ì— ëŒ€í•´ì„œ ì •ë¦¬í•´ë³´ê³ ì í•œë‹¤.
 ë­”ê°€ ë‚´ê²ƒìœ¼ë¡œ ë§Œë“¤ê¸° ì‹œë¦¬ì¦ˆë¬¼ì´ ë‚˜ì˜¬ê²ƒë§Œ ê°™ì€ ëŠë‚Œì´ë‹¤&mldr;
 ê¸°ì¡´ë°©ì‹ì˜ ë¬¸ì œì  ì¬í˜„ ë° ë‹¤ì–‘í•œ ì›ì¸ë¶„ì„ ê¸°ì¡´ë°©ì‹ìœ¼ë¡œ í–ˆì„ë•Œ ì™œ OOMì´ ë°œìƒí–ˆì„ê¹Œ? ìš°ë¦¬ëŠ” ê°œë°œìì´ê¸° ë•Œë¬¸ì— ì´ëŸ°ì €ëŸ° ê¸€ë“¤ë§Œ ë³´ê³  ì¶”ì¸¡ í• ê²ƒì´ ì•„ë‹ˆë¼ ì§ì ‘ ì¬í˜„ì„ í•´ë³´ê³  ë‹¤ì–‘í•œ ì‹œê°ì—ì„œ ì›ì¸ë¶„ì„ì„ í•´ë³´ì. ë¨¼ì € ê¸°ë³¸ì ì¸ Spring MVC ë¼ˆëŒ€ë¥¼ ë§Œë“¤ê³  redirect í•˜ëŠ” return ê°’ì˜ Cardinalityê°€ ë†’ë„ë¡ random string ì„ ë§Œë“¤ì–´ ì£¼ë„ë¡ í•œë‹¤. ì¦‰, /randomì„ í˜¸ì¶œí•˜ë©´ /result/ETmHfowFkUì²˜ëŸ¼ random string ì´ ë§Œë“¤ì–´ ì§€ë©° redirect ì²˜ë¦¬ê°€ ë˜ëŠ” ë§¤ìš° ì‹¬í”Œí•œ êµ¬ì¡°ì´ë‹¤.
// Spring ë²„ì „ì€ 4.0.6.RELEASE @Controller @RequestMapping(&#34;/&#34;) public class TestController { @RequestMapping(value = &#34;random&#34;, method = RequestMethod.GET) public String random() { return &#34;redirect:result/&#34; + UUID.randomUUID(); } @RequestMapping(value = &#34;result/{message}&#34;, method = RequestMethod.GET) public String result(ModelMap model, @PathVariable String message) { model.addAttribute(&#34;message&#34;, message); return &#34;result&#34;; } } ë˜í•œ í•´ë‹¹ í”„ë¡œì íŠ¸ì—ì„œëŠ” AOPë¥¼ ì‚¬ìš©í•˜ê³  ìˆì—ˆê¸° ë•Œë¬¸ì— ê·¸ë•Œì™€ ë™ì¼í•œ ìƒí™©ìœ¼ë¡œ ì¬í˜„ì„ í•˜ê¸° ìœ„í•´ AOPê´€ë ¨ ì„¤ì •ë„ ì¶”ê°€í•´ì¤€ë‹¤.
@Configuration @EnableWebMvc @EnableAspectJAutoProxy @ComponentScan public class HelloWorldConfiguration { @Bean(name=&#34;HelloWorld&#34;) public ViewResolver viewResolver() { InternalResourceViewResolver viewResolver = new InternalResourceViewResolver(); viewResolver.setViewClass(JstlView.class); viewResolver.setPrefix(&#34;/WEB-INF/views/&#34;); viewResolver.setSuffix(&#34;.jsp&#34;); return viewResolver; } } ì´ë ‡ê²Œ í•œë’¤ tomcatìœ¼ë¡œ ìµœëŒ€/ìµœì†Œ ë©”ëª¨ë¦¬ë¥¼ 256mìœ¼ë¡œ ì„¤ì •í›„ í•´ë‹¹ ëª¨ë“ˆì„ ë„ì›Œì¤€ë‹¤. ê·¸ë‹¤ìŒ ë©”ëª¨ë¦¬ ìƒíƒœë¥¼ ë³´ê¸° ìœ„í•´ tomcatì— pinpointë¥¼ ì—°ë™í•˜ê³  ë§ˆì§€ë§‰ìœ¼ë¡œ í˜¸ì¶œí…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ nGrinderì„ ì„¤ì •í•´ì¤€ë‹¤. íŠ¹ë³„í•œ ì„¤ì •ì€ ì—†ê³  ìœ„ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ url (/random) ì„ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œí•˜ë„ë¡ í•˜ì˜€ë‹¤. nGrinderì„ ì„¤ì •í•˜ëŠ”ëŒ€ì—ëŠ” ì´ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ ì°¸ê³ í•´ì„œ ì„¤ì •í•˜ì˜€ë‹¤.
ì, ì´ì œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•´ë³´ì. (ë§ˆì¹˜ ìˆ˜ìˆ  ì§‘ë„í•˜ëŠ”ê²ƒ ê°™ì€ ê¸°ë¶„ìœ¼ë¡œ&mldr;ê°„í˜¸ì‚¬~ ì¹¼!)
 nGrinder nGrinderì˜ ê¸°ë³¸ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ urlë§Œ í•´ë‹¹ ì„œë²„ë¡œ í˜¸ì¶œë˜ë„ë¡ ë°”ê¿”ì£¼ê³  ì´ ê°€ìƒ ì‚¬ìš©ìëŠ” 2,000ìœ¼ë¡œ ì‹œê°„ì€ 5ë¶„ìœ¼ë¡œ ì„¤ì •í›„ì— í…ŒìŠ¤íŠ¸ ì‹œì‘ì„ í•˜ì˜€ë”ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ ê·¸ë˜í”„ë¥¼ ë³¼ìˆ˜ ìˆì—ˆë‹¤.   TPSê°€ ë¶ˆì•ˆì •í•´ì§€ë‹¤ê°€ ì–´ëŠì‹œì ë¶€í„° ë‚®ì•„ì§€ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ê²Œ ì„œë¹„ìŠ¤ ì˜€ë‹¤ë©´ ì‚¬ìš©ìê°€ ì ‘ì†í•˜ëŠ”ë° ë¶ˆí¸ì„ ëŠê¼ˆì„êº¼ë¼ ì¶”ì¸¡ì„ í•´ë³¸ë‹¤. ë˜í•œ ì•„ì£¼ ê°„ë‹¨í•œ random string ì„ ë¦¬í„´í•˜ëŠ” í˜ì´ì§€ ì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ì—ëŸ¬ ì‘ë‹µì´ ì ì§€ ì•Šì€ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.
pinpoint ë©”ëª¨ë¦¬ ìƒíƒœëŠ” ì–´ë–¤ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ pinpointë¥¼ í™•ì¸í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê·¸ë˜í”„ë¥¼ ë³¼ìˆ˜ ìˆì—ˆë‹¤.   ë³´ê¸°ë§Œí•´ë„ ì‹¬ì¥ì´ ë²Œë ë²Œë (?) ë›¸ ì •ë„ë¡œ ë¬´ì„œìš´ ê·¸ë¦¼ì´ë‹¤. ì‹¤ì œë¡œ ì„œë¹„ìŠ¤ì— (ì´ì •ë„ê¹Œì§„ ì•„ë‹ˆì˜€ì§€ë§Œ) ë¹„ìŠ·í•œ ìƒí™©ì´ ë°œìƒí–ˆì—ˆë‹¤. ë©”ëª¨ë¦¬ê°€ í…ŒìŠ¤íŠ¸ë¥¼ ì ì  í•˜ë©´ í• ìˆ˜ë¡ ì˜¬ë¼ê°€ë‹¤ê°€ fullGCê°€ ë°œìƒí•˜ë”ë‹ˆ ëŒ€ë‚˜ë¬´ ìˆ²ì— ìˆëŠ” ëŒ€ë‚˜ë¬´ë§ˆëƒ¥ fullGCê°€ ë¹¼ê³¡íˆ ë°œìƒí•˜ì˜€ë‹¤. (ì´ëŸ¬ë‹ˆ&mldr; í˜ì´ì§€ ì ‘ê·¼ì— ì§€ì—°ì´ ìƒê¸´ê²ƒ ê°™ë‹¤."><meta name=application-name content="ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„"><meta name=apple-mobile-web-app-title content="ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„"><meta name=naver-site-verification content="2d1cdbb963ba178aa7cbf58500afc668cae1e645"><meta name=google-site-verification content="vvFCdv0-GuQhEWG8vtNJfA7YSY2HYQ1hpHh9P-a6Pv8"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://taetaetae.github.io/2019/01/10/spring-redirect-oom/><link rel=prev href=https://taetaetae.github.io/2019/01/02/faster-parallel-processes/><link rel=next href=https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Spring MVC Redirect ì²˜ë¦¬ì¤‘ì— ë°œìƒí•œ Out Of Memory ì›ì¸ ë¶„ì„í•˜ê¸°","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/taetaetae.github.io\/2019\/01\/10\/spring-redirect-oom\/"},"genre":"posts","keywords":"spring, redirect, out of memory, heap dump, archives-2019","wordcount":1115,"url":"https:\/\/taetaetae.github.io\/2019\/01\/10\/spring-redirect-oom\/","datePublished":"2019-01-10T18:39:47+00:00","dateModified":"2019-01-10T18:39:47+00:00","publisher":{"@type":"Organization","name":"íƒœíƒœíƒœ"},"author":{"@type":"Person","name":"íƒœíƒœíƒœ"},"description":""}</script></head><body header-desktop=auto header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„">ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„">ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/>Posts</a><a class=menu-item href=/tags/>Tags</a><a class=menu-item href=/categories/>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:inline-block;width:260px;height:600px data-ad-client=ca-pub-5788330009690816 data-ad-slot=2248955907></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><article class="page single"><h1 class="single-title animated flipInX">Spring MVC Redirect ì²˜ë¦¬ì¤‘ì— ë°œìƒí•œ Out Of Memory ì›ì¸ ë¶„ì„í•˜ê¸°</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>íƒœíƒœíƒœ</a></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw"></i>Tech</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2019-01-10>2019-01-10</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1115 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;6 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test1-pinpoint.jpg data-srcset="/images/spring-redirect-oom/test1-pinpoint.jpg, /images/spring-redirect-oom/test1-pinpoint.jpg 1.5x, /images/spring-redirect-oom/test1-pinpoint.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test1-pinpoint.jpg title=/images/spring-redirect-oom/test1-pinpoint.jpg></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#ê¸°ì¡´ë°©ì‹ì˜-ë¬¸ì œì -ì¬í˜„-ë°-ë‹¤ì–‘í•œ-ì›ì¸ë¶„ì„>ê¸°ì¡´ë°©ì‹ì˜ ë¬¸ì œì  ì¬í˜„ ë° ë‹¤ì–‘í•œ ì›ì¸ë¶„ì„</a></li><li><a href=#ë°©ì‹-ê°œì„ -ë°-ë³€í™”-ë¹„êµ>ë°©ì‹ ê°œì„  ë° ë³€í™” ë¹„êµ</a></li><li><a href=#ë§ˆì¹˜ë©°>ë§ˆì¹˜ë©°</a></li></ul></nav></div></div><div class=content id=content><script src=https://ads-partners.coupang.com/g.js></script><script>new PartnersCoupang.G({"id":195296,"trackingCode":"AF5596407","subId":null,"template":"carousel","width":"680","height":"140"});</script><p>â€» ì¿ íŒ¡ íŒŒíŠ¸ë„ˆìŠ¤ í™œë™ì„ í†µí•´ ì¼ì •ì•¡ì˜ ìˆ˜ìˆ˜ë£Œë¥¼ ì œê³µë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>ì´ˆì°½ê¸° ì‹ ì…ì‹œì ˆì— ë°°ìš°ê±°ë‚˜ ì‚¬ìš©í–ˆë˜ ê¸°ìˆ ì ì¸ ë°©ë²•ë“¤ì´ ìˆë‹¤. ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ì™ ë§Œí•´ì„  ë‹¤ë¥¸ë°©ë²•ì€ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ í•˜ê³  <code>ìŠµê´€</code>ì²˜ëŸ¼ ê¸°ì¡´ì— ì‚¬ìš©í–ˆë˜ ë°©ë²•ì„ ê³ ìˆ˜í•˜ëŠ” ë²„ë¦‡ì´ ìˆë‹¤. ê·¸ ì´ìœ ëŠ” ê³¼ê±°ì— ì‚¬ìš©í–ˆì„ë•Œ ì•„ë¬´ íƒˆ ì—†ì´ ì˜ ë˜ì—ˆê¸° ë•Œë¬¸ì—, ê·¸ë¦¬ê³  ë¹ ë¥¸ êµ¬í˜„ ë•Œë¬¸ì´ë¼ëŠ” í•‘ê³„ì¼ ê²ƒ ê°™ë‹¤. ì´ëŸ¬í•œ ë²„ë¦‡ì€ ë¹„ë‹¨ ì´ ê¸€ì„ ì ê³ ìˆëŠ” í•„ì ë¿ë§Œì´ ì•„ë‹ˆë¼ ëŒ€ë¶€ë¶„ì˜ ê°œë°œìë“¤ì´ ê°€ì§€ê³  ìˆì„êº¼ë¼ ì¡°ì‹¬ìŠ¤ë ˆ ì¶”ì¸¡í•´ë³¸ë‹¤. (ì•„ë‹ˆë¼ë©´&mldr;ë”ìš± ë¶„ë°œ í•´ì•¼ê² ë‹¤&mldr;ã… )
ìµœê·¼ ìš´ì˜í•˜ê³  ìˆëŠ” ì„œë¹„ìŠ¤ì—ì„œ ì¥ì•  ìƒí™©ê¹Œì§€ ê°ˆìˆ˜ìˆëŠ” ìœ„í—˜í•œ ìƒí™©ì´ ìˆì—ˆëŠ”ë° íŒ€ë‚´ ì½”ë“œë¦¬ë·°ë¥¼ í†µí•´ ë¬¸ì œì ì„ íŒŒì•…í•  ìˆ˜ ìˆì—ˆë‹¤. ê·¸ ì›ì¸ì€ Spring MVC Controller ë ˆë²¨ì—ì„œ redirect ì²˜ë¦¬ë¥¼ í• ë•Œ returnê°’ì˜ Cardinalityê°€ ë†’ì„ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤ê³ &mldr;</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=nd>@RequestMapping</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&#34;/test&#34;</span><span class=o>,</span> <span class=n>method</span> <span class=o>=</span> <span class=n>RequestMethod</span><span class=o>.</span><span class=na>GET</span><span class=o>)</span>
<span class=kd>public</span> <span class=n>String</span> <span class=nf>test</span><span class=o>()</span> <span class=o>{</span>
	<span class=n>String</span> <span class=n>url</span> <span class=o>=</span> <span class=s>&#34;ì–´ë– í•œ ë¡œì§ì— ì˜í•´ ìƒì„±ë˜ëŠ” url&#34;</span><span class=o>;</span>
	<span class=k>return</span> <span class=s>&#34;redirect:&#34;</span> <span class=o>+</span> <span class=n>url</span><span class=o>;</span> <span class=c1>// &lt;- ìœ„í—˜ í¬ì¸íŠ¸!
</span><span class=c1></span><span class=o>}</span>
</code></pre></div><p>ì´ ì½”ë“œê°€ ì™œ? ì–´ë””ê°€ ì–´ë•Œì„œ?
ì´ì œê¹Œì§€ Controller ë ˆë²¨ì—ì„œ redirect ì²˜ë¦¬ë¥¼ í• ë•Œ ì•„ë¬´ìƒê°ì—†ì´ ìœ„ì— ìˆëŠ” ì½”ë“œ í˜•íƒœë¡œ êµ¬í˜„ì„ í–ˆëŠ”ë° ì €ëŸ¬í•œ ì½”ë“œ ë•Œë¬¸ì— OOMì´ ë°œìƒí•˜ì—¬ fullGC ê°€ ì—¬ëŸ¬ë²ˆ ë°œìƒí•˜ê³ , ì¼ì‹œì ìœ¼ë¡œ ì„œë¹„ìŠ¤ê°€ ì§€ì—°ë˜ëŠ” í˜„ìƒì´ ë°œìƒí–ˆë‹¤ê³  í•œë‹¤. ìì£¼ ì‚¬ìš©í•˜ë˜ ë°©ë²•ì´ì˜€ëŠ”ë° ì¥ì• ë¥¼ ìœ ë°œí• ìˆ˜ ìˆëŠ” ìœ„í—˜í•œ ë°©ë²•ì´ì˜€ë‹¤ë‹ˆ&mldr;
ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì´ëŸ¬í•œ ë°©ë²•ì´ ì™œ ì˜ëª»ë˜ì—ˆëŠ”ì§€ ì‹¤ì œë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ëª¸ì†Œ(?) ì²´ê°ì„ í•´ë³´ê³ , ê·¸ëŸ¼ ì–´ë–¤ ë°©ë²•ìœ¼ë¡œ redirect ì²˜ë¦¬ë¥¼ í•´ì•¼ í•˜ëŠ”ê°€ì™€ ê°œì„ ì„ í•¨ìœ¼ë¡œì¨ ê¸°ì¡´ë°©ì‹ì— ë¹„í•´ ì–´ë–¤ì ì´ ì¢‹ì•„ì¡ŒëŠ”ì§€ì— ëŒ€í•´ì„œ ì •ë¦¬í•´ë³´ê³ ì í•œë‹¤.</p><blockquote><p>ë­”ê°€ <strong>ë‚´ê²ƒìœ¼ë¡œ ë§Œë“¤ê¸°</strong> ì‹œë¦¬ì¦ˆë¬¼ì´ ë‚˜ì˜¬ê²ƒë§Œ ê°™ì€ ëŠë‚Œì´ë‹¤&mldr;</p></blockquote><h2 id=ê¸°ì¡´ë°©ì‹ì˜-ë¬¸ì œì -ì¬í˜„-ë°-ë‹¤ì–‘í•œ-ì›ì¸ë¶„ì„>ê¸°ì¡´ë°©ì‹ì˜ ë¬¸ì œì  ì¬í˜„ ë° ë‹¤ì–‘í•œ ì›ì¸ë¶„ì„</h2><p>ê¸°ì¡´ë°©ì‹ìœ¼ë¡œ í–ˆì„ë•Œ ì™œ OOMì´ ë°œìƒí–ˆì„ê¹Œ? ìš°ë¦¬ëŠ” ê°œë°œìì´ê¸° ë•Œë¬¸ì— ì´ëŸ°ì €ëŸ° ê¸€ë“¤ë§Œ ë³´ê³  ì¶”ì¸¡ í• ê²ƒì´ ì•„ë‹ˆë¼ ì§ì ‘ ì¬í˜„ì„ í•´ë³´ê³  ë‹¤ì–‘í•œ ì‹œê°ì—ì„œ ì›ì¸ë¶„ì„ì„ í•´ë³´ì.
ë¨¼ì € ê¸°ë³¸ì ì¸ Spring MVC ë¼ˆëŒ€ë¥¼ ë§Œë“¤ê³  redirect í•˜ëŠ” return ê°’ì˜ Cardinalityê°€ ë†’ë„ë¡ random string ì„ ë§Œë“¤ì–´ ì£¼ë„ë¡ í•œë‹¤. ì¦‰, <code>/random</code>ì„ í˜¸ì¶œí•˜ë©´ <code>/result/ETmHfowFkU</code>ì²˜ëŸ¼ random string ì´ ë§Œë“¤ì–´ ì§€ë©° redirect ì²˜ë¦¬ê°€ ë˜ëŠ” ë§¤ìš° ì‹¬í”Œí•œ êµ¬ì¡°ì´ë‹¤.</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=c1>// Spring ë²„ì „ì€ 4.0.6.RELEASE
</span><span class=c1></span><span class=nd>@Controller</span>
<span class=nd>@RequestMapping</span><span class=o>(</span><span class=s>&#34;/&#34;</span><span class=o>)</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>TestController</span> <span class=o>{</span>
	<span class=nd>@RequestMapping</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&#34;random&#34;</span><span class=o>,</span> <span class=n>method</span> <span class=o>=</span> <span class=n>RequestMethod</span><span class=o>.</span><span class=na>GET</span><span class=o>)</span>
	<span class=kd>public</span> <span class=n>String</span> <span class=nf>random</span><span class=o>()</span> <span class=o>{</span>
		<span class=k>return</span> <span class=s>&#34;redirect:result/&#34;</span> <span class=o>+</span> <span class=n>UUID</span><span class=o>.</span><span class=na>randomUUID</span><span class=o>();</span>
	<span class=o>}</span>

	<span class=nd>@RequestMapping</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&#34;result/{message}&#34;</span><span class=o>,</span> <span class=n>method</span> <span class=o>=</span> <span class=n>RequestMethod</span><span class=o>.</span><span class=na>GET</span><span class=o>)</span>
	<span class=kd>public</span> <span class=n>String</span> <span class=nf>result</span><span class=o>(</span><span class=n>ModelMap</span> <span class=n>model</span><span class=o>,</span> <span class=nd>@PathVariable</span> <span class=n>String</span> <span class=n>message</span><span class=o>)</span> <span class=o>{</span>
		<span class=n>model</span><span class=o>.</span><span class=na>addAttribute</span><span class=o>(</span><span class=s>&#34;message&#34;</span><span class=o>,</span> <span class=n>message</span><span class=o>);</span>
		<span class=k>return</span> <span class=s>&#34;result&#34;</span><span class=o>;</span>
	<span class=o>}</span>
<span class=o>}</span>
</code></pre></div><p>ë˜í•œ í•´ë‹¹ í”„ë¡œì íŠ¸ì—ì„œëŠ” AOPë¥¼ ì‚¬ìš©í•˜ê³  ìˆì—ˆê¸° ë•Œë¬¸ì— ê·¸ë•Œì™€ ë™ì¼í•œ ìƒí™©ìœ¼ë¡œ ì¬í˜„ì„ í•˜ê¸° ìœ„í•´ AOPê´€ë ¨ ì„¤ì •ë„ ì¶”ê°€í•´ì¤€ë‹¤.</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=nd>@Configuration</span>
<span class=nd>@EnableWebMvc</span>
<span class=nd>@EnableAspectJAutoProxy</span>
<span class=nd>@ComponentScan</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>HelloWorldConfiguration</span> <span class=o>{</span>
	
	<span class=nd>@Bean</span><span class=o>(</span><span class=n>name</span><span class=o>=</span><span class=s>&#34;HelloWorld&#34;</span><span class=o>)</span>
	<span class=kd>public</span> <span class=n>ViewResolver</span> <span class=nf>viewResolver</span><span class=o>()</span> <span class=o>{</span>
		<span class=n>InternalResourceViewResolver</span> <span class=n>viewResolver</span> <span class=o>=</span> <span class=k>new</span> <span class=n>InternalResourceViewResolver</span><span class=o>();</span>
		<span class=n>viewResolver</span><span class=o>.</span><span class=na>setViewClass</span><span class=o>(</span><span class=n>JstlView</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
		<span class=n>viewResolver</span><span class=o>.</span><span class=na>setPrefix</span><span class=o>(</span><span class=s>&#34;/WEB-INF/views/&#34;</span><span class=o>);</span>
		<span class=n>viewResolver</span><span class=o>.</span><span class=na>setSuffix</span><span class=o>(</span><span class=s>&#34;.jsp&#34;</span><span class=o>);</span>

		<span class=k>return</span> <span class=n>viewResolver</span><span class=o>;</span>
	<span class=o>}</span>
<span class=o>}</span>
</code></pre></div><p>ì´ë ‡ê²Œ í•œë’¤ tomcatìœ¼ë¡œ ìµœëŒ€/ìµœì†Œ ë©”ëª¨ë¦¬ë¥¼ 256mìœ¼ë¡œ ì„¤ì •í›„ í•´ë‹¹ ëª¨ë“ˆì„ ë„ì›Œì¤€ë‹¤. ê·¸ë‹¤ìŒ ë©”ëª¨ë¦¬ ìƒíƒœë¥¼ ë³´ê¸° ìœ„í•´ tomcatì— pinpointë¥¼ ì—°ë™í•˜ê³  ë§ˆì§€ë§‰ìœ¼ë¡œ í˜¸ì¶œí…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ nGrinderì„ ì„¤ì •í•´ì¤€ë‹¤. íŠ¹ë³„í•œ ì„¤ì •ì€ ì—†ê³  ìœ„ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ url (/random) ì„ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œí•˜ë„ë¡ í•˜ì˜€ë‹¤. nGrinderì„ ì„¤ì •í•˜ëŠ”ëŒ€ì—ëŠ” <a href=https://black9p.github.io/2019/01/02/nGrinder-%EA%B0%84%ED%8E%B8-%EC%82%AC%EC%9A%A9%EA%B0%80%EC%9D%B4%EB%93%9C/ target=_blank rel="noopener noreffer">ì´ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…</a>ì„ ì°¸ê³ í•´ì„œ ì„¤ì •í•˜ì˜€ë‹¤.</p><p>ì, ì´ì œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•´ë³´ì. (ë§ˆì¹˜ ìˆ˜ìˆ  ì§‘ë„í•˜ëŠ”ê²ƒ ê°™ì€ ê¸°ë¶„ìœ¼ë¡œ&mldr;ê°„í˜¸ì‚¬~ ì¹¼!)</p><ol><li>nGrinder
nGrinderì˜ ê¸°ë³¸ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ urlë§Œ í•´ë‹¹ ì„œë²„ë¡œ í˜¸ì¶œë˜ë„ë¡ ë°”ê¿”ì£¼ê³  ì´ ê°€ìƒ ì‚¬ìš©ìëŠ” 2,000ìœ¼ë¡œ ì‹œê°„ì€ 5ë¶„ìœ¼ë¡œ ì„¤ì •í›„ì— í…ŒìŠ¤íŠ¸ ì‹œì‘ì„ í•˜ì˜€ë”ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ ê·¸ë˜í”„ë¥¼ ë³¼ìˆ˜ ìˆì—ˆë‹¤.</li></ol><a class=lightgallery href=/images/spring-redirect-oom/test1-ngrinder.jpg title=/images/spring-redirect-oom/test1-ngrinder.jpg data-thumbnail=/images/spring-redirect-oom/test1-ngrinder.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test1-ngrinder.jpg data-srcset="/images/spring-redirect-oom/test1-ngrinder.jpg, /images/spring-redirect-oom/test1-ngrinder.jpg 1.5x, /images/spring-redirect-oom/test1-ngrinder.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test1-ngrinder.jpg width=100%></a><p>TPSê°€ ë¶ˆì•ˆì •í•´ì§€ë‹¤ê°€ ì–´ëŠì‹œì ë¶€í„° ë‚®ì•„ì§€ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ê²Œ ì„œë¹„ìŠ¤ ì˜€ë‹¤ë©´ ì‚¬ìš©ìê°€ ì ‘ì†í•˜ëŠ”ë° ë¶ˆí¸ì„ ëŠê¼ˆì„êº¼ë¼ ì¶”ì¸¡ì„ í•´ë³¸ë‹¤. ë˜í•œ ì•„ì£¼ ê°„ë‹¨í•œ random string ì„ ë¦¬í„´í•˜ëŠ” í˜ì´ì§€ ì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ì—ëŸ¬ ì‘ë‹µì´ ì ì§€ ì•Šì€ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.</p><ol start=2><li>pinpoint
ë©”ëª¨ë¦¬ ìƒíƒœëŠ” ì–´ë–¤ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ pinpointë¥¼ í™•ì¸í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê·¸ë˜í”„ë¥¼ ë³¼ìˆ˜ ìˆì—ˆë‹¤.</li></ol><a class=lightgallery href=/images/spring-redirect-oom/test1-pinpoint.jpg title=/images/spring-redirect-oom/test1-pinpoint.jpg data-thumbnail=/images/spring-redirect-oom/test1-pinpoint.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test1-pinpoint.jpg data-srcset="/images/spring-redirect-oom/test1-pinpoint.jpg, /images/spring-redirect-oom/test1-pinpoint.jpg 1.5x, /images/spring-redirect-oom/test1-pinpoint.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test1-pinpoint.jpg width=100%></a><p>ë³´ê¸°ë§Œí•´ë„ ì‹¬ì¥ì´ ë²Œë ë²Œë (?) ë›¸ ì •ë„ë¡œ ë¬´ì„œìš´ ê·¸ë¦¼ì´ë‹¤. ì‹¤ì œë¡œ ì„œë¹„ìŠ¤ì— (ì´ì •ë„ê¹Œì§„ ì•„ë‹ˆì˜€ì§€ë§Œ) ë¹„ìŠ·í•œ ìƒí™©ì´ ë°œìƒí–ˆì—ˆë‹¤. ë©”ëª¨ë¦¬ê°€ í…ŒìŠ¤íŠ¸ë¥¼ ì ì  í•˜ë©´ í• ìˆ˜ë¡ ì˜¬ë¼ê°€ë‹¤ê°€ fullGCê°€ ë°œìƒí•˜ë”ë‹ˆ ëŒ€ë‚˜ë¬´ ìˆ²ì— ìˆëŠ” ëŒ€ë‚˜ë¬´ë§ˆëƒ¥ fullGCê°€ ë¹¼ê³¡íˆ ë°œìƒí•˜ì˜€ë‹¤. (ì´ëŸ¬ë‹ˆ&mldr; í˜ì´ì§€ ì ‘ê·¼ì— ì§€ì—°ì´ ìƒê¸´ê²ƒ ê°™ë‹¤.)</p><ol start=3><li>Heap dump
ê·¸ëŸ¼ ì‹¤ì œë¡œ ë©”ëª¨ë¦¬ëŠ” ì–´ë–¤ ìƒíƒœì˜€ê³  ì–´ë””ì„œ ë©”ëª¨ë¦¬ë¥¼ ë§ì´ ì‚¬ìš©í•˜ê³ (ì ìœ í•˜ê³ ) ìˆëŠ”ì§€ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ Heap dumpë¥¼ ìƒì„±í•´ ë³´ì•˜ë‹¤. í™ë¤í”„ ë¶„ì„í•˜ëŠ”ë° ì˜ ì•Œë ¤ì§„ <a href=https://www.eclipse.org/mat/ target=_blank rel="noopener noreffer">Memory Analyzer (MAT)</a>ë¥¼ ë‹¤ìš´ë°›ê³  í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ì˜ í™ë¤í”„ë¥¼ ìƒì„±í•œë‹¤ìŒ ë¶„ì„ì„ í•´ë´¤ë”ë‹ˆ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆì—ˆë‹¤.</li></ol><a class=lightgallery href=/images/spring-redirect-oom/test1-dump1.jpg title=/images/spring-redirect-oom/test1-dump1.jpg data-thumbnail=/images/spring-redirect-oom/test1-dump1.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test1-dump1.jpg data-srcset="/images/spring-redirect-oom/test1-dump1.jpg, /images/spring-redirect-oom/test1-dump1.jpg 1.5x, /images/spring-redirect-oom/test1-dump1.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test1-dump1.jpg width=100%></a><p>í™ë¤í”„ íŒŒì¼ì„ ì—´ìë§ˆì (ì € ë¬¸ì œ ìˆì–´ìš”~ ë„ì™€ì£¼ì„¸ìš” í•˜ë“¯) ë­”ê°€ ë§ì´ ì ìœ í•˜ê³  ìˆëŠ”ê²ƒì²˜ëŸ¼ ë³´ì´ëŠ” íŒŒì´ê·¸ë˜í”„ê°€ Overviewì— ë³´ì˜€ë‹¤. Reports ì˜ì—­ì— ìˆëŠ” Leak Suspectsë¥¼ í™•ì¸í•´ë³´ë‹ˆ ì•„ë˜ ê²½ë¡œì—ì„œ ë§ì´ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.</p><blockquote><p>java.util.concurrent.ConcurrentHashMap$Node</p></blockquote><a class=lightgallery href=/images/spring-redirect-oom/test1-dump2.jpg title=/images/spring-redirect-oom/test1-dump2.jpg data-thumbnail=/images/spring-redirect-oom/test1-dump2.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test1-dump2.jpg data-srcset="/images/spring-redirect-oom/test1-dump2.jpg, /images/spring-redirect-oom/test1-dump2.jpg 1.5x, /images/spring-redirect-oom/test1-dump2.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test1-dump2.jpg width=100%></a><p>ì´ íˆ´ì—ì„œëŠ” OQLì´ë¼ê³  í™ë¤í”„ì— ìˆëŠ” ë°ì´í„°ë¥¼ ì¼ë°˜ SQLì²˜ëŸ¼ ì¿¼ë¦¬ì²˜ëŸ¼ ë³¼ìˆ˜ ìˆì—ˆë‹¤. ê·¸ë˜ì„œ ì•„ë˜ì²˜ëŸ¼ ì¿¼ë¦¬ë¥¼ ì‘ì„±í•´ì„œ ë´¤ë”ë‹ˆ ê²°ê³¼ë§Œ ë´ë„ ì–´ë””ì„œ ë©”ëª¨ë¦¬ë¥¼ ì ìœ í•˜ê³  ìˆëŠ”ì§€ í•œëˆˆì— ë³¼ìˆ˜ ìˆì—ˆë‹¤</p><div class=highlight><pre class=chroma><code class=language-sql data-lang=sql><span class=k>SELECT</span> <span class=n>o</span><span class=p>.</span><span class=k>key</span><span class=p>.</span><span class=n>toString</span><span class=p>()</span> 
<span class=k>FROM</span> <span class=n>java</span><span class=p>.</span><span class=n>util</span><span class=p>.</span><span class=n>concurrent</span><span class=p>.</span><span class=n>ConcurrentHashMap$Node</span> <span class=n>o</span> 
<span class=k>WHERE</span> <span class=p>((</span><span class=n>o</span><span class=p>.</span><span class=k>key</span> <span class=o>!=</span> <span class=k>null</span><span class=p>)</span> <span class=k>and</span> <span class=p>(</span><span class=n>o</span><span class=p>.</span><span class=k>key</span><span class=p>.</span><span class=n>toString</span><span class=p>().</span><span class=n>indexOf</span><span class=p>(</span><span class=s2>&#34;org.springframework.web.servlet.view.RedirectView_redirect&#34;</span><span class=p>)</span> <span class=o>=</span> <span class=mi>0</span><span class=p>))</span>
</code></pre></div><a class=lightgallery href=/images/spring-redirect-oom/test1-dump3.jpg title=/images/spring-redirect-oom/test1-dump3.jpg data-thumbnail=/images/spring-redirect-oom/test1-dump3.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test1-dump3.jpg data-srcset="/images/spring-redirect-oom/test1-dump3.jpg, /images/spring-redirect-oom/test1-dump3.jpg 1.5x, /images/spring-redirect-oom/test1-dump3.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test1-dump3.jpg width=100%></a><p>ë¬´ì‘ìœ„ë¡œ ë§Œë“¤ì–´ì§„ urlì— ëŒ€í•œ ì •ë³´ë¥¼ ìºì‹œí•˜ê³  ìˆëŠ” ë“¯í•œ ê²°ê³¼ì˜€ë‹¤.</p><h2 id=ë°©ì‹-ê°œì„ -ë°-ë³€í™”-ë¹„êµ>ë°©ì‹ ê°œì„  ë° ë³€í™” ë¹„êµ</h2><p>ê²°êµ­ <code>return "redirect:" + url;</code> ì™€ ê°™ì€ ì²˜ë¦¬ê°€ ë¬¸ì œë¥¼ ì•¼ê¸°í–ˆë˜ ê²ƒì´ì˜€ë‹¤. ê·¸ëŸ¼ redirect ì²˜ë¦¬ë¥¼ ì–´ë–»ê²Œ í•˜ëŠ”ê²Œ ì¢‹ì„ê¹Œ?
ì¡°ê¸ˆ ê²€ìƒ‰ì„ í•´ë³´ë©´ <code>RedirectView</code> ë‚˜ <code>ModelAndView</code>ë¥¼ ì‚¬ìš©í•˜ë¼ê³  ê¶Œì¥í•˜ê³  ìˆë‹¤. ë¬¼ë¡  redirect ë˜ëŠ” urlì˜ Cardinalityê°€ ë†’ì§€ì•Šê³  ê³ ì •ì ì´ë¼ë©´ ì§€ê¸ˆì˜ <code>return "redirect:" + url;</code> ì´ ë°©ì‹ì„ ì‚¬ìš©í•´ë„ ë¬´ë°©í• ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì†Œë“œê°€ Stringíƒ€ì…ì„ return í•˜ê²Œ ë˜ë©´ View í´ë˜ìŠ¤ë¡œ ë³€í™˜ì‘ì—…ì„ ì§„í–‰í•˜ê²Œ ëœë‹¤ê³  í•œë‹¤.
ì´ ì‘ì—…ì¤‘ì— <code>org.springframework.beans.factory.config.BeanPostProcessor</code>êµ¬í˜„ì²´ë“¤ë„ ê°™ì´ ì§„í–‰ë˜ê³ , ì´ì¤‘ì— í•˜ë‚˜ê°€ <code>AnnotationAwareAspectJAutoProxyCreator</code> ë¼ê³  ìˆëŠ”ë° í•´ë‹¹ í´ë˜ìŠ¤ ë‚´ë¶€ì ìœ¼ë¡œ <code>ConcurrentHashMap&lt;Object, Boolean></code> íƒ€ì… ê°ì²´ì— key : viewName, value : í•„ìš” ì—¬ë¶€(boolean) í˜•íƒœë¡œ ê°¯ìˆ˜ ì œí•œ ì—†ì´ ì €ì¥í•˜ê³  ìˆë‹¤. ê·¸ëŸ¬ë‹¤ë³´ë‹ˆ urlì˜ ì¢…ë¥˜ê°€ ë§ì•„ì§ˆìˆ˜ë¡ ë©”ëª¨ë¦¬ê°€ ë§ì´ ì‚¬ìš©ë  ìˆ˜ë°–ì— ì—†ì—ˆë˜ ê²ƒ ê°™ë‹¤.
ì¦‰, ë™ì¼í•œ urlì— ëŒ€í•´ View ê°ì²´ë¥¼ ìºì‹±í•˜ê³  ìˆìœ¼ë‹ˆ ìœ„ì™€ ê°™ì´ urlì˜ ì¢…ë¥˜ê°€ ë‹¤ì–‘í• ê²½ìš° (íŠ¹íˆ ë¡œê·¸ì¸ ê°™ì€ ì²˜ë¦¬ë¥¼ í• ë•Œ ê³ ìœ ê°’ì„ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸°ëŠ” ê²½ìš°) ìºì‹± ê°ì²´ ìˆ«ìê°€ ë§ì•„ì§€ê¸° ë§ˆë ¨ì´ë‹¤.</p><p>ì‹¤ì œë¡œ ì½”ë“œë¥¼ ë³´ë©´ ìºì‹±ì„ í•˜ê³ ìˆëŠ”ê²ƒì„ ë³¼ìˆ˜ ìˆë‹¤. <a href=https://github.com/spring-projects/spring-framework/blob/master/spring-aop/src/main/java/org/springframework/aop/framework/autoproxy/AbstractAutoProxyCreator.java#L358 target=_blank rel="noopener noreffer">Spring-project github</a></p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=c1>// ... ìƒëµ
</span><span class=c1></span><span class=kd>protected</span> <span class=n>Object</span> <span class=nf>wrapIfNecessary</span><span class=o>(</span><span class=n>Object</span> <span class=n>bean</span><span class=o>,</span> <span class=n>String</span> <span class=n>beanName</span><span class=o>,</span> <span class=n>Object</span> <span class=n>cacheKey</span><span class=o>)</span> <span class=o>{</span>
  <span class=c1>// ... ìƒëµ
</span><span class=c1></span>
  <span class=k>if</span> <span class=o>(</span><span class=n>isInfrastructureClass</span><span class=o>(</span><span class=n>bean</span><span class=o>.</span><span class=na>getClass</span><span class=o>())</span> <span class=o>||</span> <span class=n>shouldSkip</span><span class=o>(</span><span class=n>bean</span><span class=o>.</span><span class=na>getClass</span><span class=o>(),</span> <span class=n>beanName</span><span class=o>))</span> <span class=o>{</span>
    <span class=k>this</span><span class=o>.</span><span class=na>advisedBeans</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>cacheKey</span><span class=o>,</span> <span class=n>Boolean</span><span class=o>.</span><span class=na>FALSE</span><span class=o>);</span> <span class=c1>// &lt;- ì—¬ê¸° 
</span><span class=c1></span>    <span class=k>return</span> <span class=n>bean</span><span class=o>;</span>
  <span class=o>}</span>

  <span class=c1>// ... ìƒëµ
</span><span class=c1></span>
  <span class=k>this</span><span class=o>.</span><span class=na>advisedBeans</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>cacheKey</span><span class=o>,</span> <span class=n>Boolean</span><span class=o>.</span><span class=na>FALSE</span><span class=o>);</span> <span class=c1>// &lt;- ì—¬ê¸° 
</span><span class=c1></span>  <span class=k>return</span> <span class=n>bean</span><span class=o>;</span>
<span class=o>}</span>
<span class=c1>// ... ìƒëµ
</span></code></pre></div><p>ì, ê·¸ëŸ¼ ê°œì„ ë°©ë²•ì„ ì•Œì•„ë´¤ìœ¼ë‹ˆ í•œë²ˆ ë¹„êµë¥¼ í•´ë³´ì. ì•„ë˜ì²˜ëŸ¼ <code>ModelAndView</code>ë¥¼ ì‚¬ìš©í•´ì„œ redirectì²˜ë¦¬ë¥¼ í• ìˆ˜ìˆë„ë¡ ì½”ë“œë¥¼ ë³€ê²½í•˜ê³ </p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=nd>@Controller</span>
<span class=nd>@RequestMapping</span><span class=o>(</span><span class=s>&#34;/&#34;</span><span class=o>)</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>TestController</span> <span class=o>{</span>
  <span class=nd>@RequestMapping</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&#34;random&#34;</span><span class=o>,</span> <span class=n>method</span> <span class=o>=</span> <span class=n>RequestMethod</span><span class=o>.</span><span class=na>GET</span><span class=o>)</span>
  <span class=kd>public</span> <span class=n>ModelAndView</span> <span class=nf>random</span><span class=o>()</span> <span class=o>{</span>
    <span class=n>ModelAndView</span> <span class=n>modelAndView</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ModelAndView</span><span class=o>();</span>

    <span class=n>RedirectView</span> <span class=n>redirectView</span> <span class=o>=</span> <span class=k>new</span> <span class=n>RedirectView</span><span class=o>();</span>
    <span class=n>redirectView</span><span class=o>.</span><span class=na>setUrl</span><span class=o>(</span><span class=s>&#34;result/&#34;</span> <span class=o>+</span> <span class=n>UUID</span><span class=o>.</span><span class=na>randomUUID</span><span class=o>());</span>

    <span class=n>modelAndView</span><span class=o>.</span><span class=na>setView</span><span class=o>(</span><span class=n>redirectView</span><span class=o>);</span>
    <span class=k>return</span> <span class=n>modelAndView</span><span class=o>;</span>
  <span class=o>}</span>

  <span class=nd>@RequestMapping</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&#34;/result/{message}&#34;</span><span class=o>,</span> <span class=n>method</span> <span class=o>=</span> <span class=n>RequestMethod</span><span class=o>.</span><span class=na>GET</span><span class=o>)</span>
  <span class=kd>public</span> <span class=n>String</span> <span class=nf>result</span><span class=o>(</span><span class=n>ModelMap</span> <span class=n>model</span><span class=o>,</span> <span class=nd>@PathVariable</span> <span class=n>String</span> <span class=n>message</span><span class=o>)</span> <span class=o>{</span>
    <span class=n>model</span><span class=o>.</span><span class=na>addAttribute</span><span class=o>(</span><span class=s>&#34;message&#34;</span><span class=o>,</span> <span class=n>message</span><span class=o>);</span>
    <span class=k>return</span> <span class=s>&#34;result&#34;</span><span class=o>;</span>
  <span class=o>}</span>
<span class=o>}</span>
</code></pre></div><p>ê¸°ì¡´ê³¼ ë™ì¼í•œ ë°©ë²•ê³¼ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ì.</p><ol><li>nGrinder
ìœ„í•´ì„œ í–ˆë˜ ë°©ë²•ê³¼ ë™ì¼í•œ ê°€ìƒ ì‚¬ìš©ì ìˆ˜ì™€ ë™ì¼í•œ ì‹œê°„ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ ê·¸ë˜í”„ë¥¼ ë³¼ìˆ˜ ìˆì—ˆë‹¤.
<a class=lightgallery href=/images/spring-redirect-oom/test2-ngrinder.jpg title=/images/spring-redirect-oom/test2-ngrinder.jpg data-thumbnail=/images/spring-redirect-oom/test2-ngrinder.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test2-ngrinder.jpg data-srcset="/images/spring-redirect-oom/test2-ngrinder.jpg, /images/spring-redirect-oom/test2-ngrinder.jpg 1.5x, /images/spring-redirect-oom/test2-ngrinder.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test2-ngrinder.jpg width=100%></a></li></ol><p>ìœ„ì—ì„œ ë´¤ë˜ ë“¤ì­‰ë‚ ì­‰ ê·¸ë˜í”„ë³´ë‹¤ í›¨ì”¬ ë” ì•ˆì •ì ì¸ê²ƒì„ ë³¼ ìˆ˜ ìˆì—ˆê³ , ì—ëŸ¬ë„ ë‹¨ í•œê±´ë„ ì—†ì´ í›¨ì”¬ ë†’ì€ TPSë¥¼ ëê¹Œì§€ ì¼ì •í•˜ê²Œ ìœ ì§€í•˜ëŠ” ëª¨ìŠµì„ ë³¼ìˆ˜ ìˆì—ˆë‹¤. (ë¡œì§ìƒ ì—ëŸ¬ê°€ ë‚˜ëŠ”ê²Œ ì´ìƒí•œ&mldr; ì•„ë‹ˆ ì•ˆë‚˜ì•¼ ì •ìƒì´ë‹¤.)</p><ol start=2><li>pinpoint
TPSê°€ ì•ˆì •ì ì´ì˜€ê¸° ë•Œë¬¸ì— ë©”ëª¨ë¦¬ì˜ ìƒíƒœë¥¼ ì•ˆë´ë„ ë˜ê² ì§€ë§Œ ë¹„êµì˜ ëª©ì ì´ ìˆê¸° ë•Œë¬¸ì— pinpoint ì˜ ê·¸ë˜í”„ë¥¼ í•œë²ˆ ë³´ì.</li></ol><a class=lightgallery href=/images/spring-redirect-oom/test2-pinpoint.jpg title=/images/spring-redirect-oom/test2-pinpoint.jpg data-thumbnail=/images/spring-redirect-oom/test2-pinpoint.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test2-pinpoint.jpg data-srcset="/images/spring-redirect-oom/test2-pinpoint.jpg, /images/spring-redirect-oom/test2-pinpoint.jpg 1.5x, /images/spring-redirect-oom/test2-pinpoint.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test2-pinpoint.jpg width=100%></a><p>nGrinderë¡œ í…ŒìŠ¤íŠ¸í•˜ëŠ” ì‹œì ë§Œ ì ê¹ ë©”ëª¨ë¦¬ê°€ ì˜¬ë¼ê°€ë‹¤ê°€ ë‹¤ì‹œ ë‚´ë ¤ì˜¤ê³  ì „ì— ìˆì—ˆë˜ fullGCë„ ì—†ê³  ìœ„ì—ì„œ í…ŒìŠ¤íŠ¸ í–ˆë˜ ê·¸ë˜í”„ ë³´ë‹¤ëŠ” ì•ˆì •ì ì¸ ê·¸ë˜í”„ë¼ê³  ë³¼ìˆ˜ ìˆì—ˆë‹¤.</p><ol start=3><li>Heap dump
ë©”ëª¨ë¦¬ê°€ ì•ˆì •ì ì´ì˜€ì§€ë§Œ í˜¹ì‹œ pinpointì—ì„œ ì˜ëª» ì§‘ê³„í•˜ê±°ë‚˜ ê·¸ë˜í”„ë§Œ ë³´ê³  ë§¹ì‹ í• ìˆ˜ ì—†ì—ˆê¸° ë•Œë¬¸ì— ì´ë²ˆì—ë„ Heap dumpë¥¼ ìƒì„±í•´ ë³´ì•˜ë‹¤.</li></ol><a class=lightgallery href=/images/spring-redirect-oom/test1-dump2.jpg title=/images/spring-redirect-oom/test1-dump2.jpg data-thumbnail=/images/spring-redirect-oom/test1-dump2.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test1-dump2.jpg data-srcset="/images/spring-redirect-oom/test1-dump2.jpg, /images/spring-redirect-oom/test1-dump2.jpg 1.5x, /images/spring-redirect-oom/test1-dump2.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test1-dump2.jpg width=100%></a><p>ì¼ë‹¨ ì ìœ í•˜ê³  ìˆëŠ” ë©”ëª¨ë¦¬ì˜ í¬ê¸°ê°€ ì•½ 10ë¶„ì˜ 1ì •ë„ë¡œ ì¤„ì–´ë“ ê²ƒì„ í™•ì¸í• ìˆ˜ ìˆì—ˆê³ , ìœ„ì—ì„œ í–ˆë˜ OQLì„ ì´ìš©í•œ ë©”ëª¨ë¦¬ ì ìœ ë¥¼ í™•ì¸í•´ë´ë„ ê¸°ì¡´ì— ìˆë˜ <code>RedirectView_redirect</code>ê´€ë ¨ ë°ì´í„°ê°€ ì•„ì˜ˆ ì—†ìŒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.</p><a class=lightgallery href=/images/spring-redirect-oom/test2-dump2.jpg title=/images/spring-redirect-oom/test2-dump2.jpg data-thumbnail=/images/spring-redirect-oom/test2-dump2.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test2-dump2.jpg data-srcset="/images/spring-redirect-oom/test2-dump2.jpg, /images/spring-redirect-oom/test2-dump2.jpg 1.5x, /images/spring-redirect-oom/test2-dump2.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test2-dump2.jpg width=100%></a><p>ì½”ë“œ ëª‡ì¤„ ë³€ê²½í•œê²ƒë°–ì— ì—†ëŠ”ë° ê°™ì€ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ í™•ì—°íˆ ì¢‹ì•„ì§„ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. (ë¿Œë“¯) ì „ì²´ì ìœ¼ë¡œ ë‹¤ì‹œ ë¹„êµë¥¼ í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ì´ìœ(?) ë³€í™”ë¥¼ ë³¼ìˆ˜ê°€ ìˆë‹¤.</p><a class=lightgallery href=/images/spring-redirect-oom/test-diff.jpg title=/images/spring-redirect-oom/test-diff.jpg data-thumbnail=/images/spring-redirect-oom/test-diff.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test-diff.jpg data-srcset="/images/spring-redirect-oom/test-diff.jpg, /images/spring-redirect-oom/test-diff.jpg 1.5x, /images/spring-redirect-oom/test-diff.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test-diff.jpg width=100%></a><h2 id=ë§ˆì¹˜ë©°>ë§ˆì¹˜ë©°</h2><p>í‰ì†Œì— ìì£¼ ì‚¬ìš©í•˜ë˜ ë°©ì‹ì¸ë° ì„±ëŠ¥ì ìœ¼ë¡œ ìì¹« ì¹˜ëª…ì ì¸ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¬ìˆ˜ ìˆë‹¤ê³  í•˜ì—¬ ì¬í˜„ì„ ì•ˆí•´ë³¼ìˆ˜ê°€ ì—†ì—ˆë‹¤. ë§Œì•½ ì•…ì˜ì ìœ¼ë¡œ urlë’¤ì— ë¬´ì‘ìœ„ ë¬¸ìì—´ì„ ë”í•´ì„œ ddosê³µê²©ì„ í–ˆë”ë¼ë©´? ì–¼ë§ˆ ì•ˆê°€ì„œ ì„œë²„ê°€ í„°ì¡Œì„ì§€ë„ ëª¨ë¥¸ë‹¤.
ì§€ê¸ˆì´ë¼ë„ ì•Œì•„ì„œ ë‹¤í–‰ì´ë¼ëŠ” ìƒê°ê³¼ ì¬í˜„ì„ ì•ˆí•´ë³´ê³  ê·¸ëƒ¥ ê·¸ëŸ°ê°€ë³´ë‹¤ í•˜ë©° ë„˜ì–´ê°”ë‹¤ë©´ ì‹¤ì œ Spring ë‚´ë¶€ ì½”ë“œê¹Œì§€ ë³¼ì¼ì´ ìˆì—ˆì„ê¹Œ í•˜ëŠ” ìƒê°ì„ í•´ë³¸ë‹¤.
ì´ë²ˆì— ì¬í˜„ì„ í•´ë³´ë©´ì„œ nGrinder ë¡œ ì„±ëŠ¥í…ŒìŠ¤íŠ¸ì— pinpoint ëª¨ë‹ˆí„°ë§, ë§ˆì§€ë§‰ìœ¼ë¡œ í™ë¤í”„ ë¶„ì„ê¹Œì§€. ê¼­ ì´ë²ˆ url redirect ë¬¸ì œë§Œì´ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ì„±ëŠ¥ì ì¸ ì´ìŠˆê°€ ìƒê¸¸ë•Œ ë§ˆì¹˜ <code>ì¹˜íŠ¸í‚¤</code>ì²˜ëŸ¼ í™œìš©í• ìˆ˜ ìˆì„ <code>ë‚˜ë§Œì˜ ë¬´ê¸°</code>ë¥¼ ì–»ì€ê²ƒ ê°™ì•„ ë‹¤ì‹œí•œë²ˆ ë¿Œë“¯í•¨ì„ ëŠë‚€ë‹¤.</p><p>ë§ˆì§€ë§‰ìœ¼ë¡œ, ì´ë ‡ê²Œ ì¬í˜„ê¹Œì§€ í•˜ë„ë¡ <code>ìê·¹</code>ì„ ì£¼ì‹  íŒ€ ë™ë£Œë¶„ê»˜ ê°ì‚¬ë“œë¦°ë‹¤ê³  ì „í•˜ê³  ì‹¶ë‹¤. (ë³´ì‹¤ì§€ ì•ˆë³´ì‹¤ì§€ ëª¨ë¥´ê² ì§€ë§Œ ^^;)</p><hr><ul><li>ê´€ë ¨ ì°¸ê³ ê¸€<ul><li><a href=https://www.baeldung.com/spring-redirect-and-forward>https://www.baeldung.com/spring-redirect-and-forward</a></li><li><a href=https://www.slideshare.net/benelog/ss-35627826>https://www.slideshare.net/benelog/ss-35627826</a></li></ul></li></ul><script src=https://ads-partners.coupang.com/g.js></script><script>new PartnersCoupang.G({"id":195296,"trackingCode":"AF5596407","subId":null,"template":"carousel","width":"680","height":"140"});</script><p>â€» ì¿ íŒ¡ íŒŒíŠ¸ë„ˆìŠ¤ í™œë™ì„ í†µí•´ ì¼ì •ì•¡ì˜ ìˆ˜ìˆ˜ë£Œë¥¼ ì œê³µë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></div><center><style>.bmc-button img{width:27px!important;margin-bottom:1px!important;box-shadow:none!important;border:none!important;vertical-align:middle!important}.bmc-button{line-height:29px!important;height:30px!important;text-decoration:none!important;display:inline-flex!important;color:#000!important;background-color:#fd0!important;border-radius:3px!important;border:1px solid transparent!important;padding:1px 9px!important;font-size:22px!important;letter-spacing:.6px!important;box-shadow:0 1px 2px rgba(190,190,190,.5)!important;-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;margin:0 auto!important;font-family:cookie,cursive!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;-o-transition:.3s all linear!important;-webkit-transition:.3s all linear!important;-moz-transition:.3s all linear!important;-ms-transition:.3s all linear!important;transition:.3s all linear!important}.bmc-button:hover,.bmc-button:active,.bmc-button:focus{-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;text-decoration:none!important;box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;opacity:.85!important;color:#000!important}</style><link href="https://fonts.googleapis.com/css?family=Cookie" rel=stylesheet><center><br><a class=bmc-button target=_blank href=https://www.buymeacoffee.com/taetaetae><img src=https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg alt="Buy me a coffee"><span style=margin-left:5px>Buy me a coffee</span></a>
<a href=https://bit.ly/ddbSupport target=_blank><img src=https://i.imgur.com/peaYpjh.png style=height:28px></a></center><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2019-01-10</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://taetaetae.github.io/2019/01/10/spring-redirect-oom/ data-title="Spring MVC Redirect ì²˜ë¦¬ì¤‘ì— ë°œìƒí•œ Out Of Memory ì›ì¸ ë¶„ì„í•˜ê¸°" data-hashtags="spring,redirect,out of memory,heap dump,archives-2019"><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://taetaetae.github.io/2019/01/10/spring-redirect-oom/ data-hashtag=spring><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://taetaetae.github.io/2019/01/10/spring-redirect-oom/><i class="fab fa-linkedin fa-fw"></i></a><a href=javascript:void(0); title="Share on Blogger" data-sharer=blogger data-url=https://taetaetae.github.io/2019/01/10/spring-redirect-oom/ data-title="Spring MVC Redirect ì²˜ë¦¬ì¤‘ì— ë°œìƒí•œ Out Of Memory ì›ì¸ ë¶„ì„í•˜ê¸°" data-description><i class="fab fa-blogger fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/spring/>spring</a>,&nbsp;<a href=/tags/redirect/>redirect</a>,&nbsp;<a href=/tags/out-of-memory/>out of memory</a>,&nbsp;<a href=/tags/heap-dump/>heap dump</a>,&nbsp;<a href=/tags/archives-2019/>archives-2019</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2019/01/02/faster-parallel-processes/ class=prev rel=prev title="ì²œë§Œ ëª…ì˜ ì‚¬ìš©ìì—ê²Œ 1ë¶„ ë‚´ë¡œ ì•Œë¦¼ ë³´ë‚´ê¸° (ë³‘ë ¬í”„ë¡œì„¸ìŠ¤ì˜ ìµœì í™”)"><i class="fas fa-angle-left fa-fw"></i>ì²œë§Œ ëª…ì˜ ì‚¬ìš©ìì—ê²Œ 1ë¶„ ë‚´ë¡œ ì•Œë¦¼ ë³´ë‚´ê¸° (ë³‘ë ¬í”„ë¡œì„¸ìŠ¤ì˜ ìµœì í™”)</a>
<a href=/2019/02/10/access-log-to-elastic-stack/ class=next rel=next title="ëˆ„êµ¬ë‚˜ í•  ìˆ˜ ìˆëŠ” ì—‘ì„¸ìŠ¤ ë¡œê·¸ ë¶„ì„ ë”°ë¼ í•´ë³´ê¸° (by Elastic Stack)">ëˆ„êµ¬ë‚˜ í•  ìˆ˜ ìˆëŠ” ì—‘ì„¸ìŠ¤ ë¡œê·¸ ë¶„ì„ ë”°ë¼ í•´ë³´ê¸° (by Elastic Stack)<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=utterances></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.74.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i>LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2016 - 2021</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://taetaetae.github.io/resume target=_blank>íƒœíƒœíƒœ</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":500},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"Comment","lightTheme":"github-light","repo":"taetaetae/blog-comment"}},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true}};</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','UA-86432198-1',{'anonymize_ip':true});</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-86432198-1" async></script></body></html>