<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>ìŠ¤í”„ë§ì„ í™œìš©í•œ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ êµ¬í˜„ - ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</title><meta name=Description content><meta property="og:title" content="ìŠ¤í”„ë§ì„ í™œìš©í•œ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ êµ¬í˜„"><meta property="og:description" content="ê°œë°œì„ í•˜ë‹¤ë³´ë©´ ì‹¤ì œë¡œ ì§ì ‘ êµ¬í˜„ì„ í•´ë³¸ì ì€ ì—†ì§€ë§Œ ì—¬ê¸°ì €ê¸°ì„œ ë“¤ì–´ë³¸ ì§€ì‹ê³¼ ê·¸ ë™ì•ˆì˜ ì§¬ë°¥(?)ìœ¼ë¡œ ì¶”ì¸¡í•´ë³¼ìˆ˜ ìˆëŠ” ë¶€ë¶„ë“¤ì´ ìˆë‹¤. ë¬¼ë¡  ëª¨ë“ ì¼ì— ì •ë‹µì€ ì—†ê² ì§€ë§Œ ìš”ì¦˜ ëŠë¼ëŠ”ê±´ ì±…ì—ì„œ ê³µë¶€ë§Œ í•´ë³¸ê²ƒê³¼ ë‹¤ë¥¸ ë¸”ë¡œê·¸ë“¤ì—ì„œ ëˆˆìœ¼ë¡œë§Œ ë³´ê³  ë„˜ì–´ê°€ëŠ”ê²ƒë“¤ ê·¸ë¦¬ê³  ì§ì ‘ ì†ê°€ë½ì„ ì›€ì§ì—¬ê°€ë©° ì™œ ì—¬ê¸°ì„œëŠ” ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ì§€ ê³ ë¯¼í•˜ë©´ì„œ êµ¬í˜„ì„ í•´ë³¸ë‹¤ëŠ”ê±´ ì •ë§ ì—„ì²­ë‚˜ê²Œ í° ì°¨ì´ê°€ ìˆëŠ”ê²ƒ ê°™ë‹¤. ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•˜ë‹¤ë³´ë©´ í•œë²ˆ ì¯¤ ë§Œë‚˜ê²Œ ë˜ëŠ” íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥. í•„ìë„ ëª‡ë²ˆ êµ¬í˜„ì€ í•´ë´¤ì§€ë§Œ ê·¸ëƒ¥ ë‹¨ìˆœíˆ êµ¬í˜„ë§Œ í•´ë³¸ ìƒíƒœì˜€ë‹¤ê°€ ìµœê·¼ì— ê·¸ëƒ¥ íŒŒì¼ ì—…ë¡œë“œê°€ ì•„ë‹Œ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œì—ì„œì˜ ë¬¸ì œê°€ ë°œìƒí•˜ì—¬ ì—¬ê¸°ì €ê¸° ì‚½ì§ˆì„ í•˜ê²Œ ë˜ì—ˆê³  ì •ë¦¬ë„ í•´ë³¼ê²¸ ìŠ¤í”„ë§ì—ì„œì˜ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œì‹œ í•œë²ˆì¯¤ ê³ ë ¤í•´ë´ì•¼ í•  ë¶€ë¶„ì— ëŒ€í•´ ì •ë¦¬ë¥¼ í•´ë³´ë ¤ê³  í•œë‹¤.
 ë¬¼ë¡  êµ¬ê¸€ì—ì„œ ê²€ìƒ‰ì„ í•´ë³´ë©´ ì•„ë§ˆ í•„ìê°€ ì“´ê²ƒ ë³´ë‹¤ ë” ìì„¸í•˜ê³  ì¢‹ì€ ê¸€ë“¤ì´ ìˆê² ì§€ë§Œ í•„ìëŠ” ë³´ë‹¤ ëŒ€ìš©ëŸ‰ì— ì§‘ì¤‘ì—ì„œ ì‘ì„±í•´ ë³´ê³ ì í•œë‹¤. ëª…ì‹¬í•˜ì. &ldquo;ì•„ë¬´ë¦¬ íë¦° ì‰í¬ë¼ë„ ì¢‹ì€ ê¸°ì–µë ¥ë³´ë‹¤ ë‚«ë‹¤&rdquo; ë¼ëŠ” ë§ì´ ìˆë“¯ì´
 ìŠ¤í”„ë§ì„ í™œìš©í•œ íŒŒì¼ ì—…ë¡œë“œ êµ¬í˜„ ìš°ì„  ì™„ì „ ì´ˆê¸°ìƒíƒœì—ì„œ ì‹œì‘í•˜ê¸° ìœ„í•´ ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ê³  ê°„ë‹¨í•˜ê²Œ íŒŒì¼ ì—…ë¡œë“œë¥¼ í•  ìˆ˜ ìˆëŠ” form í˜ì´ì§€ì™€ ì—…ë¡œë“œ ë²„íŠ¼ì„ ëˆŒë €ì„ë•Œ ì‘ë™í•˜ê²Œ ë˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“¤ì–´ ë³´ì.
import java.io.File; import java.io.IOException; import java.io.InputStream; import org.apache.commons.io.FileUtils; import org.springframework.stereotype.Controller; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RequestMethod; import org.springframework.web.bind.annotation.RequestParam; import org.springframework.web.multipart.MultipartFile; import lombok.extern.slf4j.Slf4j; @Slf4j @Controller public class FileUploadController { // ë„ˆë¬´ ê°„ë‹¨ ... 	@RequestMapping(&#34;/form&#34;) public String form() { return &#34;form&#34;; } @RequestMapping(value = &#34;/upload&#34;, method = RequestMethod.POST) public String upload(@RequestParam(&#34;file&#34;) MultipartFile multipartFile) { log.info(&#34;### upload&#34;); File targetFile = new File(&#34;/home1/irteam/&#34; + multipartFile.getOriginalFilename()); try { InputStream fileStream = multipartFile.getInputStream(); FileUtils.copyInputStreamToFile(fileStream, targetFile); } catch (IOException e) { FileUtils.deleteQuietly(targetFile); e.printStackTrace(); } return &#34;redirect:/form&#34;; } } upload ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ fileì´ë¼ëŠ” ì´ë¦„ì˜ íŒŒë¼ë¯¸í„°ë¡œ MultipartFileì„ ë°›ê³  íŒŒì¼ì˜ ì´ë¦„ì„ í™•ì¸ í›„ ìŠ¤íŠ¸ë¦¼ì„ ì½ì–´ íŠ¹ì • ê²½ë¡œì— íŒŒì¼ë¡œ ì €ì¥í•˜ëŠ” ë¡œì§ì´ë‹¤. ê·¸ë‹¤ìŒ /formì„ ì ‘ì†í•˜ê²Œ ë˜ë©´ ë‚˜ì˜¤ëŠ” í¼ í™”ë©´ì„ ë§Œë“¤ì. ì´ê²ƒë„ ì•„ì£¼ ì‹¬í”Œí•˜ê²Œ!
<h1>íŒŒì¼ ì—…ë¡œë“œ</h1> <form action=&#34;/upload&#34; method=&#34;post&#34; enctype=&#34;multipart/form-data&#34;> <input type=&#34;file&#34; value=&#34;íŒŒì¼ ì„ íƒ&#34; name=&#34;file&#34;/> <input type=&#34;submit&#34; value=&#34;ì—…ë¡œë“œ&#34;/> </form> multipart/form-data ë¼ëŠ” Content-Type ì„ ëª…ì‹œí•´ì£¼ê³  íŒŒì¼ì„ ì„ íƒí•˜ë©´ /uploadë¡œ POSTìš”ì²­ì„ í•˜ë„ë¡ ì„¤ì •í•œë‹¤. ì´ë ‡ê²Œ ë˜ë©´ ë„ˆë¬´ ê°„ë‹¨í•˜ê²Œ + ì´ìƒì—†ì´ íŒŒì¼ì´ ì—…ë¡œë“œê°€ ì˜ ë˜ë‹ˆ ì´ê²Œ ì´ì•¼ê¸° í•  êº¼ë¦¬ì¸ê°€(?) ì‹¶ì„ì •ë„ë¡œ ì‹¬í”Œí•˜ë‹¤.
ê·¸ëŸ°ë° íŒŒì¼ í¬ê¸°ê°€ í¬ë‹¤ë©´? ì„¤ë§ˆ íŒŒì¼ ì—…ë¡œë“œ í•˜ëŠ” ìš©ëŸ‰ì´ í¬ê² ì–´?&mldr; ì™ ì§€ íŒŒì¼ì˜ ìš©ëŸ‰ì´ í¬ë©´ ë¬¸ì œìˆì„ê²ƒ ê°™ì€ë°&mldr; ì¶œì²˜ : https://m.blog.naver.com/naibbo0407/30170815180&#34; ì„¤ë§ˆ íŒŒì¼ ì—…ë¡œë“œ í•˜ëŠ” ìš©ëŸ‰ì´ í¬ê² ì–´?&mldr; ì™ ì§€ íŒŒì¼ì˜ ìš©ëŸ‰ì´ í¬ë©´ ë¬¸ì œìˆì„ê²ƒ ê°™ì€ë°&mldr; ì¶œì²˜ : https://m.blog.naver.com/naibbo0407/30170815180  ê°œë°œì„ í•˜ë‹¤ë³´ë©´ í•­ìƒ ìƒê°í•´ì•¼ í•  ë¶€ë¶„ì¤‘ì— í•˜ë‚˜ê°€ ë°”ë¡œ í™•ì¥ì„±ì¸ê²ƒ ê°™ë‹¤. ì´ ë¶€ë¶„ì—ì„œ ì—­ì‹œ ë¬¸ì œê°€ ë˜ì—ˆë˜ ê²ƒ. í‰ì†Œë³´ë‹¤ ìš©ëŸ‰ì´ í° íŒŒì¼ì´ ì—…ë¡œë“œê°€ ë˜ë©´ì„œ (í‰ì†Œ 3~400MB ì˜€ë‹¤ê°€ 3~4GBì •ë„ì˜ íŒŒì¼ì´ ì—…ë¡œë“œê°€ ë˜ëŠ” ë§¤ì§) ì—…ë¡œë“œê°€ ì•ˆë˜ëŠ” ìƒí™©ì´ ë°œìƒí•˜ì˜€ë‹¤. ë‹¹ì—°íˆ ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ëˆ„êµ°ê°€ ë§í–ˆë“¯ ë¡œê·¸ë¶€í„° ì‚´í´ë³´ì•˜ëŠ”ë° Apache - (AJP) - Tomcat ìœ¼ë¡œ êµ¬ì„±ëœ í™˜ê²½ì—ì„œ tomcat ë¡œê·¸ì— ### uploadë¼ëŠ” ë¡œê·¸ê°€ ì—†ê³  ì•„íŒŒì¹˜ ë¡œê·¸ì—” 502 ì—ëŸ¬ê°€ ë°œìƒí•œ ê²ƒì´ì—ˆë‹¤. ì™œ í†°ì¼“ ë¡œê·¸ë„ ì•ˆë‚¨ê³  ê·¸ì „ì— ì—ëŸ¬ê°€ ë°œìƒí•˜ì˜€ì„ê¹Œ? ì´ë•Œë¶€í„° (ê·¼ê±°ì—†ëŠ” ì¶”ì¸¡ì„ í•˜ë©°&mldr;) ê³ ë‚œê³¼ ì—­ê²½ì˜ ì‚½ì§ˆì„ í•˜ê¸° ì‹œì‘í•˜ê²Œ ëœë‹¤. í†°ì¼“ ë²„ì „ì´ ë¬¸ì œì¼ê¹Œ? ë¡œê·¸ê°€ ì•ˆì°í˜”ë‹¤ë©´ ë‹¤ë¥¸ í•„í„°ë‚˜ ì¸í„°ì…‰í„°ì—ì„œ ë¬´ì–¸ê°€ë¥¼ ë¨¹ê³ (?)ìˆëŠ”ê±´ ì•„ë‹ê¹Œ? ì ê¹, ê·¼ë° ì›ë˜ ëŒ€ìš©ëŸ‰ ì—…ë¡œë“œê°€ ë˜ê¸´ í•´? íŒŒì¼ ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œ í•˜ëŠ” ì‚¬ì´íŠ¸ ë³´ë©´ ë³„ë„ í”„ë¡œê·¸ë¨ìœ¼ë¡œ í•˜ë˜ë°&mldr; ê¼¬ë¶ˆê¼¬ë¶ˆ ë¯¸ë¡œì†ì„ í—¤ë©”ëŠ”ê²ƒë§Œ ê°™ì•˜ë˜ ì‚½ì§ˆì˜ ë¬¸ì œëŠ” ê²°êµ­ ë©”ëª¨ë¦¬ì— ìˆì—ˆë‹¤. íŒŒì¼ì„ ì—…ë¡œë“œ í•˜ê²Œ ë˜ë©´ í•´ë‹¹ ë‚´ìš©ì„ ìš°ì„  ë©”ëª¨ë¦¬ì— ë‹´ê²Œ ë˜ê³  ë‹¤ ë‹´ì€ í›„ ë©”ëª¨ë¦¬ì— ìˆëŠ” ë‚´ìš©ì„ wasì— ì „ë‹¬í•œ ë’¤ HttpServletRequest ë¡œ ë„˜ì–´ì˜¤ê²Œ ëœë‹¤.(Apache > Tomcat) ê·¸ëŸ°ë° íŒŒì¼ì„ ì—…ë¡œë“œ í•˜ë©´ì„œ ë©”ëª¨ë¦¬ì— íŒŒì¼ì´ ì¨ì§€ë‹¤ê°€ ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ OOMì´ ë°œìƒí•˜ê²Œ ë˜ë²„ë¦° ê²ƒì´ì—ˆë‹¤. ë˜í•œ ìŠ¤í”„ë§ íŒŒì¼ ìµœëŒ€í¬ê¸°ë¥¼ ë³„ë„ë¡œ ì§€ì •í•˜ì§€ ì•Šê³  ìˆì—ˆê¸° ë•Œë¬¸ì— ë©”ëª¨ë¦¬ê°€ ì¶©ë¶„í–ˆë‹¤ í•˜ë”ë¼ë„ ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ìƒí™©ì´ì—ˆë‹¤."><meta property="og:type" content="article"><meta property="og:url" content="https://taetaetae.github.io/2019/07/21/spring-file-upload/"><meta property="og:image" content="https://taetaetae.github.io/images/spring-file-upload/upload.png"><meta property="article:published_time" content="2019-07-21T22:09:58+00:00"><meta property="article:modified_time" content="2019-07-21T22:09:58+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://taetaetae.github.io/images/spring-file-upload/upload.png"><meta name=twitter:title content="ìŠ¤í”„ë§ì„ í™œìš©í•œ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ êµ¬í˜„"><meta name=twitter:description content="ê°œë°œì„ í•˜ë‹¤ë³´ë©´ ì‹¤ì œë¡œ ì§ì ‘ êµ¬í˜„ì„ í•´ë³¸ì ì€ ì—†ì§€ë§Œ ì—¬ê¸°ì €ê¸°ì„œ ë“¤ì–´ë³¸ ì§€ì‹ê³¼ ê·¸ ë™ì•ˆì˜ ì§¬ë°¥(?)ìœ¼ë¡œ ì¶”ì¸¡í•´ë³¼ìˆ˜ ìˆëŠ” ë¶€ë¶„ë“¤ì´ ìˆë‹¤. ë¬¼ë¡  ëª¨ë“ ì¼ì— ì •ë‹µì€ ì—†ê² ì§€ë§Œ ìš”ì¦˜ ëŠë¼ëŠ”ê±´ ì±…ì—ì„œ ê³µë¶€ë§Œ í•´ë³¸ê²ƒê³¼ ë‹¤ë¥¸ ë¸”ë¡œê·¸ë“¤ì—ì„œ ëˆˆìœ¼ë¡œë§Œ ë³´ê³  ë„˜ì–´ê°€ëŠ”ê²ƒë“¤ ê·¸ë¦¬ê³  ì§ì ‘ ì†ê°€ë½ì„ ì›€ì§ì—¬ê°€ë©° ì™œ ì—¬ê¸°ì„œëŠ” ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ì§€ ê³ ë¯¼í•˜ë©´ì„œ êµ¬í˜„ì„ í•´ë³¸ë‹¤ëŠ”ê±´ ì •ë§ ì—„ì²­ë‚˜ê²Œ í° ì°¨ì´ê°€ ìˆëŠ”ê²ƒ ê°™ë‹¤. ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•˜ë‹¤ë³´ë©´ í•œë²ˆ ì¯¤ ë§Œë‚˜ê²Œ ë˜ëŠ” íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥. í•„ìë„ ëª‡ë²ˆ êµ¬í˜„ì€ í•´ë´¤ì§€ë§Œ ê·¸ëƒ¥ ë‹¨ìˆœíˆ êµ¬í˜„ë§Œ í•´ë³¸ ìƒíƒœì˜€ë‹¤ê°€ ìµœê·¼ì— ê·¸ëƒ¥ íŒŒì¼ ì—…ë¡œë“œê°€ ì•„ë‹Œ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œì—ì„œì˜ ë¬¸ì œê°€ ë°œìƒí•˜ì—¬ ì—¬ê¸°ì €ê¸° ì‚½ì§ˆì„ í•˜ê²Œ ë˜ì—ˆê³  ì •ë¦¬ë„ í•´ë³¼ê²¸ ìŠ¤í”„ë§ì—ì„œì˜ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œì‹œ í•œë²ˆì¯¤ ê³ ë ¤í•´ë´ì•¼ í•  ë¶€ë¶„ì— ëŒ€í•´ ì •ë¦¬ë¥¼ í•´ë³´ë ¤ê³  í•œë‹¤.
 ë¬¼ë¡  êµ¬ê¸€ì—ì„œ ê²€ìƒ‰ì„ í•´ë³´ë©´ ì•„ë§ˆ í•„ìê°€ ì“´ê²ƒ ë³´ë‹¤ ë” ìì„¸í•˜ê³  ì¢‹ì€ ê¸€ë“¤ì´ ìˆê² ì§€ë§Œ í•„ìëŠ” ë³´ë‹¤ ëŒ€ìš©ëŸ‰ì— ì§‘ì¤‘ì—ì„œ ì‘ì„±í•´ ë³´ê³ ì í•œë‹¤. ëª…ì‹¬í•˜ì. &ldquo;ì•„ë¬´ë¦¬ íë¦° ì‰í¬ë¼ë„ ì¢‹ì€ ê¸°ì–µë ¥ë³´ë‹¤ ë‚«ë‹¤&rdquo; ë¼ëŠ” ë§ì´ ìˆë“¯ì´
 ìŠ¤í”„ë§ì„ í™œìš©í•œ íŒŒì¼ ì—…ë¡œë“œ êµ¬í˜„ ìš°ì„  ì™„ì „ ì´ˆê¸°ìƒíƒœì—ì„œ ì‹œì‘í•˜ê¸° ìœ„í•´ ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ê³  ê°„ë‹¨í•˜ê²Œ íŒŒì¼ ì—…ë¡œë“œë¥¼ í•  ìˆ˜ ìˆëŠ” form í˜ì´ì§€ì™€ ì—…ë¡œë“œ ë²„íŠ¼ì„ ëˆŒë €ì„ë•Œ ì‘ë™í•˜ê²Œ ë˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“¤ì–´ ë³´ì.
import java.io.File; import java.io.IOException; import java.io.InputStream; import org.apache.commons.io.FileUtils; import org.springframework.stereotype.Controller; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RequestMethod; import org.springframework.web.bind.annotation.RequestParam; import org.springframework.web.multipart.MultipartFile; import lombok.extern.slf4j.Slf4j; @Slf4j @Controller public class FileUploadController { // ë„ˆë¬´ ê°„ë‹¨ ... 	@RequestMapping(&#34;/form&#34;) public String form() { return &#34;form&#34;; } @RequestMapping(value = &#34;/upload&#34;, method = RequestMethod.POST) public String upload(@RequestParam(&#34;file&#34;) MultipartFile multipartFile) { log.info(&#34;### upload&#34;); File targetFile = new File(&#34;/home1/irteam/&#34; + multipartFile.getOriginalFilename()); try { InputStream fileStream = multipartFile.getInputStream(); FileUtils.copyInputStreamToFile(fileStream, targetFile); } catch (IOException e) { FileUtils.deleteQuietly(targetFile); e.printStackTrace(); } return &#34;redirect:/form&#34;; } } upload ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ fileì´ë¼ëŠ” ì´ë¦„ì˜ íŒŒë¼ë¯¸í„°ë¡œ MultipartFileì„ ë°›ê³  íŒŒì¼ì˜ ì´ë¦„ì„ í™•ì¸ í›„ ìŠ¤íŠ¸ë¦¼ì„ ì½ì–´ íŠ¹ì • ê²½ë¡œì— íŒŒì¼ë¡œ ì €ì¥í•˜ëŠ” ë¡œì§ì´ë‹¤. ê·¸ë‹¤ìŒ /formì„ ì ‘ì†í•˜ê²Œ ë˜ë©´ ë‚˜ì˜¤ëŠ” í¼ í™”ë©´ì„ ë§Œë“¤ì. ì´ê²ƒë„ ì•„ì£¼ ì‹¬í”Œí•˜ê²Œ!
<h1>íŒŒì¼ ì—…ë¡œë“œ</h1> <form action=&#34;/upload&#34; method=&#34;post&#34; enctype=&#34;multipart/form-data&#34;> <input type=&#34;file&#34; value=&#34;íŒŒì¼ ì„ íƒ&#34; name=&#34;file&#34;/> <input type=&#34;submit&#34; value=&#34;ì—…ë¡œë“œ&#34;/> </form> multipart/form-data ë¼ëŠ” Content-Type ì„ ëª…ì‹œí•´ì£¼ê³  íŒŒì¼ì„ ì„ íƒí•˜ë©´ /uploadë¡œ POSTìš”ì²­ì„ í•˜ë„ë¡ ì„¤ì •í•œë‹¤. ì´ë ‡ê²Œ ë˜ë©´ ë„ˆë¬´ ê°„ë‹¨í•˜ê²Œ + ì´ìƒì—†ì´ íŒŒì¼ì´ ì—…ë¡œë“œê°€ ì˜ ë˜ë‹ˆ ì´ê²Œ ì´ì•¼ê¸° í•  êº¼ë¦¬ì¸ê°€(?) ì‹¶ì„ì •ë„ë¡œ ì‹¬í”Œí•˜ë‹¤.
ê·¸ëŸ°ë° íŒŒì¼ í¬ê¸°ê°€ í¬ë‹¤ë©´? ì„¤ë§ˆ íŒŒì¼ ì—…ë¡œë“œ í•˜ëŠ” ìš©ëŸ‰ì´ í¬ê² ì–´?&mldr; ì™ ì§€ íŒŒì¼ì˜ ìš©ëŸ‰ì´ í¬ë©´ ë¬¸ì œìˆì„ê²ƒ ê°™ì€ë°&mldr; ì¶œì²˜ : https://m.blog.naver.com/naibbo0407/30170815180&#34; ì„¤ë§ˆ íŒŒì¼ ì—…ë¡œë“œ í•˜ëŠ” ìš©ëŸ‰ì´ í¬ê² ì–´?&mldr; ì™ ì§€ íŒŒì¼ì˜ ìš©ëŸ‰ì´ í¬ë©´ ë¬¸ì œìˆì„ê²ƒ ê°™ì€ë°&mldr; ì¶œì²˜ : https://m.blog.naver.com/naibbo0407/30170815180  ê°œë°œì„ í•˜ë‹¤ë³´ë©´ í•­ìƒ ìƒê°í•´ì•¼ í•  ë¶€ë¶„ì¤‘ì— í•˜ë‚˜ê°€ ë°”ë¡œ í™•ì¥ì„±ì¸ê²ƒ ê°™ë‹¤. ì´ ë¶€ë¶„ì—ì„œ ì—­ì‹œ ë¬¸ì œê°€ ë˜ì—ˆë˜ ê²ƒ. í‰ì†Œë³´ë‹¤ ìš©ëŸ‰ì´ í° íŒŒì¼ì´ ì—…ë¡œë“œê°€ ë˜ë©´ì„œ (í‰ì†Œ 3~400MB ì˜€ë‹¤ê°€ 3~4GBì •ë„ì˜ íŒŒì¼ì´ ì—…ë¡œë“œê°€ ë˜ëŠ” ë§¤ì§) ì—…ë¡œë“œê°€ ì•ˆë˜ëŠ” ìƒí™©ì´ ë°œìƒí•˜ì˜€ë‹¤. ë‹¹ì—°íˆ ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ëˆ„êµ°ê°€ ë§í–ˆë“¯ ë¡œê·¸ë¶€í„° ì‚´í´ë³´ì•˜ëŠ”ë° Apache - (AJP) - Tomcat ìœ¼ë¡œ êµ¬ì„±ëœ í™˜ê²½ì—ì„œ tomcat ë¡œê·¸ì— ### uploadë¼ëŠ” ë¡œê·¸ê°€ ì—†ê³  ì•„íŒŒì¹˜ ë¡œê·¸ì—” 502 ì—ëŸ¬ê°€ ë°œìƒí•œ ê²ƒì´ì—ˆë‹¤. ì™œ í†°ì¼“ ë¡œê·¸ë„ ì•ˆë‚¨ê³  ê·¸ì „ì— ì—ëŸ¬ê°€ ë°œìƒí•˜ì˜€ì„ê¹Œ? ì´ë•Œë¶€í„° (ê·¼ê±°ì—†ëŠ” ì¶”ì¸¡ì„ í•˜ë©°&mldr;) ê³ ë‚œê³¼ ì—­ê²½ì˜ ì‚½ì§ˆì„ í•˜ê¸° ì‹œì‘í•˜ê²Œ ëœë‹¤. í†°ì¼“ ë²„ì „ì´ ë¬¸ì œì¼ê¹Œ? ë¡œê·¸ê°€ ì•ˆì°í˜”ë‹¤ë©´ ë‹¤ë¥¸ í•„í„°ë‚˜ ì¸í„°ì…‰í„°ì—ì„œ ë¬´ì–¸ê°€ë¥¼ ë¨¹ê³ (?)ìˆëŠ”ê±´ ì•„ë‹ê¹Œ? ì ê¹, ê·¼ë° ì›ë˜ ëŒ€ìš©ëŸ‰ ì—…ë¡œë“œê°€ ë˜ê¸´ í•´? íŒŒì¼ ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œ í•˜ëŠ” ì‚¬ì´íŠ¸ ë³´ë©´ ë³„ë„ í”„ë¡œê·¸ë¨ìœ¼ë¡œ í•˜ë˜ë°&mldr; ê¼¬ë¶ˆê¼¬ë¶ˆ ë¯¸ë¡œì†ì„ í—¤ë©”ëŠ”ê²ƒë§Œ ê°™ì•˜ë˜ ì‚½ì§ˆì˜ ë¬¸ì œëŠ” ê²°êµ­ ë©”ëª¨ë¦¬ì— ìˆì—ˆë‹¤. íŒŒì¼ì„ ì—…ë¡œë“œ í•˜ê²Œ ë˜ë©´ í•´ë‹¹ ë‚´ìš©ì„ ìš°ì„  ë©”ëª¨ë¦¬ì— ë‹´ê²Œ ë˜ê³  ë‹¤ ë‹´ì€ í›„ ë©”ëª¨ë¦¬ì— ìˆëŠ” ë‚´ìš©ì„ wasì— ì „ë‹¬í•œ ë’¤ HttpServletRequest ë¡œ ë„˜ì–´ì˜¤ê²Œ ëœë‹¤.(Apache > Tomcat) ê·¸ëŸ°ë° íŒŒì¼ì„ ì—…ë¡œë“œ í•˜ë©´ì„œ ë©”ëª¨ë¦¬ì— íŒŒì¼ì´ ì¨ì§€ë‹¤ê°€ ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ OOMì´ ë°œìƒí•˜ê²Œ ë˜ë²„ë¦° ê²ƒì´ì—ˆë‹¤. ë˜í•œ ìŠ¤í”„ë§ íŒŒì¼ ìµœëŒ€í¬ê¸°ë¥¼ ë³„ë„ë¡œ ì§€ì •í•˜ì§€ ì•Šê³  ìˆì—ˆê¸° ë•Œë¬¸ì— ë©”ëª¨ë¦¬ê°€ ì¶©ë¶„í–ˆë‹¤ í•˜ë”ë¼ë„ ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ìƒí™©ì´ì—ˆë‹¤."><meta name=application-name content="ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„"><meta name=apple-mobile-web-app-title content="ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://taetaetae.github.io/2019/07/21/spring-file-upload/><link rel=prev href=https://taetaetae.github.io/2019/07/07/review-first-half-2019/><link rel=next href=https://taetaetae.github.io/2019/08/04/apache-load-balancing/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"ìŠ¤í”„ë§ì„ í™œìš©í•œ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ êµ¬í˜„","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/taetaetae.github.io\/2019\/07\/21\/spring-file-upload\/"},"genre":"posts","keywords":"fileupload, spring","wordcount":679,"url":"https:\/\/taetaetae.github.io\/2019\/07\/21\/spring-file-upload\/","datePublished":"2019-07-21T22:09:58+00:00","dateModified":"2019-07-21T22:09:58+00:00","publisher":{"@type":"Organization","name":"íƒœíƒœíƒœ"},"author":{"@type":"Person","name":"íƒœíƒœíƒœ"},"description":""}</script></head><body header-desktop=auto header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„">ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„">ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/>Posts</a><a class=menu-item href=/tags/>Tags</a><a class=menu-item href=/categories/>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:inline-block;width:260px;height:600px data-ad-client=ca-pub-5788330009690816 data-ad-slot=2248955907></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><article class="page single"><h1 class="single-title animated flipInX">ìŠ¤í”„ë§ì„ í™œìš©í•œ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ êµ¬í˜„</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://taetaetae.github.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>íƒœíƒœíƒœ</a></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw"></i>Tech</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2019-07-21>2019-07-21</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;679 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;4 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-file-upload/upload.png data-srcset="/images/spring-file-upload/upload.png, /images/spring-file-upload/upload.png 1.5x, /images/spring-file-upload/upload.png 2x" data-sizes=auto alt=/images/spring-file-upload/upload.png title=/images/spring-file-upload/upload.png></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#ìŠ¤í”„ë§ì„-í™œìš©í•œ-íŒŒì¼-ì—…ë¡œë“œ-êµ¬í˜„>ìŠ¤í”„ë§ì„ í™œìš©í•œ íŒŒì¼ ì—…ë¡œë“œ êµ¬í˜„</a></li><li><a href=#ê·¸ëŸ°ë°-íŒŒì¼-í¬ê¸°ê°€-í¬ë‹¤ë©´>ê·¸ëŸ°ë° íŒŒì¼ í¬ê¸°ê°€ í¬ë‹¤ë©´?</a></li><li><a href=#ì‚½ì§ˆì€-ê³§-ê²½í—˜ì´-ë˜ê³ -ì‹œì•¼ê°€-ëœë‹¤>ì‚½ì§ˆì€ ê³§ ê²½í—˜ì´ ë˜ê³  ì‹œì•¼ê°€ ëœë‹¤.</a></li></ul></nav></div></div><div class=content id=content><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block;height:150px data-ad-client=ca-pub-5788330009690816 data-ad-slot=9180895229 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script><p>ê°œë°œì„ í•˜ë‹¤ë³´ë©´ ì‹¤ì œë¡œ ì§ì ‘ êµ¬í˜„ì„ í•´ë³¸ì ì€ ì—†ì§€ë§Œ ì—¬ê¸°ì €ê¸°ì„œ ë“¤ì–´ë³¸ ì§€ì‹ê³¼ ê·¸ ë™ì•ˆì˜ ì§¬ë°¥(?)ìœ¼ë¡œ ì¶”ì¸¡í•´ë³¼ìˆ˜ ìˆëŠ” ë¶€ë¶„ë“¤ì´ ìˆë‹¤. ë¬¼ë¡  ëª¨ë“ ì¼ì— ì •ë‹µì€ ì—†ê² ì§€ë§Œ ìš”ì¦˜ ëŠë¼ëŠ”ê±´ ì±…ì—ì„œ ê³µë¶€ë§Œ í•´ë³¸ê²ƒê³¼ ë‹¤ë¥¸ ë¸”ë¡œê·¸ë“¤ì—ì„œ ëˆˆìœ¼ë¡œë§Œ ë³´ê³  ë„˜ì–´ê°€ëŠ”ê²ƒë“¤ ê·¸ë¦¬ê³  ì§ì ‘ ì†ê°€ë½ì„ ì›€ì§ì—¬ê°€ë©° ì™œ ì—¬ê¸°ì„œëŠ” ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ì§€ ê³ ë¯¼í•˜ë©´ì„œ êµ¬í˜„ì„ í•´ë³¸ë‹¤ëŠ”ê±´ ì •ë§ ì—„ì²­ë‚˜ê²Œ í° ì°¨ì´ê°€ ìˆëŠ”ê²ƒ ê°™ë‹¤.
ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•˜ë‹¤ë³´ë©´ í•œë²ˆ ì¯¤ ë§Œë‚˜ê²Œ ë˜ëŠ” <code>íŒŒì¼ ì—…ë¡œë“œ</code> ê¸°ëŠ¥. í•„ìë„ ëª‡ë²ˆ êµ¬í˜„ì€ í•´ë´¤ì§€ë§Œ ê·¸ëƒ¥ ë‹¨ìˆœíˆ <code>êµ¬í˜„</code>ë§Œ í•´ë³¸ ìƒíƒœì˜€ë‹¤ê°€ ìµœê·¼ì— ê·¸ëƒ¥ íŒŒì¼ ì—…ë¡œë“œê°€ ì•„ë‹Œ <code>ëŒ€ìš©ëŸ‰</code> íŒŒì¼ ì—…ë¡œë“œì—ì„œì˜ ë¬¸ì œê°€ ë°œìƒí•˜ì—¬ ì—¬ê¸°ì €ê¸° ì‚½ì§ˆì„ í•˜ê²Œ ë˜ì—ˆê³  ì •ë¦¬ë„ í•´ë³¼ê²¸ ìŠ¤í”„ë§ì—ì„œì˜ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œì‹œ í•œë²ˆì¯¤ ê³ ë ¤í•´ë´ì•¼ í•  ë¶€ë¶„ì— ëŒ€í•´ ì •ë¦¬ë¥¼ í•´ë³´ë ¤ê³  í•œë‹¤.</p><blockquote><p>ë¬¼ë¡  êµ¬ê¸€ì—ì„œ ê²€ìƒ‰ì„ í•´ë³´ë©´ ì•„ë§ˆ í•„ìê°€ ì“´ê²ƒ ë³´ë‹¤ ë” ìì„¸í•˜ê³  ì¢‹ì€ ê¸€ë“¤ì´ ìˆê² ì§€ë§Œ í•„ìëŠ” ë³´ë‹¤ <code>ëŒ€ìš©ëŸ‰</code>ì— ì§‘ì¤‘ì—ì„œ ì‘ì„±í•´ ë³´ê³ ì í•œë‹¤. ëª…ì‹¬í•˜ì. &ldquo;ì•„ë¬´ë¦¬ íë¦° ì‰í¬ë¼ë„ ì¢‹ì€ ê¸°ì–µë ¥ë³´ë‹¤ ë‚«ë‹¤&rdquo; ë¼ëŠ” ë§ì´ ìˆë“¯ì´</p></blockquote><h2 id=ìŠ¤í”„ë§ì„-í™œìš©í•œ-íŒŒì¼-ì—…ë¡œë“œ-êµ¬í˜„>ìŠ¤í”„ë§ì„ í™œìš©í•œ íŒŒì¼ ì—…ë¡œë“œ êµ¬í˜„</h2><p>ìš°ì„  ì™„ì „ ì´ˆê¸°ìƒíƒœì—ì„œ ì‹œì‘í•˜ê¸° ìœ„í•´ ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ê³  ê°„ë‹¨í•˜ê²Œ íŒŒì¼ ì—…ë¡œë“œë¥¼ í•  ìˆ˜ ìˆëŠ” form í˜ì´ì§€ì™€ ì—…ë¡œë“œ ë²„íŠ¼ì„ ëˆŒë €ì„ë•Œ ì‘ë™í•˜ê²Œ ë˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“¤ì–´ ë³´ì.</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=kn>import</span> <span class=nn>java.io.File</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>java.io.IOException</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>java.io.InputStream</span><span class=o>;</span>

<span class=kn>import</span> <span class=nn>org.apache.commons.io.FileUtils</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>org.springframework.stereotype.Controller</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>org.springframework.web.bind.annotation.RequestMapping</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>org.springframework.web.bind.annotation.RequestMethod</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>org.springframework.web.bind.annotation.RequestParam</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>org.springframework.web.multipart.MultipartFile</span><span class=o>;</span>

<span class=kn>import</span> <span class=nn>lombok.extern.slf4j.Slf4j</span><span class=o>;</span>

<span class=nd>@Slf4j</span>
<span class=nd>@Controller</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>FileUploadController</span> <span class=o>{</span>

	<span class=c1>// ë„ˆë¬´ ê°„ë‹¨ ...
</span><span class=c1></span>	<span class=nd>@RequestMapping</span><span class=o>(</span><span class=s>&#34;/form&#34;</span><span class=o>)</span>
	<span class=kd>public</span> <span class=n>String</span> <span class=nf>form</span><span class=o>()</span> <span class=o>{</span>
		<span class=k>return</span> <span class=s>&#34;form&#34;</span><span class=o>;</span>
	<span class=o>}</span>

	<span class=nd>@RequestMapping</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&#34;/upload&#34;</span><span class=o>,</span> <span class=n>method</span> <span class=o>=</span> <span class=n>RequestMethod</span><span class=o>.</span><span class=na>POST</span><span class=o>)</span>
	<span class=kd>public</span> <span class=n>String</span> <span class=nf>upload</span><span class=o>(</span><span class=nd>@RequestParam</span><span class=o>(</span><span class=s>&#34;file&#34;</span><span class=o>)</span> <span class=n>MultipartFile</span> <span class=n>multipartFile</span><span class=o>)</span> <span class=o>{</span>
		<span class=n>log</span><span class=o>.</span><span class=na>info</span><span class=o>(</span><span class=s>&#34;### upload&#34;</span><span class=o>);</span>
		<span class=n>File</span> <span class=n>targetFile</span> <span class=o>=</span> <span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=s>&#34;/home1/irteam/&#34;</span> <span class=o>+</span> <span class=n>multipartFile</span><span class=o>.</span><span class=na>getOriginalFilename</span><span class=o>());</span>
		<span class=k>try</span> <span class=o>{</span>
			<span class=n>InputStream</span> <span class=n>fileStream</span> <span class=o>=</span> <span class=n>multipartFile</span><span class=o>.</span><span class=na>getInputStream</span><span class=o>();</span>
			<span class=n>FileUtils</span><span class=o>.</span><span class=na>copyInputStreamToFile</span><span class=o>(</span><span class=n>fileStream</span><span class=o>,</span> <span class=n>targetFile</span><span class=o>);</span>
		<span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
			<span class=n>FileUtils</span><span class=o>.</span><span class=na>deleteQuietly</span><span class=o>(</span><span class=n>targetFile</span><span class=o>);</span>
			<span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
		<span class=o>}</span>
		<span class=k>return</span> <span class=s>&#34;redirect:/form&#34;</span><span class=o>;</span>
	<span class=o>}</span>
<span class=o>}</span>

</code></pre></div><p><code>upload</code> ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ <code>file</code>ì´ë¼ëŠ” ì´ë¦„ì˜ íŒŒë¼ë¯¸í„°ë¡œ <code>MultipartFile</code>ì„ ë°›ê³  íŒŒì¼ì˜ ì´ë¦„ì„ í™•ì¸ í›„ ìŠ¤íŠ¸ë¦¼ì„ ì½ì–´ íŠ¹ì • ê²½ë¡œì— íŒŒì¼ë¡œ ì €ì¥í•˜ëŠ” ë¡œì§ì´ë‹¤. ê·¸ë‹¤ìŒ <code>/form</code>ì„ ì ‘ì†í•˜ê²Œ ë˜ë©´ ë‚˜ì˜¤ëŠ” í¼ í™”ë©´ì„ ë§Œë“¤ì. ì´ê²ƒë„ ì•„ì£¼ ì‹¬í”Œí•˜ê²Œ!</p><div class=highlight><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>íŒŒì¼ ì—…ë¡œë“œ<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>form</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;/upload&#34;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;post&#34;</span> <span class=na>enctype</span><span class=o>=</span><span class=s>&#34;multipart/form-data&#34;</span><span class=p>&gt;</span>
	<span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;file&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;íŒŒì¼ ì„ íƒ&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;file&#34;</span><span class=p>/&gt;</span>
	<span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;ì—…ë¡œë“œ&#34;</span><span class=p>/&gt;</span>
<span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</code></pre></div><p><code>multipart/form-data</code> ë¼ëŠ” Content-Type ì„ ëª…ì‹œí•´ì£¼ê³  íŒŒì¼ì„ ì„ íƒí•˜ë©´ <code>/upload</code>ë¡œ POSTìš”ì²­ì„ í•˜ë„ë¡ ì„¤ì •í•œë‹¤. ì´ë ‡ê²Œ ë˜ë©´ ë„ˆë¬´ ê°„ë‹¨í•˜ê²Œ + ì´ìƒì—†ì´ íŒŒì¼ì´ ì—…ë¡œë“œê°€ ì˜ ë˜ë‹ˆ ì´ê²Œ ì´ì•¼ê¸° í•  êº¼ë¦¬ì¸ê°€(?) ì‹¶ì„ì •ë„ë¡œ ì‹¬í”Œí•˜ë‹¤.</p><h2 id=ê·¸ëŸ°ë°-íŒŒì¼-í¬ê¸°ê°€-í¬ë‹¤ë©´>ê·¸ëŸ°ë° íŒŒì¼ í¬ê¸°ê°€ í¬ë‹¤ë©´?</h2><figure><a class=lightgallery href=/images/spring-file-upload/omg.jpg title=/images/spring-file-upload/omg.jpg data-thumbnail=/images/spring-file-upload/omg.jpg data-sub-html="<h2>ì„¤ë§ˆ íŒŒì¼ ì—…ë¡œë“œ í•˜ëŠ” ìš©ëŸ‰ì´ í¬ê² ì–´?&mldr; ì™ ì§€ íŒŒì¼ì˜ ìš©ëŸ‰ì´ í¬ë©´ ë¬¸ì œìˆì„ê²ƒ ê°™ì€ë°&mldr; ì¶œì²˜ : https://m.blog.naver.com/naibbo0407/30170815180</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-file-upload/omg.jpg data-srcset="/images/spring-file-upload/omg.jpg, /images/spring-file-upload/omg.jpg 1.5x, /images/spring-file-upload/omg.jpg 2x" data-sizes=auto alt=/images/spring-file-upload/omg.jpg width=80%></a><figcaption class=image-caption>ì„¤ë§ˆ íŒŒì¼ ì—…ë¡œë“œ í•˜ëŠ” ìš©ëŸ‰ì´ í¬ê² ì–´?&mldr; ì™ ì§€ íŒŒì¼ì˜ ìš©ëŸ‰ì´ í¬ë©´ ë¬¸ì œìˆì„ê²ƒ ê°™ì€ë°&mldr;<br>ì¶œì²˜ : <a href=https://m.blog.naver.com/naibbo0407/30170815180>https://m.blog.naver.com/naibbo0407/30170815180</a></figcaption></figure><p>ê°œë°œì„ í•˜ë‹¤ë³´ë©´ í•­ìƒ ìƒê°í•´ì•¼ í•  ë¶€ë¶„ì¤‘ì— í•˜ë‚˜ê°€ ë°”ë¡œ í™•ì¥ì„±ì¸ê²ƒ ê°™ë‹¤. ì´ ë¶€ë¶„ì—ì„œ ì—­ì‹œ ë¬¸ì œê°€ ë˜ì—ˆë˜ ê²ƒ. í‰ì†Œë³´ë‹¤ ìš©ëŸ‰ì´ í° íŒŒì¼ì´ ì—…ë¡œë“œê°€ ë˜ë©´ì„œ (í‰ì†Œ 3~400MB ì˜€ë‹¤ê°€ 3~4GBì •ë„ì˜ íŒŒì¼ì´ ì—…ë¡œë“œê°€ ë˜ëŠ” ë§¤ì§) ì—…ë¡œë“œê°€ ì•ˆë˜ëŠ” ìƒí™©ì´ ë°œìƒí•˜ì˜€ë‹¤. ë‹¹ì—°íˆ ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ëˆ„êµ°ê°€ ë§í–ˆë“¯ ë¡œê·¸ë¶€í„° ì‚´í´ë³´ì•˜ëŠ”ë° Apache - (AJP) - Tomcat ìœ¼ë¡œ êµ¬ì„±ëœ í™˜ê²½ì—ì„œ tomcat ë¡œê·¸ì— <code>### upload</code>ë¼ëŠ” ë¡œê·¸ê°€ ì—†ê³  ì•„íŒŒì¹˜ ë¡œê·¸ì—” <code>502 ì—ëŸ¬</code>ê°€ ë°œìƒí•œ ê²ƒì´ì—ˆë‹¤. ì™œ í†°ì¼“ ë¡œê·¸ë„ ì•ˆë‚¨ê³  ê·¸ì „ì— ì—ëŸ¬ê°€ ë°œìƒí•˜ì˜€ì„ê¹Œ?
ì´ë•Œë¶€í„° (ê·¼ê±°ì—†ëŠ” ì¶”ì¸¡ì„ í•˜ë©°&mldr;) ê³ ë‚œê³¼ ì—­ê²½ì˜ ì‚½ì§ˆì„ í•˜ê¸° ì‹œì‘í•˜ê²Œ ëœë‹¤. í†°ì¼“ ë²„ì „ì´ ë¬¸ì œì¼ê¹Œ? ë¡œê·¸ê°€ ì•ˆì°í˜”ë‹¤ë©´ ë‹¤ë¥¸ í•„í„°ë‚˜ ì¸í„°ì…‰í„°ì—ì„œ ë¬´ì–¸ê°€ë¥¼ ë¨¹ê³ (?)ìˆëŠ”ê±´ ì•„ë‹ê¹Œ? ì ê¹, ê·¼ë° ì›ë˜ ëŒ€ìš©ëŸ‰ ì—…ë¡œë“œê°€ ë˜ê¸´ í•´? íŒŒì¼ ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œ í•˜ëŠ” ì‚¬ì´íŠ¸ ë³´ë©´ ë³„ë„ í”„ë¡œê·¸ë¨ìœ¼ë¡œ í•˜ë˜ë°&mldr; ê¼¬ë¶ˆê¼¬ë¶ˆ ë¯¸ë¡œì†ì„ í—¤ë©”ëŠ”ê²ƒë§Œ ê°™ì•˜ë˜ ì‚½ì§ˆì˜ ë¬¸ì œëŠ” ê²°êµ­ <code>ë©”ëª¨ë¦¬</code>ì— ìˆì—ˆë‹¤.
íŒŒì¼ì„ ì—…ë¡œë“œ í•˜ê²Œ ë˜ë©´ í•´ë‹¹ ë‚´ìš©ì„ ìš°ì„  ë©”ëª¨ë¦¬ì— ë‹´ê²Œ ë˜ê³  ë‹¤ ë‹´ì€ í›„ ë©”ëª¨ë¦¬ì— ìˆëŠ” ë‚´ìš©ì„ wasì— ì „ë‹¬í•œ ë’¤ HttpServletRequest ë¡œ ë„˜ì–´ì˜¤ê²Œ ëœë‹¤.(Apache > Tomcat) ê·¸ëŸ°ë° íŒŒì¼ì„ ì—…ë¡œë“œ í•˜ë©´ì„œ ë©”ëª¨ë¦¬ì— íŒŒì¼ì´ ì¨ì§€ë‹¤ê°€ ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ OOMì´ ë°œìƒí•˜ê²Œ ë˜ë²„ë¦° ê²ƒì´ì—ˆë‹¤. ë˜í•œ ìŠ¤í”„ë§ íŒŒì¼ ìµœëŒ€í¬ê¸°ë¥¼ ë³„ë„ë¡œ ì§€ì •í•˜ì§€ ì•Šê³  ìˆì—ˆê¸° ë•Œë¬¸ì— ë©”ëª¨ë¦¬ê°€ ì¶©ë¶„í–ˆë‹¤ í•˜ë”ë¼ë„ ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ìƒí™©ì´ì—ˆë‹¤. ( <a href=https://spring.io/guides/gs/uploading-files/>https://spring.io/guides/gs/uploading-files/</a> ì°¸ì¡° )</p><pre><code>spring.servlet.multipart.max-file-size
spring.servlet.multipart.max-request-size
</code></pre><p>ê·¸ëŸ¬ë‹¤ë³´ë‹ˆ ì›¹ ì„œë²„ì¸ ì•„íŒŒì¹˜ì—ì„œëŠ” was ì—ëŸ¬ì¸ <code>503</code>ì´ ì•„ë‹Œ <code>502</code>ë¼ê³  ì—ëŸ¬ë¥¼ ë°œìƒí•˜ë˜ ê²ƒì´ì˜€ê³  ì§€ë‚˜ê³  ë³´ë©´ ì •ë§ ì•„ë¬´ê²ƒë„ ì•„ë‹Œ ê°„ë‹¨í•œ ì„¤ì •ë“¤ì„ ë†“ì¹œ ë¬¸ì œì˜€ëŠ”ë° ê½¤ë‚˜ ê¸´ ì‹œê°„ì„ í—ˆë¹„í•´ì•¼ë§Œ í–ˆë˜ ì•ˆíƒ€ê¹ì§€ë§Œ ë³´ëŒì°¼ë˜ (ì‘?) íŠ¸ëŸ¬ë¸” ìŠˆíŒ…ì´ì—ˆë‹¤.</p><h2 id=ì‚½ì§ˆì€-ê³§-ê²½í—˜ì´-ë˜ê³ -ì‹œì•¼ê°€-ëœë‹¤>ì‚½ì§ˆì€ ê³§ ê²½í—˜ì´ ë˜ê³  ì‹œì•¼ê°€ ëœë‹¤.</h2><p>legacy ë¡œì§ì´ë‹¤ë³´ë‹ˆ wasê°€ íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬ë¥¼ í•˜ê²Œ ë˜ì—ˆëŠ”ë° ê°€ê¸‰ì ì´ë©´ wasê°€ ì²˜ë¦¬í•˜ëŠ”ê²ƒ ë³´ë‹¤ëŠ” static íŒŒì¼ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ë³„ë„ì˜ ì›¹ì„œë²„ë¥¼ ë§Œë“œëŠ”ê²Œ ì–´ë–¨ê¹Œ ìƒê°ì´ ë“ ë‹¤. (ì¡°ê¸ˆ ì•Œì•„ë³´ë‹ˆ nodejs ëª¨ë“ˆì¸ <a href=https://github.com/expressjs/multer target=_blank rel="noopener noreffer">multer</a> ë¼ëŠ”ê²Œ ìˆë‹¤.) ë¬¼ë¡  íŒŒì¼ ì—…ë¡œë“œ í•œ ë’¤ì— ë³„ë„ì˜ ë¡œì§ì„ ì²˜ë¦¬í•˜ë ¤ë©´ wasê°€ ê´€ì—¬ë¥¼ í•´ì•¼ê² ì§€ë§Œ ì´ ë¶€ë¶„ì€ ì„¤ê³„ë¥¼ ì–´ë–»ê²Œ í•˜ëƒì— ë”°ë¼ ì¶©ë¶„íˆ í•´ê²°í•  ìˆ˜ ìˆì„ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. (ì›¹ì„œë²„ì—ì„œ íŒŒì¼ì„ ì—…ë¡œë“œ í•œ ë’¤ ë¹„ë™ê¸°ë¡œ íŒŒì¼ ì—…ë¡œë“œ ì™„ë£Œì—¬ë¶€ì— ë”°ë¼ wasì—ì„œ ì²˜ë¦¬ë¥¼ í•œë‹¤ê±°ë‚˜ ë“±&mldr;)
ë”ë¶ˆì–´ í•­ìƒ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ë•Œì—ëŠ” <code>ì˜ˆì™¸ì²˜ë¦¬</code>ë¼ëŠ” ê²ƒì„ ìƒê°í•˜ë©´ì„œ ê°œë°œí•´ì•¼í•œë‹¤ê³  ëŠë¼ê²Œ ë˜ì—ˆë‹¤. NPE ê°™ì€ ì‚¬ì†Œí•œ ë¡œì§ì—ì„œì˜ ì˜ˆì™¸ì²˜ë¦¬ë¶€í„° íŒŒì¼ ì—…ë¡œë“œì‹œ ì„œë²„ì˜ ë©”ëª¨ë¦¬ë¥¼ ìƒê°í• ìˆ˜ ìˆëŠ” ì‹œì•¼. ì´ëŸ°ê²Œ ê²½í—˜ì´ ì•„ë‹ê¹Œ ì‹¶ë‹¤.
ë˜í•œ (ì˜ ëŒì•„ê°€ë‹ˆê¹Œ) í™˜ê²½ì„¤ì • ê°’ì„ ìˆ˜ì •í•˜ì§€ ì•Šê³  ë°°í¬í•˜ëŠ” ê²ƒë³´ë‹¨ ê°€ê¸‰ì  ì–´ë–¤ ì„¤ì •ê°’ë“¤ì— ì˜í•´ì„œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ëŒì•„ê°€ëŠ”ì§€ íŠ¹íˆ, ìŠ¤í”„ë§ ê°™ì€ í”„ë ˆì„ì›Œí¬ì˜ ë„ì›€ì„ ë°›ëŠ”ë‹¤ë©´ í•´ë‹¹ í”„ë ˆì„ì›Œí¬ì˜ ì„¤ì •ê°’ë“¤ì„ ìˆ˜ì •í•˜ë©° ì„±ëŠ¥ì— ì´ë“ì„ ì·¨í•  ë¶€ë¶„ë“¤ì€ ì—†ëŠ”ì§€ ê¼¼ê¼¼í•˜ê²Œ ê°œë°œí•˜ëŠ” ìŠµê´€ì„ ê¸¸ëŸ¬ì•¼ í•  ê²ƒ ê°™ë‹¤.</p><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block;height:150px data-ad-client=ca-pub-5788330009690816 data-ad-slot=9180895229 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><center><style>.bmc-button img{width:27px!important;margin-bottom:1px!important;box-shadow:none!important;border:none!important;vertical-align:middle!important}.bmc-button{line-height:29px!important;height:30px!important;text-decoration:none!important;display:inline-flex!important;color:#000!important;background-color:#fd0!important;border-radius:3px!important;border:1px solid transparent!important;padding:1px 9px!important;font-size:22px!important;letter-spacing:.6px!important;box-shadow:0 1px 2px rgba(190,190,190,.5)!important;-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;margin:0 auto!important;font-family:cookie,cursive!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;-o-transition:.3s all linear!important;-webkit-transition:.3s all linear!important;-moz-transition:.3s all linear!important;-ms-transition:.3s all linear!important;transition:.3s all linear!important}.bmc-button:hover,.bmc-button:active,.bmc-button:focus{-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;text-decoration:none!important;box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;opacity:.85!important;color:#000!important}</style><link href="https://fonts.googleapis.com/css?family=Cookie" rel=stylesheet><center><br><a class=bmc-button target=_blank href=https://www.buymeacoffee.com/taetaetae><img src=https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg alt="Buy me a coffee"><span style=margin-left:5px>Buy me a coffee</span></a>
<a href=https://bit.ly/ddbSupport target=_blank><img src=https://i.imgur.com/peaYpjh.png style=height:28px></a></center><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2019-07-21</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://taetaetae.github.io/2019/07/21/spring-file-upload/ data-title="ìŠ¤í”„ë§ì„ í™œìš©í•œ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ êµ¬í˜„" data-hashtags=fileupload,spring><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://taetaetae.github.io/2019/07/21/spring-file-upload/ data-hashtag=fileupload><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://taetaetae.github.io/2019/07/21/spring-file-upload/><i class="fab fa-linkedin fa-fw"></i></a><a href=javascript:void(0); title="Share on Blogger" data-sharer=blogger data-url=https://taetaetae.github.io/2019/07/21/spring-file-upload/ data-title="ìŠ¤í”„ë§ì„ í™œìš©í•œ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ êµ¬í˜„" data-description><i class="fab fa-blogger fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/fileupload/>fileupload</a>,&nbsp;<a href=/tags/spring/>spring</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2019/07/07/review-first-half-2019/ class=prev rel=prev title="2019 ìƒë°˜ê¸° ë¦¬ë·° (feat. ê¸€ë˜)"><i class="fas fa-angle-left fa-fw"></i>2019 ìƒë°˜ê¸° ë¦¬ë·° (feat. ê¸€ë˜)</a>
<a href=/2019/08/04/apache-load-balancing/ class=next rel=next title="ì•„íŒŒì¹˜ ë¡œë“œë°¸ëŸ°ì‹±ìœ¼ë¡œ ì—¬ëŸ¬ WAS ìš´ì˜í•˜ê¸°">ì•„íŒŒì¹˜ ë¡œë“œë°¸ëŸ°ì‹±ìœ¼ë¡œ ì—¬ëŸ¬ WAS ìš´ì˜í•˜ê¸°<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=utterances></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.74.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i>LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2016 - 2020</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://taetaetae.github.io target=_blank>íƒœíƒœíƒœ</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":500},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"Comment","lightTheme":"github-light","repo":"taetaetae/blog-comment"}},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true}};</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','UA-86432198-1',{'anonymize_ip':true});</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-86432198-1" async></script></body></html>