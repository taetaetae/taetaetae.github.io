<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.147.9"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title></title><meta property="og:description" content="This is my cool site"><meta property="og:url" content="https://taetaetae.github.io/"><meta property="og:type" content="website"><meta property="og:locale" content="en"><meta name=twitter:card content="summary"><meta name=twitter:description content="This is my cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://taetaetae.github.io/><link rel=alternate href=/index.xml type=application/rss+xml title><link rel=feed href=/index.xml type=application/rss+xml title><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","url":"https:\/\/taetaetae.github.io\/","inLanguage":"en","author":{"@type":"Person","name":"태태태"},"description":"This is my cool site","name":""}</script></head><body data-header-desktop=auto data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title>👨‍💻꿈꾸는 태태태의 공간</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title>👨‍💻꿈꾸는 태태태의 공간</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class="page home" data-home=posts><div class=home-profile><div class=home-avatar><a href=/posts/ title=Posts><img class=lazyload src=/svg/loading.min.svg data-src=/images/profile.png data-srcset="/images/profile.png, /images/profile.png 1.5x, /images/profile.png 2x" data-sizes=auto alt=/images/profile.png title=/images/profile.png></a></div><div class=home-subtitle><div id=id-1 class=typeit></div></div><div class=links><a href=https://github.com/taetaetae title=GitHub target=_blank rel="noopener noreffer me"><i class="fab fa-github fa-fw" aria-hidden=true></i></a><a href=https://linkedin.com/in/taetaetae title=LinkedIn target=_blank rel="noopener noreffer me"><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=https://www.instagram.com/_taetaetae title=Instagram target=_blank rel="noopener noreffer me"><i class="fab fa-instagram fa-fw" aria-hidden=true></i></a><a href=https://facebook.com/taetaetae0 title=facebook target=_blank rel="noopener noreffer me"><i class="fab fa-facebook fa-fw" aria-hidden=true></i></a><a href=mailto:taetaetae_@naver.com title=Email rel=me><i class="far fa-envelope fa-fw" aria-hidden=true></i></a><a href=/index.xml title=RSS target=_blank rel="noopener noreffer me"><i class="fas fa-rss fa-fw" aria-hidden=true></i></a></div></div><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2017/04/04/mybatis-use-generated-keys/><img class=lazyload src=/svg/loading.min.svg data-src=/images/mybatis-useGeneratedKeys/mybatis.png data-srcset="/images/mybatis-useGeneratedKeys/mybatis.png, /images/mybatis-useGeneratedKeys/mybatis.png 1.5x, /images/mybatis-useGeneratedKeys/mybatis.png 2x" data-sizes=auto alt=/images/mybatis-useGeneratedKeys/mybatis.png title=/images/mybatis-useGeneratedKeys/mybatis.png></a></div><h1 class=single-title itemprop="name headline"><a href=/2017/04/04/mybatis-use-generated-keys/>mybatis insert/update 쿼리실행후 결과 가져오기</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-04-04>2017-04-04</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><p><code>Select</code>문이 아닌 다른 <code>SQL Query</code>(insert, update 등) 를 실행하고서 결과를 봐야하는 상황이 생긴다. 정확히 잘 수행되었나에 대한 확인. 어떻게 쿼리가 잘 수행되었나를 확인하는 방법은 다음과 같다.
※ 참고 url : <a href=http://www.mybatis.org/mybatis-3/ko/sqlmap-xml.html target=_blank rel="noopener noreffer">http://www.mybatis.org/mybatis-3/ko/sqlmap-xml.html</a></p><h2 id=usegeneratedkeys-keyproperty-옵션>useGeneratedKeys, keyProperty 옵션</h2><p>사용하는 데이터베이스가 자동생성키를 지원한다면(mySql 같은) 해당옵션을 이용해 결과를 리턴 받을수 있다.
예로들어 파라미터로 아래 모델객체를 넘긴다고 가정하고</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=n>Student</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>String</span><span class=w> </span><span class=n>email</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>Date</span><span class=w> </span><span class=n>regist_date</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>아래 mybatis 구문으로 insert를 시도하게되면, 파라미터로 넘긴 Student 객체의 id값에 insert 했을때의 key값(id)이 들어오게 된다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Student</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Student</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>student</span><span class=p>.</span><span class=na>setName</span><span class=p>(</span><span class=err>&#39;</span><span class=n>bla</span><span class=err>&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>student</span><span class=p>.</span><span class=na>setEmail</span><span class=p>(</span><span class=err>&#39;</span><span class=n>bla</span><span class=nd>@naver.com</span><span class=err>&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>mapper</span><span class=p>.</span><span class=na>insertStudents</span><span class=p>(</span><span class=n>student</span><span class=p>);</span><span class=w> </span><span class=c1>// 쿼리실행</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>student</span><span class=p>.</span><span class=na>getId</span><span class=p>();</span><span class=w> </span><span class=c1>// 추출 가능</span><span class=w>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;insert</span> <span class=na>id=</span><span class=s>&#34;insertStudents&#34;</span> <span class=na>useGeneratedKeys=</span><span class=s>&#34;true&#34;</span> <span class=na>keyProperty=</span><span class=s>&#34;id&#34;</span> <span class=na>parameterType=</span><span class=s>&#34;Student&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>  insert into Students ( name, email )
</span></span><span class=line><span class=cl>  values ( #{name}, #{email} )
</span></span><span class=line><span class=cl><span class=nt>&lt;/insert&gt;</span>
</span></span></code></pre></div><h2 id=selectkey-옵션>selectKey 옵션</h2><p>Oracle 같은 경우는 Auto Increment 가 없고 Sequence를 사용해야만 하기 때문에 위 옵션을 사용할수가 없다. 하지만 다른 우회적인(?) 방법으로 위와같은 효과를 볼수가 있다.
파라미터의 모델이나 java구문은 위와 동일하고 xml 쿼리 부분만 아래와 같이 설정해주면 된다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;insert</span> <span class=na>id=</span><span class=s>&#34;insertStudents&#34;</span> <span class=na>parameterType=</span><span class=s>&#34;Student&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;selectKey</span> <span class=na>keyProperty=</span><span class=s>&#34;id&#34;</span> <span class=na>resultType=</span><span class=s>&#34;int&#34;</span> <span class=na>order=</span><span class=s>&#34;BEFORE&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    select SEQ_ID.nexyval FROM DUAL
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/selectKey&gt;</span>
</span></span><span class=line><span class=cl>  insert into Students
</span></span><span class=line><span class=cl>    (id, name , email)
</span></span><span class=line><span class=cl>  values
</span></span><span class=line><span class=cl>    (#{id}, #{name}, #{email})
</span></span><span class=line><span class=cl><span class=nt>&lt;/insert&gt;</span>
</span></span></code></pre></div><p>위와같은 코드에서 쿼리가 실행되기 전에 id값에 Sequence에 의해 값을 셋팅하게 되고, 자동적으로 해당 값을 Student의 id에 set하게 되서 동일한 결과를 볼수가 있다.</p><p>항상 테이블의 key값에만 해당하는것이 아니다. key값과는 전혀 상관없는 값도 <code>selectKey</code> 구문으로 리턴할수가 있는데 <code>order</code>옵션을 <code>AFTER</code>로 주고 리턴하고자 하는 값을 명시해주면 된다.
아래 코드에서는 입력할시 id값을 Sequence에서 가져오는게 아니라 수동으로 넣어주고, 입력했던 id에 맞는 regist_date 값을 리턴받아 위에서처럼 동일하게 값를 가져올수 있다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;insert</span> <span class=na>id=</span><span class=s>&#34;insertStudents&#34;</span> <span class=na>parameterType=</span><span class=s>&#34;Student&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;selectKey</span> <span class=na>keyProperty=</span><span class=s>&#34;regist_date&#34;</span> <span class=na>resultType=</span><span class=s>&#34;java.util.Date&#34;</span> <span class=na>order=</span><span class=s>&#34;AFTER&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    select regist_date FROM students WHERE id = #{id}
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/selectKey&gt;</span>
</span></span><span class=line><span class=cl>  insert into Students
</span></span><span class=line><span class=cl>    (id, name , email, regist_date)
</span></span><span class=line><span class=cl>  values
</span></span><span class=line><span class=cl>    (#{id}, #{name}, #{email}, syadate)
</span></span><span class=line><span class=cl><span class=nt>&lt;/insert&gt;</span>
</span></span></code></pre></div></div><div class=post-footer><a href=/2017/04/04/mybatis-use-generated-keys/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/mybatis/>Mybatis</a>,&nbsp;<a href=/tags/oracle/>Oracle</a>,&nbsp;<a href=/tags/archives-2017/>Archives-2017</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2017/03/23/oracle-mybatis-date/><img class=lazyload src=/svg/loading.min.svg data-src=/images/oracle-mybatis-date/oracle_mybatis_date.png data-srcset="/images/oracle-mybatis-date/oracle_mybatis_date.png, /images/oracle-mybatis-date/oracle_mybatis_date.png 1.5x, /images/oracle-mybatis-date/oracle_mybatis_date.png 2x" data-sizes=auto alt=/images/oracle-mybatis-date/oracle_mybatis_date.png title=/images/oracle-mybatis-date/oracle_mybatis_date.png></a></div><h1 class=single-title itemprop="name headline"><a href=/2017/03/23/oracle-mybatis-date/>Oracle + Mybatis 환경에서의 Date 다루기</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-03-23>2017-03-23</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><h2 id=상황>상황</h2><ul><li>Oracle, Java 8, mybatis3 환경</li><li>Date컬럼에 데이터가 있는데 이를 select query로 조회하여 Model에 바인딩 시키고자 함.</li></ul><ul><li>쿼리에 아무 기능을 추가하지 않고 Date 형태로 Model에 바인딩을 하면 시분초가 없어진 <code>2017-01-01 00:00:00</code> 형태로 남게됨</li><li>그래서 아래처럼 쿼리 작성할 때마다 TO_CHAR를 사용해서 포맷에 맞추어 형변환을 시키고 Date 또는 String으로 Model에 바인딩 하곤 했음.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>TO_CHAR</span><span class=p>(</span><span class=n>reg_ymdt</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;YYYY-MM-DD HH24:MI:SS&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>registDate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>...</span><span class=w>
</span></span></span></code></pre></div><ul><li>이렇게 하다보니 query 만들때마다 형변환하는 쿼리를 만들어줘야하고, 자칫 포맷형식을 다르게 적으면 엉뚱한 결과를 초래하거나, Date형을 그대로 받아 사용해야하는 상황에서는 다시 형변환하는 과정(<code>String to Date</code>)을 해줘야만 함. .. <code>귀차니즘의 시작 : 삽질</code></li></ul><h2 id=1-삽질의-시작>1. 삽질의 시작</h2><h3 id=1-1-오라클의-date형--javasqldate-의-경우>1-1. <code>오라클의 DATE형</code> → <code>java.sql.Date</code> 의 경우</h3><ul><li>mybatis에서는 자동적으로 <code>org.apache.ibatis.type.SqlDateTypeHandler</code>를 호출하게됨 <a href=http://www.mybatis.org/mybatis-3/ko/configuration.html#typeHandlers target=_blank rel="noopener noreffer">mybatis 3 문서 참고</a></li><li>해당 핸들러의 내부 데이터 변환 코드는 다음과 같음</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>Date</span><span class=w> </span><span class=nf>getNullableResult</span><span class=p>(</span><span class=n>ResultSet</span><span class=w> </span><span class=n>rs</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>columnName</span><span class=p>)</span><span class=w>  </span><span class=kd>throws</span><span class=w> </span><span class=n>SQLException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>return</span><span class=w> </span><span class=n>rs</span><span class=p>.</span><span class=na>getDate</span><span class=p>(</span><span class=n>columnName</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><ul><li><code>java.sql.ResultSet.getDate()</code>메소드를 호출하면 실제 &lsquo;yyyy-mm-dd&rsquo; 만 가져와 리턴하게됨 (여기서 디버깅 해보면 rs.getTimestamp(columnName)값은 시분초까지 다 들어가 있음)</li><li>따라서 시간값이 없는 <code>yyyy-mm-dd</code> 형태로 리턴이 됨</li></ul><h3 id=1-2-오라클의-date형--javautildate-의-경우>1-2. <code>오라클의 DATE형</code> → <code>java.util.Date</code> 의 경우</h3><ul><li>mybatis에서는 자동적으로 <code>org.apache.ibatis.type.DateOnlyTypeHandler</code>를 호출하게됨 <a href=http://www.mybatis.org/mybatis-3/ko/configuration.html#typeHandlers target=_blank rel="noopener noreffer">mybatis 3 문서 참고</a></li><li>해당 핸들러의 내부 데이터 변환 코드는 다음과 같음</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>Date</span><span class=w> </span><span class=nf>getNullableResult</span><span class=p>(</span><span class=n>ResultSet</span><span class=w> </span><span class=n>rs</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>columnName</span><span class=p>)</span><span class=w>  </span><span class=kd>throws</span><span class=w> </span><span class=n>SQLException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>java</span><span class=p>.</span><span class=na>sql</span><span class=p>.</span><span class=na>Date</span><span class=w> </span><span class=n>sqlDate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rs</span><span class=p>.</span><span class=na>getDate</span><span class=p>(</span><span class=n>columnName</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>sqlDate</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>java</span><span class=p>.</span><span class=na>util</span><span class=p>.</span><span class=na>Date</span><span class=p>(</span><span class=n>sqlDate</span><span class=p>.</span><span class=na>getTime</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>return</span><span class=w> </span><span class=kc>null</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><ul><li>위의 <code>org.apache.ibatis.type.SqlDateTypeHandler</code> 변환코드에서 발생한 문제점과 같이 <code>yyyy-mm-dd</code> 만 가져와서 java.sql.Date 객체를 만들고, 이 정보를 토대로 java.util.Date 객체를 만들게 되는데 앞서 시간값을 뺀 정보로 만들어졌기 때문에 결국 동일하게 <code>yyyy-mm-dd</code> 형태로 리턴이 됨</li></ul><h2 id=2-삽질완료-해결의-시작>2. 삽질완료, 해결의 시작</h2><ul><li>오라클 + mybatis 환경에서 Date타입을 다루기 위해서는 타입핸들러를 명시적으로 만들어줘야 한다는걸 알게됨.</li></ul><h4 id=2-1-오라클의-date형--javasqldate-의-경우>2-1. <code>오라클의 DATE형</code> → <code>java.sql.Date</code> 의 경우</h4><ul><li>아래처럼 코드를 작성하여 커스텀 핸들러를 만들어 등록을 시켜준다.</li><li>mybatis-config.xml</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;typeHandlers&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;typeHandler</span> <span class=na>handler=</span><span class=s>&#34;com.naver.dbill.admin.common.handler.CustomDateHandler&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/typeHandlers&gt;</span>
</span></span></code></pre></div><ul><li>CustomDateHandler.java</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.sql.Date</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>CustomDateHandler</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>BaseTypeHandler</span><span class=o>&lt;</span><span class=n>Date</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>Date</span><span class=w> </span><span class=nf>getNullableResult</span><span class=p>(</span><span class=n>ResultSet</span><span class=w> </span><span class=n>rs</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>columnName</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>SQLException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>Timestamp</span><span class=w> </span><span class=n>sqlTimestamp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rs</span><span class=p>.</span><span class=na>getTimestamp</span><span class=p>(</span><span class=n>columnName</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>sqlTimestamp</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Date</span><span class=p>(</span><span class=n>sqlTimestamp</span><span class=p>.</span><span class=na>getTime</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=kc>null</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><ul><li>위 코드를 작성하고 실행해보면 정상적으로 시분초 값이 있는 완전한 Date 형태를 볼수 있다.</li></ul><h4 id=2-2-오라클의-date형--javautildate-의-경우>2-2. <code>오라클의 DATE형</code> → <code>java.util.Date</code> 의 경우</h4><ul><li>아래처럼 코드를 작성하여 커스텀 핸들러를 만들어 등록을 시켜준다.</li><li>단, <a href=http://www.mybatis.org/mybatis-3/ko/configuration.html#typeHandlers target=_blank rel="noopener noreffer">mybatis 3 문서</a>를 보면 <code>java.sql.Date</code> 와는 다르게 기본으로 설정된 typeHandler가 JDBC에 따라 3가지가 있다.</li><li>따라서 작성한 커스텀 핸들러를 적용하기 위해서는 명시적으로 <code>자바타입</code> 과 <code>JDBC타입</code> 을 적어줘야 정상적으로 오버라이딩이 되어 해당 핸들러를 사용하게 된다.</li><li>mybatis-config.xml</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;typeHandlers&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;typeHandler</span> <span class=na>handler=</span><span class=s>&#34;com.naver.dbill.admin.common.handler.CustomDateHandler&#34;</span> <span class=na>javaType=</span><span class=s>&#34;java.util.Date&#34;</span> <span class=na>jdbcType=</span><span class=s>&#34;DATE&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/typeHandlers&gt;</span>
</span></span></code></pre></div><ul><li>CustomDateHandler.java 는 위와 동일하다. ( import java.util.Date; 사용으로 변경 )</li></ul><h3 id=삽질하며-알게된-보너스-지식>삽질하며 알게된 보너스 지식</h3><ul><li><code>java.sql.Date</code> 는 <code>java.util.Date</code> 을 상속받았다.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Date</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>java</span><span class=p>.</span><span class=na>util</span><span class=p>.</span><span class=na>Date</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><ul><li>검색을 하다보면 알수있겠지만 <code>java.sql.Date</code> 는 JDBC등을 이용해서 데이터베이스의 데이터를 사용하는데 적합하고, <code>java.util.Date</code> 은 보다 범용적인 날짜나 시각정보를 다룰때 적합하다고 한다.</li><li>toString 메소드의 리턴 Format 형태<ul><li><code>java.sql.Date</code> : yyyy-mm-dd</li><li><code>java.util.Date</code> : EEE MMM dd HH:mm:ss zzz yyyy</li></ul></li><li>mybatis 에서 형변환은 <a href=http://www.mybatis.org/mybatis-3/ko/configuration.html#typeHandlers target=_blank rel="noopener noreffer">mybatis 3 문서</a>에 나와있는 자바타입과 JDBC타입이 일치할 경우에 해당 타입 핸들러를 기본으로 사용하게 된다.</li></ul><h3 id=정상혁-님-조언---작성하신분->정상혁 님 조언 ( <a href=http://d2.naver.com/helloworld/645609 target=_blank rel="noopener noreffer">http://d2.naver.com/helloworld/645609</a> 작성하신분 )</h3><ul><li>Oracle의 JDBC 드라이버가 예상 밖으로 동작하네요. Oracle의 DATE 타입도 문서를 보니 시분초까지 저장하게 되어 있는데, Oracle JDBC 구현체가 DATE 타입의 철학을 오해한게 아닌가하는 생각도 듭니다.</li><li>참고로 java.sql.Date, java.sql.TimeStamp는 잘못된 설계라는 비판이 많습니다.</li><li>저도 Java의 날짜와 시간 API 라는 글에서 아래와 같이 적은 적이 있습니다.</li></ul><blockquote><p>java.sql.Date 클래스는 상위 클래스인 java.util.Date 클래스와 이름이 같다. 이 클래스를 두고 Java 플랫폼 설계자는 클래스 이름을 지으면서 깜빡 존 듯하다는 조롱까지 나왔다.[24]</p></div><div class=post-footer><a href=/2017/03/23/oracle-mybatis-date/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/mybatis/>Mybatis</a>,&nbsp;<a href=/tags/date/>Date</a>,&nbsp;<a href=/tags/oracle/>Oracle</a>,&nbsp;<a href=/tags/archives-2017/>Archives-2017</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2017/03/12/spring-parameter/><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-parameter/spring-parameter-1.jpg data-srcset="/images/spring-parameter/spring-parameter-1.jpg, /images/spring-parameter/spring-parameter-1.jpg 1.5x, /images/spring-parameter/spring-parameter-1.jpg 2x" data-sizes=auto alt=/images/spring-parameter/spring-parameter-1.jpg title=/images/spring-parameter/spring-parameter-1.jpg></a></div><h1 class=single-title itemprop="name headline"><a href=/2017/03/12/spring-parameter/>스프링환경에서의 파라미터 관련 정리</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-03-12>2017-03-12</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><p>일반적인 웹 프로젝트 구성에서는 <code>Controller</code>레벨에서 응답을 받고 비지니스 로직을 처리 후에 다시 <code>View</code>레벨로 넘어가는게 통상적인 흐름이다. 이 부분에서 파라미터 관련한 여러가지 부분에 대해 정리해보고자 한다.</p><h2 id=httpservletrequestgetparameter>httpServletRequest.getParameter()</h2><p>아래소스처럼 <code>HttpServletRequest</code>의 getParameter() 메서드를 이용하여 파라미터값을 가져올 수 있다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>home</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>httpServletRequest</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>httpServletRequest</span><span class=p>.</span><span class=na>getParameter</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=s>&#34;home&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 id=requestparam>@RequestParam</h2><p>또다른 방법으로는 <code>@RequestParam</code> 어노테이션을 이용하면 간단하게 파라미터값을 가져올수 있다. 우선, 해당 어노테이션의 옵션값들에 대해 간략하게 확인하고 넘어가는게 좋을듯 싶다. <a href=https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/bind/annotation/RequestParam.html target=_blank rel="noopener noreffer">API문서 4.3.6 기준</a></p><table><thead><tr><th>이름</th><th>타입</th><th>설명</th></tr></thead><tbody><tr><td>name, value (Alias for name)</td><td>String</td><td>파라미터 이름</td></tr><tr><td>required</td><td>boolean</td><td>해당 파라미터가 반드시 필수인지 여부, 기본값은 true</td></tr><tr><td>defaultValue</td><td>String</td><td>해당 파라미터의 기본값</td></tr></tbody></table><p>위 옵션값들을 조합하여 컨트롤러 메소드에 적용해보면 아래 소스와 같이 만들어지고, 이렇게 reqeust에서 파라미터값을 가져올수 있다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>home</span><span class=p>(</span><span class=nd>@RequestParam</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>defaultValue</span><span class=o>=</span><span class=s>&#34;false&#34;</span><span class=p>)</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=s>&#34;home&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>이 어노테이션을 이용하게되면 자칫 잘못하다간 에러를 만날수가 있는데 <code>required</code>값을 true로 해놓고 (필수 파라미터 설정) 해당 파라미터를 사용하지 않고 요청을 보내게 되면 HTTP 400 에러를 받게 되니 각 옵션들을 정확히 확인하고 사용해야 할 것 같다.
물론 컨트롤러의 메소드에서 해당 어노테이션을 사용하지 않고도 아래 코드처럼 바로 받을수 있다. 이렇게 바로 받을 경우는 필수 파라미터값이 false로 설정이 되고 변수명과 동일한 파라미터만 받을수 있게 되며 기본값 설정을 할수는 없다. 방법의 차이라서 상황에 따라 맞춰 사용하면 될듯 하다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>home</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=s>&#34;home&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 id=requestbody>@RequestBody</h2><p><code>@RequestBody</code>어노테이션을 사용할 경우 반드시 POST형식으로 응답을 받는 구조여야만 한다. 이를테면 JSON 이나 XML같은 데이터를 적절한 messageConverter로 읽을때 사용하거나, POJO형태의 데이터 전체로 받을경우에 사용된다. 단, 이 어노테이션을 사용하여 파라미터를 받을 경우 별도의 추가 설정(POJO 의 get/set 이나 json/xml 등의 messageConverter 등)을 해줘야 적절하게 데이터를 받을수가 있다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@PostMapping</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>home</span><span class=p>(</span><span class=nd>@ReqeustBody</span><span class=w> </span><span class=n>Student</span><span class=w> </span><span class=n>student</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=s>&#34;home&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 id=modelattribute>@ModelAttribute</h2><p><code>@RequestParam</code>과 비슷한데 1:1로 파라미터를 받을경우는 <code>@RequestParam</code>를 사용하고, 도메인이나 오브젝트로 파라미터를 받을 경우는 <code>@ModelAttribute</code>으로 받을수 있다. 또한 이 어노테이션을 사용하면 검증(Validation)작업을 추가로 할수 있는데 예로들어 null이라던지, 각 멤버변수마다 valid옵션을 줄수가 있고 여기서 에러가 날 경우 BindException 이 발생한다.</p><h2 id=spring-command-객체>Spring command 객체</h2><p>컨트롤러에서 파라미터로 받은 정보에 대해서는 view 에서 바로 사용이 가능하다. 예로 들어 아래그림처럼 이렇게 컨트롤러가 구성되어있고</p><a class=lightgallery href=/images/spring-parameter/spring-parameter-1.jpg title=/images/spring-parameter/spring-parameter-1.jpg data-thumbnail=/images/spring-parameter/spring-parameter-1.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-parameter/spring-parameter-1.jpg data-srcset="/images/spring-parameter/spring-parameter-1.jpg, /images/spring-parameter/spring-parameter-1.jpg 1.5x, /images/spring-parameter/spring-parameter-1.jpg 2x" data-sizes=auto alt=/images/spring-parameter/spring-parameter-1.jpg></a><p>이렇게 모델이 구성되어있을때</p><a class=lightgallery href=/images/spring-parameter/spring-parameter-2.jpg title=/images/spring-parameter/spring-parameter-2.jpg data-thumbnail=/images/spring-parameter/spring-parameter-2.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-parameter/spring-parameter-2.jpg data-srcset="/images/spring-parameter/spring-parameter-2.jpg, /images/spring-parameter/spring-parameter-2.jpg 1.5x, /images/spring-parameter/spring-parameter-2.jpg 2x" data-sizes=auto alt=/images/spring-parameter/spring-parameter-2.jpg></a><p>view 에서 이런식으로 구성되어있다고 가정해보자.</p><a class=lightgallery href=/images/spring-parameter/spring-parameter-3.jpg title=/images/spring-parameter/spring-parameter-3.jpg data-thumbnail=/images/spring-parameter/spring-parameter-3.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-parameter/spring-parameter-3.jpg data-srcset="/images/spring-parameter/spring-parameter-3.jpg, /images/spring-parameter/spring-parameter-3.jpg 1.5x, /images/spring-parameter/spring-parameter-3.jpg 2x" data-sizes=auto alt=/images/spring-parameter/spring-parameter-3.jpg></a><p>이때 <code>/student?name=taetaetae&amp;age=32&amp;address=green-factory</code>로 호출을 해보면 구지 Model에 값을 셋팅해주지 않아도 다음과 같이 정보를 읽을수 있게 된다.</p><a class=lightgallery href=/images/spring-parameter/spring-parameter-4.jpg title=/images/spring-parameter/spring-parameter-4.jpg data-thumbnail=/images/spring-parameter/spring-parameter-4.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-parameter/spring-parameter-4.jpg data-srcset="/images/spring-parameter/spring-parameter-4.jpg, /images/spring-parameter/spring-parameter-4.jpg 1.5x, /images/spring-parameter/spring-parameter-4.jpg 2x" data-sizes=auto alt=/images/spring-parameter/spring-parameter-4.jpg></a><h2 id=마치며>마치며</h2><p>스프링에서 파라미터를 받는 방법은 상당히 다양하다. 이게 정답이다 정의할수 없을정도로. 상황에 따라 맞는 방법으로 파라미터를 받아야 하겠고, 각 방법에 장/단점을 최대한 살려서 좀더 깔끔한 코드를 작성할수 있어야 하겠다.</p></div><div class=post-footer><a href=/2017/03/12/spring-parameter/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/spring/>Spring</a>,&nbsp;<a href=/tags/reqeustparam/>ReqeustParam</a>,&nbsp;<a href=/tags/requestbody/>RequestBody</a>,&nbsp;<a href=/tags/modelattribute/>ModelAttribute</a>,&nbsp;<a href=/tags/spring-command-%EA%B0%9D%EC%B2%B4/>Spring Command 객체</a>,&nbsp;<a href=/tags/archives-2017/>Archives-2017</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2017/03/08/a-quarter-of-this-year/><img class=lazyload src=/svg/loading.min.svg data-src=/images/a-quarter-of-this-year/time.png data-srcset="/images/a-quarter-of-this-year/time.png, /images/a-quarter-of-this-year/time.png 1.5x, /images/a-quarter-of-this-year/time.png 2x" data-sizes=auto alt=/images/a-quarter-of-this-year/time.png title=/images/a-quarter-of-this-year/time.png></a></div><h1 class=single-title itemprop="name headline"><a href=/2017/03/08/a-quarter-of-this-year/>벌써 3월, 다시 일어서야할 때</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-03-08>2017-03-08</time></span>&nbsp;<span class=post-category>included in <a href=/categories/blog/><i class="far fa-folder fa-fw" aria-hidden=true></i>Blog</a></span></div><div class=content><p>벌써 3월이다. 뭐하나 제대로 한것도 없는데 시간은 야속하게도 멈추지 않고 지나가고 있다.
오랜만에 동기형을 만났다. 신입사원이 되기 전 연습생(?)시절 동거동락하며 개발에 대해 고군분투 하던 사이인지라. 오랜만에 만나도 서로 이야기 하고자 하는 주제는 언제나 동일하다. <code>개발자로서의 삶</code>
이런저런 이야기를 하며 다시 나를 돌아보게 되었다. 내 노력에 의해, 아니면 운이 좋아 지금 다니고있는 회사에 들어온 이후로 예전만큼의 열정은 온데간데 없으며, 그만큼 간절하지도 않고 치열하지도 않는 내 자신이 너무 미안하고 쪽팔릴정도로 한심하기 그지 없었다. 무엇때문일까, 도대체 왜 이렇게 안일해졌고 적극적이지 못하게 되었을까.
그 질문에 대한 정답은 이것이다 라고 정의를 할수는 없겠지만 확실한건, 현재 내 상황에 안주하고 타협하려하는 마음가짐이 생겼다는건 회피할수 없을정도로 나도 정말 많이 변해버린것 같다. 물론 지금 상황이 잘못되었다는건 아니지만 내 직업 특성상 끊임없이 노력하고 도전하며 배워야 하는 상황인데 지금 난 퇴근하고 집에가면 쉬고싶고 자기 바쁘고 다음날 늦잠자고&mldr; 계속된 생활패턴에 젖어 사는것 같다.
일단 독서좀 많이 해야겟다. 회사에, 집에 쌓인 책만 벌써 몇권인지&mldr; 기본이 되는 전공서적 하나 정하고 끝까지 완독해보자. 그게 자바든 스프링이든, 최신 신기술보다 기본이 탄탄해져야 하는건 백번 천번 말해도 당연하기에.</p><p>다시 정신차리자. 오늘 걷지 않으면 내일은 달려야 한다고 누군가 그랬듯..</p></div><div class=post-footer><a href=/2017/03/08/a-quarter-of-this-year/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/archives-2017/>Archives-2017</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2017/03/02/github-api/><img class=lazyload src=/svg/loading.min.svg data-src=/images/github-api/github.png data-srcset="/images/github-api/github.png, /images/github-api/github.png 1.5x, /images/github-api/github.png 2x" data-sizes=auto alt=/images/github-api/github.png title=/images/github-api/github.png></a></div><h1 class=single-title itemprop="name headline"><a href=/2017/03/02/github-api/>github api 사용방법</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-03-02>2017-03-02</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><p>github 에서는 레파지토리의 전반적인 상황에 대해 다양한 API를 제공해주고 있다. 이번에는 그 API를 사용하는 방법에 대해 알아보고자 한다.</p><h2 id=personal-access-tokens-발급>Personal access tokens 발급</h2><p>우선 정상적인 API를 사용하기 위해 <code>Personal access tokens</code>를 발급받아야 한다. github 초기화면 > 우측상단 프로필사진 클릭 > setting > Personal access tokens 에 들어가 토큰을 생성을 한다.
해당 토큰의 허용범위를 설정한뒤 생성을 하면 만들어 지는데 여기서 발급되는 문자열은 따로 보관하는게 좋다. (나중에 다시 확인하려면 새로 재 생성하는 방법말고는 없기 때문에 한번 만들때 메모해 두는게 좋다.)
아래와 같이 생성완료.
<a class=lightgallery href=/images/github-api/github_access_tokens.png title=/images/github-api/github_access_tokens.png data-thumbnail=/images/github-api/github_access_tokens.png><img class=lazyload src=/svg/loading.min.svg data-src=/images/github-api/github_access_tokens.png data-srcset="/images/github-api/github_access_tokens.png, /images/github-api/github_access_tokens.png 1.5x, /images/github-api/github_access_tokens.png 2x" data-sizes=auto alt=/images/github-api/github_access_tokens.png width=80%></a></p><h2 id=api-사용방법>API 사용방법</h2><p>권한이 없는 Repository 의 내용을 확인할수 없듯이 github에서 제공하는 API또한 권한이 있는 Repository에 대해서만 API를 제공한다. 위에서 발급한 token 을 권한 체크할때 사용하는데 다양한 방법이 있을수 있겠으나 나는 간단하게 헤더에 포함시켜서 일반 GET 호출을 하는 방식으로 하였다. 윈도우 환경에서는 헤더 셋팅하고 호출하는게 조금 어려울수 있으니 이러한 부분을 설정할수 있는 <code>Postman</code>이라는 프로그램으로 호출을 해본다.
아래처럼 url은 <code>https://api.github.com/</code>으로 설정하고 <code>Headers</code>파라미터에 <code>Authorization</code>라는 key에 value를 위에서 발급받았던 token을 이용하여 <code>token abcd~~</code>식으로 입력해준다음 <code>send</code>버튼을 눌러주면 응답을 받을수가 있는데, 아래 그림은 제공하는 api의 모든 url을 확인하는 방법이다.</p><a class=lightgallery href=/images/github-api/github_api_call_1.png title=/images/github-api/github_api_call_1.png data-thumbnail=/images/github-api/github_api_call_1.png><img class=lazyload src=/svg/loading.min.svg data-src=/images/github-api/github_api_call_1.png data-srcset="/images/github-api/github_api_call_1.png, /images/github-api/github_api_call_1.png 1.5x, /images/github-api/github_api_call_1.png 2x" data-sizes=auto alt=/images/github-api/github_api_call_1.png></a><p>아래애서는 위에서 확인된 api url을 활용하여 내가 권한이 있는 레파지토리 내에서 확인할수있는 정보에 대한 API를 호출해보았다.</p><a class=lightgallery href=/images/github-api/github_api_call_2.png title=/images/github-api/github_api_call_2.png data-thumbnail=/images/github-api/github_api_call_2.png><img class=lazyload src=/svg/loading.min.svg data-src=/images/github-api/github_api_call_2.png data-srcset="/images/github-api/github_api_call_2.png, /images/github-api/github_api_call_2.png 1.5x, /images/github-api/github_api_call_2.png 2x" data-sizes=auto alt=/images/github-api/github_api_call_2.png></a><p>API 호출시 가장 보편화되어있는(?) 스팩인 <code>JSON</code>으로 응답이 내려오기때문에 어떠한 환경에서도 충분히 활용할수 있을것이라 생각한다.
나는 개인적으로 팀 내에서 하나의 <code>Organizations</code>내에 여러 <code>Repository</code>가 있는데 각각의 <code>PullRequest</code>에 대해 코드리뷰를 해야하는 상황에서 일일히 다 찾아보기 귀찮아 github-api를 활용해 open된 <code>PullRequest</code>가 있으면 알림을 주는 걸 만들어 보았다.</p></div><div class=post-footer><a href=/2017/03/02/github-api/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/github/>Github</a>,&nbsp;<a href=/tags/archives-2017/>Archives-2017</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2017/02/28/shell-script-json/><img class=lazyload src=/svg/loading.min.svg data-src=/images/shell-script-json/jq.png data-srcset="/images/shell-script-json/jq.png, /images/shell-script-json/jq.png 1.5x, /images/shell-script-json/jq.png 2x" data-sizes=auto alt=/images/shell-script-json/jq.png title=/images/shell-script-json/jq.png></a></div><h1 class=single-title itemprop="name headline"><a href=/2017/02/28/shell-script-json/>리눅스상에서 json 파싱</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-02-28>2017-02-28</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><p>리눅스 상에서 json형태의 String 을 파싱해야하는 상황이라면 아래 라이브러리를 사용해보는것을 추천해본다.</p><h2 id=jq>jq</h2><p>사용방법은 너무너무 간단하다.</p><ul><li>자신의 시스템에 맞는 라이브러리를 다운받고</li></ul><pre tabindex=0><code>(32-bit system)
$ wget http://stedolan.github.io/jq/download/linux32/jq
(64-bit system)
$ wget http://stedolan.github.io/jq/download/linux64/jq
</code></pre><ul><li>실행 권한을 설정해 준 뒤</li></ul><pre tabindex=0><code>chmod +x ./jq
</code></pre><ul><li>root 권한으로 해당 파일을 이동시킨다.</li></ul><pre tabindex=0><code>sudo cp jq /usr/bin
</code></pre><ul><li>실행은 다음과 같이 한다.
Json String 이 아래와 같이 있다고 가정했을때</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Google&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;location&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;street&#34;</span><span class=p>:</span> <span class=s2>&#34;1600 Amphitheatre Parkway&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;city&#34;</span><span class=p>:</span> <span class=s2>&#34;Mountain View&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;state&#34;</span><span class=p>:</span> <span class=s2>&#34;California&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;country&#34;</span><span class=p>:</span> <span class=s2>&#34;US&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;employees&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Michael&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;division&#34;</span><span class=p>:</span> <span class=s2>&#34;Engineering&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Laura&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;division&#34;</span><span class=p>:</span> <span class=s2>&#34;HR&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Elise&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;division&#34;</span><span class=p>:</span> <span class=s2>&#34;Marketing&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>실제 사용과 결과는 다음과 같이 이루어 진다.</p><pre tabindex=0><code>$ cat json.txt | jq &#39;.name&#39;
&#34;Google&#34;

$ cat json.txt | jq &#39;.location.city&#39;
&#34;Mountain View&#34;

$ cat json.txt | jq &#39;.employees[0].name&#39;
&#34;Michael&#34;

$ cat json.txt | jq &#39;.location | {street, city}&#39;
{
  &#34;city&#34;: &#34;Mountain View&#34;,
  &#34;street&#34;: &#34;1600 Amphitheatre Parkway&#34;
}
</code></pre><p>보다 자세한 사용방법은 공식홈페이지( <a href=https://stedolan.github.io/jq/ target=_blank rel="noopener noreffer">https://stedolan.github.io/jq/</a> )를 참조하면 좋을듯 하다.</p></div><div class=post-footer><a href=/2017/02/28/shell-script-json/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/linux/>Linux</a>,&nbsp;<a href=/tags/json/>Json</a>,&nbsp;<a href=/tags/jq/>Jq</a>,&nbsp;<a href=/tags/archives-2017/>Archives-2017</a></div></div></article><ul class=pagination><li class=page-item><span class=page-link><a href=/>1</a></span></li><li class=page-item><span class=page-link aria-hidden=true>&mldr;</span></li><li class=page-item><span class=page-link><a href=/page/13/>13</a></span></li><li class=page-item><span class=page-link><a href=/page/14/>14</a></span></li><li class="page-item active"><span class=page-link><a href=/page/15/>15</a></span></li><li class=page-item><span class=page-link><a href=/page/16/>16</a></span></li><li class=page-item><span class=page-link><a href=/page/17/>17</a></span></li><li class=page-item><span class=page-link><a href=/page/18/>18</a></span></li></ul></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.147.9">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2016 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://taetaetae.github.io/resume target=_blank>태태태</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:500},data:{"id-1":"Software development engineer"},lightgallery:!0,typeit:{cursorChar:"|",cursorSpeed:500,data:{"id-1":["id-1"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-86432198-1",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-86432198-1" async></script></body></html>