<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.147.9"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title></title><meta name=Description content="This is my cool site"><meta property="og:url" content="https://taetaetae.github.io/"><meta property="og:site_name" content="My cool site"><meta property="og:title" content="My cool site"><meta property="og:description" content="This is my cool site"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="My cool site"><meta name=twitter:description content="This is my cool site"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><meta name=naver-site-verification content="2d1cdbb963ba178aa7cbf58500afc668cae1e645"><meta name=google-site-verification content="vvFCdv0-GuQhEWG8vtNJfA7YSY2HYQ1hpHh9P-a6Pv8"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://taetaetae.github.io/><link rel=alternate href=/index.xml type=application/rss+xml title><link rel=feed href=/index.xml type=application/rss+xml title><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","url":"https:\/\/taetaetae.github.io\/","inLanguage":"en","author":{"@type":"Person","name":"태태태"},"description":"This is my cool site","name":""}</script></head><body data-header-desktop=auto data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title>👨‍💻꿈꾸는 태태태의 공간</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title>👨‍💻꿈꾸는 태태태의 공간</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class="page home" data-home=posts><div class=home-profile><div class=home-avatar><a href=/posts/ title=Posts><img class=lazyload src=/svg/loading.min.svg data-src=/images/profile.png data-srcset="/images/profile.png, /images/profile.png 1.5x, /images/profile.png 2x" data-sizes=auto alt=/images/profile.png title=/images/profile.png></a></div><div class=home-subtitle><div id=id-1 class=typeit></div></div><div class=links><a href=https://github.com/taetaetae title=GitHub target=_blank rel="noopener noreffer me"><i class="fab fa-github fa-fw" aria-hidden=true></i></a><a href=https://linkedin.com/in/taetaetae title=LinkedIn target=_blank rel="noopener noreffer me"><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=https://www.instagram.com/_taetaetae title=Instagram target=_blank rel="noopener noreffer me"><i class="fab fa-instagram fa-fw" aria-hidden=true></i></a><a href=https://facebook.com/taetaetae0 title=facebook target=_blank rel="noopener noreffer me"><i class="fab fa-facebook fa-fw" aria-hidden=true></i></a><a href=mailto:taetaetae_@naver.com title=Email rel=me><i class="far fa-envelope fa-fw" aria-hidden=true></i></a><a href=/index.xml title=RSS target=_blank rel="noopener noreffer me"><i class="fas fa-rss fa-fw" aria-hidden=true></i></a></div></div><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2020/03/08/spring-rest-docs-in-spring-boot/><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-rest-docs-in-spring-boot/logo.jpg data-srcset="/images/spring-rest-docs-in-spring-boot/logo.jpg, /images/spring-rest-docs-in-spring-boot/logo.jpg 1.5x, /images/spring-rest-docs-in-spring-boot/logo.jpg 2x" data-sizes=auto alt=/images/spring-rest-docs-in-spring-boot/logo.jpg title=/images/spring-rest-docs-in-spring-boot/logo.jpg></a></div><h1 class=single-title itemprop="name headline"><a href=/2020/03/08/spring-rest-docs-in-spring-boot/>SpringRestDocs를 SpringBoot에 적용하기</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2020-03-08>2020-03-08</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><p>API를 개발하고 제공하기 위해서는 그에 해당하는 API 명세를 작성해서 사용하는 곳에 전달하게 된다. 어떤 URL에 어떤 파라미터를 사용해서 어떻게 요청을 하면 어떤 결과를 응답으로 내려주는지에 대한 관련 정보들. 이러한 &ldquo;API 문서&rdquo; 를 제공하는 방식은 상황에 따라 다양한 방법으로 사용되곤 한다.</p><figure><a class=lightgallery href=/images/spring-rest-docs-in-spring-boot/api-document.jpg title=/images/spring-rest-docs-in-spring-boot/api-document.jpg data-thumbnail=/images/spring-rest-docs-in-spring-boot/api-document.jpg data-sub-html="<h2>API 코드와 해당 문서의 동기화가 자동으로 되어야 조금 편해질것 같다는 생각이 들었다. 출처 : https://dribbble.com/shots/3386291-API-Documentation</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-rest-docs-in-spring-boot/api-document.jpg data-srcset="/images/spring-rest-docs-in-spring-boot/api-document.jpg, /images/spring-rest-docs-in-spring-boot/api-document.jpg 1.5x, /images/spring-rest-docs-in-spring-boot/api-document.jpg 2x" data-sizes=auto alt=/images/spring-rest-docs-in-spring-boot/api-document.jpg width=50%></a><figcaption class=image-caption>API 코드와 해당 문서의 동기화가 자동으로 되어야 조금 편해질것 같다는 생각이 들었다.<br>출처 : <a href=https://dribbble.com/shots/3386291-API-Documentation target=_blank rel="noopener noreffer">https://dribbble.com/shots/3386291-API-Documentation</a></figcaption></figure><p>필자는 주로 &ldquo;위키&rdquo;(또는 일반 문서)를 활용해서 전달하곤 했었는데 API의 형태가 달라질 때마다 해당 위키를 수정해야만 하는 번거로움이 있었다. API 수정하면 위키도 수정하고. 깜박하고 위키 수정을 안하게 될 경우 왜 API 명세가 다르냐는 문의가&mldr; 그러다 알게된 Spring Rest Docs. (아무리 좋은 기술, 좋은 툴 이라 해도 실제로 본인이 필요로 하고 사용을 해야하는 이유가 생길때 비로소 빛을 발하는것 같은 느낌이다.)</p><blockquote><p>이 포스팅에서는 swegger 와 비교하는 내용은 제외할까 한다. 워낙 유명한 두 양대 산맥(?)이라 검색해보면 각각의 장단점이 자세히 나와있기에&mldr;</p></blockquote><p>최근 들어 TestCode 의 중요성을 절실하게 느끼고 있었고, TestCode 를 작성하면 자연스럽게 문서를 만들어 주는 부분이 가장 매력적이라고 생각이 들었다. 이를 반대로 생각하면, TestCode 가 실패할 경우 빌드 자체가 안되기에 어쩔수 없이 TestCode를 성공시켜야만 하고, 자연스럽게 정상적인(최신화 된) API 문서가 만들어지게 된다.</p><p>이번 포스팅에서는 다음과 같은 목표를 두고 실무에서 언제든지 활용이 가능한 약간의 &ldquo;가이드&rdquo; 같은 내용으로 작성해 보고자 한다.</p><ul><li>Spring Boot 최신 버전에서 Spring Rest Docs 를 설정한다.</li><li>임의의 API 를 만들고 그에 따른 TestCase 를 작성한다.</li><li>Spring.profile 에 따라 Spring Rest Docs Url 을 접근 가능/불가능 할 수 있게 한다.</li></ul><p>물론 필자의 방법이 다를수도 있지만, 이러한 방법을 토대로 보다 더 우아하고 아름다운 방법을 알아갈수 있지 않을까 하는 기대로.</p><h2 id=spring-boot-에-spring-rest-docs-셋팅하고-testcase-작성하기>Spring Boot 에 Spring Rest Docs 셋팅하고 TestCase 작성하기</h2><p>우선 Spring Boot 프로젝트를 만든다. <a href=https://start.spring.io/ target=_blank rel="noopener noreffer">https://start.spring.io/</a> 에서 만들어도 되고 IDE 에서 제공하는 툴로 만들어도 되고. 만드는 방식은 무방하다. 그 다음 필요한 dependency 를 추가해 준다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;groupId&gt;</span>org.springframework.restdocs<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;artifactId&gt;</span>spring-restdocs-mockmvc<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;scope&gt;</span>test<span class=nt>&lt;/scope&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>임의로 API를 작성하고</p><ul><li>모델</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Getter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Book</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>title</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>author</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><ul><li>컨트롤러</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RestController</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>BookController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/book/{id}&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>Book</span><span class=w> </span><span class=nf>getABook</span><span class=p>(</span><span class=nd>@PathVariable</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>Book</span><span class=w> </span><span class=n>book</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Book</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>book</span><span class=p>.</span><span class=na>setId</span><span class=p>(</span><span class=n>id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>book</span><span class=p>.</span><span class=na>setTitle</span><span class=p>(</span><span class=s>&#34;spring rest docs in spring boot&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>book</span><span class=p>.</span><span class=na>setAuthor</span><span class=p>(</span><span class=s>&#34;taetaetae&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=n>book</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>해당 컨트롤러에 대한 TestCase 를 작성하자.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@WebMvcTest</span><span class=p>(</span><span class=n>BookController</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@AutoConfigureRestDocs</span><span class=w> </span><span class=c1>// (1)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>BookControllerTest</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>MockMvc</span><span class=w> </span><span class=n>mockMvc</span><span class=p>;</span><span class=w> </span><span class=c1>// (2)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>test_책을_조회하면_null이_아닌_객체를_리턴한다</span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>mockMvc</span><span class=p>.</span><span class=na>perform</span><span class=p>(</span><span class=n>get</span><span class=p>(</span><span class=s>&#34;/book/{id}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>accept</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>APPLICATION_JSON</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>andDo</span><span class=p>(</span><span class=n>MockMvcResultHandlers</span><span class=p>.</span><span class=na>print</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>andExpect</span><span class=p>(</span><span class=n>MockMvcResultMatchers</span><span class=p>.</span><span class=na>status</span><span class=p>().</span><span class=na>isOk</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>andDo</span><span class=p>(</span><span class=n>document</span><span class=p>(</span><span class=s>&#34;book&#34;</span><span class=p>,</span><span class=w> </span><span class=c1>// (3)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=n>pathParameters</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>					</span><span class=n>parameterWithName</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>).</span><span class=na>description</span><span class=p>(</span><span class=s>&#34;book unique id&#34;</span><span class=p>)</span><span class=w> </span><span class=c1>// (4)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=n>responseFields</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>					</span><span class=n>fieldWithPath</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>).</span><span class=na>description</span><span class=p>(</span><span class=s>&#34;book unique id&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>					</span><span class=n>fieldWithPath</span><span class=p>(</span><span class=s>&#34;title&#34;</span><span class=p>).</span><span class=na>description</span><span class=p>(</span><span class=s>&#34;title&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>					</span><span class=n>fieldWithPath</span><span class=p>(</span><span class=s>&#34;author&#34;</span><span class=p>).</span><span class=na>description</span><span class=p>(</span><span class=s>&#34;author&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>andExpect</span><span class=p>(</span><span class=n>jsonPath</span><span class=p>(</span><span class=s>&#34;$.id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>is</span><span class=p>(</span><span class=n>notNullValue</span><span class=p>())))</span><span class=w> </span><span class=c1>// (5)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>andExpect</span><span class=p>(</span><span class=n>jsonPath</span><span class=p>(</span><span class=s>&#34;$.title&#34;</span><span class=p>,</span><span class=w> </span><span class=n>is</span><span class=p>(</span><span class=n>notNullValue</span><span class=p>())))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>andExpect</span><span class=p>(</span><span class=n>jsonPath</span><span class=p>(</span><span class=s>&#34;$.author&#34;</span><span class=p>,</span><span class=w> </span><span class=n>is</span><span class=p>(</span><span class=n>notNullValue</span><span class=p>())));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>(1) Spring Boot 에서는 해당 어노테이션으로 여러줄에 걸쳐 설정해야 할 Spring Rest Docs 관련 설정을 아주 간단하게 해결할 수 있게 된다. (<a href=https://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/#boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs target=_blank rel="noopener noreffer">참고</a>)</p><p>(2) <a href=https://docs.spring.io/spring-restdocs/docs/2.0.4.RELEASE/reference/html5/#getting-started-sample-applications target=_blank rel="noopener noreffer">공식 도큐먼트</a> 에서는 4가지 방식을 말하고 있는데 이 포스팅 에서는 &ldquo;MockMvc&rdquo; 을 사용하고자 한다.</p><p>(3) &ldquo;book&rdquo; 이라는 identifier 를 지정하면 해당 TestCase 가 수행될때 snippets 가 생성되는데 해당 identifier 묶음으로 생성이 된다.</p></div><div class=post-footer><a href=/2020/03/08/spring-rest-docs-in-spring-boot/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/spring-boot/>Spring Boot</a>,&nbsp;<a href=/tags/spring-rest-docs/>Spring Rest Docs</a>,&nbsp;<a href=/tags/archives-2020/>Archives-2020</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2020/02/09/jupyter-install/><img class=lazyload src=/svg/loading.min.svg data-src=/images/jupyter-install/jupyter_logo.jpg data-srcset="/images/jupyter-install/jupyter_logo.jpg, /images/jupyter-install/jupyter_logo.jpg 1.5x, /images/jupyter-install/jupyter_logo.jpg 2x" data-sizes=auto alt=/images/jupyter-install/jupyter_logo.jpg title=/images/jupyter-install/jupyter_logo.jpg></a></div><h1 class=single-title itemprop="name headline"><a href=/2020/02/09/jupyter-install/>Jupyter 설치하고 원격접속까지 (for 파.알.못)</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2020-02-09>2020-02-09</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><p>파이썬이라는 언어는 다른 프로그래밍 언어들에 비해 쉽고 직관적이라 그런지 프로그래밍을 처음 시작하는 사람들에게 더욱이 주목을 받고 있는것 같다. 정말 다양한 모듈들이 많아 여러분야에서 활용되고 있고 특히 언제부터인가 핫! 해진 분야(?)라 해도 과언이 아닐정도인 &ldquo;머신러닝&rdquo; 분야에서도 다양하게 사용되고 있는것 같다.</p><p>마침 필자가 속해 있는 팀 내에 머신러닝 스터디가 시작이 되었고, 그에 파이썬을 이용하여 스터디를 해야하는 상황. 하지만 스터디를 하는 팀원 절반 이상이 파이썬을 이용한 개발 경험이 없었고, 서로 배운것을 공유를 하면서 스터디를 하면 더 좋겠다는 생각이 들때 즈음. 언제 어디선가 봤던것이 머릿속을 스쳐 지나간다. 그건 바로 Jupyter(이하 주피터).</p><figure><a class=lightgallery href=/images/jupyter-install/jupyter_logo.jpg title=/images/jupyter-install/jupyter_logo.jpg data-thumbnail=/images/jupyter-install/jupyter_logo.jpg data-sub-html="<h2>출처 : https://jupyter.org/</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/jupyter-install/jupyter_logo.jpg data-srcset="/images/jupyter-install/jupyter_logo.jpg, /images/jupyter-install/jupyter_logo.jpg 1.5x, /images/jupyter-install/jupyter_logo.jpg 2x" data-sizes=auto alt=/images/jupyter-install/jupyter_logo.jpg width=80%></a><figcaption class=image-caption>출처 : <a href=https://jupyter.org/ target=_blank rel="noopener noreffer">https://jupyter.org/</a></figcaption></figure><p><a href=https://jupyter.org/ target=_blank rel="noopener noreffer">주피터</a>는 수십 개의 프로그래밍 언어에서 대화 형 컴퓨팅을위한 오픈 소스 소프트웨어, 오픈 표준 및 서비스를 개발하기 위한 툴이라고 한다. 이 포스트를 작성하기 전까지만 해도 &ldquo;주피터 == 파이썬 웹 개발툴&rdquo; 이라고만 알고있었는데 좀더 찾아보니 <a href=https://github.com/jupyter/jupyter/wiki/Jupyter-kernels target=_blank rel="noopener noreffer">다양한 언어를 지원</a>하는것 같다.</p><p>그럼 이러한 주피터를 특정 서버에 설치하고 로컬에 파이썬을 설치하지 않아도 원격으로 파이썬 코딩을 해보면 좀더 스터디에 도움이 되지 않을까 하는 마음이 들었다. 또한 학교에서 운동장에 잔디를 깔아서 맘껏 뛰놀수 있게 하는 느낌으로 팀원들을 위해 설치를 해두고 원격으로 접속할 수 있게 해두면 모두가 편하고 쉽게 파이썬에 대해 경험을 해볼 수 있지 않을까 하는 마음으로 주피터를 설치를 해 보고자 한다.</p><p>본 포스팅의 목표는 다음과 같다.</p><ul><li>환경 : CentOS 7.4 64Bit, python 2.7 (기본)</li><li>목표<ul><li>anaconda 를 활용하여 시스템 기본 파이썬을 건드리지 않는 가상환경을 구축한다.</li><li>주피터를 설치하고 원격으로 접속할 수 있도록 설정한다.</li></ul></li></ul><p>여기까지 보면 필자가 엄청나게 파이썬에 대해 잘 아는것처럼 보일수도 있어 미리 말하지만 필자는 찐 자바 개발자이면서 파이썬 개발 수준은 기본적인 스크립트를 작성하는 정도이다. 그러니 이 포스트를 읽고 있는 필자같은 파알못(?) 분들도 충분히 설치가 가능하다. (최대한 따라할수 있을 정도의 치트키 수준으로 작성 하고자 한다.)</p><h2 id=아나콘다-설치-덤으로-설치되는-주피터>아나콘다 설치 (덤으로 설치되는 주피터)</h2><p>우선 아나콘다를 설치하자. 아나콘다는 Anaconda(이전: Continuum Analytics)라는 곳에서 만든 파이썬 배포판으로, 수백 개의 파이썬 패키지를 포함하고 있다고 한다. 즉, 아나콘다를 설치하고 만들어진 가상환경에서 파이썬 개발을 하면 다양한 모듈이 이미 설치되어 있기 때문에 편리하다는 이야기.</p><figure><a class=lightgallery href=/images/jupyter-install/ananconda.jpg title=/images/jupyter-install/ananconda.jpg data-thumbnail=/images/jupyter-install/ananconda.jpg data-sub-html="<h2>출처 : https://www.anaconda.com/</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/jupyter-install/ananconda.jpg data-srcset="/images/jupyter-install/ananconda.jpg, /images/jupyter-install/ananconda.jpg 1.5x, /images/jupyter-install/ananconda.jpg 2x" data-sizes=auto alt=/images/jupyter-install/ananconda.jpg width=40%></a><figcaption class=image-caption>출처 : <a href=https://www.anaconda.com/ target=_blank rel="noopener noreffer">https://www.anaconda.com/</a></figcaption></figure><p>더불어 시스템에 기본으로 설치되어 있는 파이썬을 건드리면 여러 복잡한 문제가 발생할 수 있기에. 아나콘다를 활용하여 파이썬 3을 사용하는 가상환경을 만들어 보자.
설치는 아주 간단하다. 아나콘다 설치파일을 다운받고 이를 실행하면 끝.
(user 레벨이 root 면 sudo 명령어를 생략해도 된다.)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ wget https://repo.anaconda.com/archive/Anaconda3-2019.10-Linux-x86_64.sh
</span></span><span class=line><span class=cl>$ sudo bash Anaconda3-2019.10-Linux-x86_64.sh
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Welcome to Anaconda3 2019.10
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>In order to <span class=k>continue</span> the installation process, please review the license
</span></span><span class=line><span class=cl>agreement.
</span></span><span class=line><span class=cl>Please, press ENTER to <span class=k>continue</span>
</span></span><span class=line><span class=cl>&gt;&gt;&gt;
</span></span><span class=line><span class=cl><span class=o>===================================</span>
</span></span><span class=line><span class=cl>Anaconda End User License <span class=nv>Agreement</span>
</span></span><span class=line><span class=cl><span class=o>===================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Copyright 2015, Anaconda, Inc.
</span></span><span class=line><span class=cl>~~~ 중략 ~~~
</span></span><span class=line><span class=cl>Do you accept the license terms? <span class=o>[</span>yes<span class=p>|</span>no<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>no<span class=o>]</span> &gt;&gt;&gt; yes <span class=c1># yes!!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Anaconda3 will now be installed into this location:
</span></span><span class=line><span class=cl>/root/anaconda3
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  - Press ENTER to confirm the location
</span></span><span class=line><span class=cl>  - Press CTRL-C to abort the installation
</span></span><span class=line><span class=cl>  - Or specify a different location below
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>/root/anaconda3<span class=o>]</span> &gt;&gt;&gt; /home/anaconda3 <span class=c1># 설치될 경로를 설정해주고 기본 설정값에 설치하려면 그냥 엔터</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>~~~뭐가 엄청 설치된다. 물 한잔 먹고 오자.~~~
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>installation finished.
</span></span><span class=line><span class=cl>Do you wish the installer to initialize Anaconda3
</span></span><span class=line><span class=cl>by running conda init? <span class=o>[</span>yes<span class=p>|</span>no<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>no<span class=o>]</span> &gt;&gt;&gt; yes <span class=c1># yes!!</span>
</span></span></code></pre></div><p>이렇게 되면 설치는 끝. 환경변수를 설정해서 기본 파이썬 환경을 아나콘다에 의해 설정되도록 맞춰주자.</p></div><div class=post-footer><a href=/2020/02/09/jupyter-install/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/python/>Python</a>,&nbsp;<a href=/tags/jupyter/>Jupyter</a>,&nbsp;<a href=/tags/archives-2020/>Archives-2020</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2020/01/19/spring-boot-maven-multi-module/><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-boot-maven-multi-module/multimodule.png data-srcset="/images/spring-boot-maven-multi-module/multimodule.png, /images/spring-boot-maven-multi-module/multimodule.png 1.5x, /images/spring-boot-maven-multi-module/multimodule.png 2x" data-sizes=auto alt=/images/spring-boot-maven-multi-module/multimodule.png title=/images/spring-boot-maven-multi-module/multimodule.png></a></div><h1 class=single-title itemprop="name headline"><a href=/2020/01/19/spring-boot-maven-multi-module/>스프링 부트로 멀티모듈 셋팅하기</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2020-01-19>2020-01-19</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><p>서비스를 처음 만들기 시작할때면 각 직군별로 생각하는 포인트가 다양하다. 설계, 기획, 디자인, 개발. 여기서 개발은 프로젝트 셋팅을 어떻게 해야하지? 하는 고민을 하기 마련이다. 아주 간단하게 하나의 모듈로 모든 기능을 담당하도록 만들 수 있지만 기능별로 모듈을 나눠서 셋팅하는게 관리측면에서 장점이라 생각한다.</p><p>예를 들어보자. 도서관의 들어온 책 정보를 외부에 제공하는 &ldquo;API&rdquo;, 주기적으로 책 정보를 업데이트 하는 &ldquo;Batch&rdquo;. 이렇게 크게 두가지의 모듈이 있어야 한다고 가정했을때 어떤식으로 모듈을 설계할 수 있을까?</p><p>이번 포스팅에서는 스프링 부트와 메이븐을 활용해서 하나의 프로젝트(컴포넌트)에서 여러 모듈을 관리할 수 있는 <a href=https://spring.io/guides/gs/multi-module/ target=_blank rel="noopener noreffer">Spring Multi Module</a>을 셋팅하는 방법에 대해 알아보고자 한다. 필자도 셋팅하기 전에는 &ldquo;그냥 하면 되는거 아니야?&ldquo;라며 우습게 보다 아주 사소한 부분들에서 엄청난 삽질을 해서 그런지 꼭 포스팅으로 남겨놔야 겠다고 다짐했고 이렇게 정리를 할 수 있게 되어서 다행이라 생각한다.</p><figure><a class=lightgallery href=/images/spring-boot-maven-multi-module/team_structure.png title=/images/spring-boot-maven-multi-module/team_structure.png data-thumbnail=/images/spring-boot-maven-multi-module/team_structure.png data-sub-html="<h2>어쩌면 우리가 있는 팀도 멀티모듈이 아닐까? 출처 : https://bcho.tistory.com/813</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-boot-maven-multi-module/team_structure.png data-srcset="/images/spring-boot-maven-multi-module/team_structure.png, /images/spring-boot-maven-multi-module/team_structure.png 1.5x, /images/spring-boot-maven-multi-module/team_structure.png 2x" data-sizes=auto alt=/images/spring-boot-maven-multi-module/team_structure.png width=80%></a><figcaption class=image-caption>어쩌면 우리가 있는 팀도 멀티모듈이 아닐까?<br>출처 : <a href=https://bcho.tistory.com/813 target=_blank rel="noopener noreffer">https://bcho.tistory.com/813</a></figcaption></figure><h2 id=왜-멀티모듈로-셋팅할까>왜 멀티모듈로 셋팅할까?</h2><p>위에서 예시로 이야기 한것처럼 현재 우리가 셋팅해야할 모듈은 크게 두가지 이다.</p><ul><li>API : 외부에 도서관에 들어온 책 정보를 알려주는 모듈</li><li>Batch : 주기적으로 도서관의 책 정보를 갱신하는 모듈</li></ul><p>한번 생각을 해보자. 위에서 말한 모듈들 중에 동시에 사용할것만 같은 정보가 있다. &ldquo;책 정보&rdquo;. 각 모듈마다 &ldquo;책 정보"를 가져오는 로직을 작성하는것 보다 한곳에서 해당로직을 구현하고 이를 여러곳에서 사용하는게 사용하는게 중복코드를 방지할수 있는 방법이란건 쉽게 알아차릴수 있다. 그렇다면 어떻게 모듈을 분리할수 있을까?</p><p>필자의 경험으로 미루어 볼때 크게 두가지 방법이 있는것 같다.</p><ul><li>공통으로 사용하는 모듈을 jar로 만들고 이를 메이븐 원격 저장소에 deploy, 사용하는 모듈에서 디펜던시에 추가하여 사용</li><li>멀티모듈로 구성하고 사용하는 모듈에서 디펜던시에 추가하여 사용</li></ul><p>첫번째 방법의 가장 큰 단점은, 공통으로 사용하는 모듈이 변경될때마다 버전을 바꿔주고 (안바꿔도 되지만 사용하는 모듈에서 캐시 갱신을 해야하는 불편함이 생긴다.) 메이븐 원격 저장소에 deploy를 해줘야 한다. 그에 반해 두번째 방법은 이런과정없이 함께 빌드만 해주면 끝나고 IDE에서 개발시 한 모듈에서 동시에 수정과 사용이 가능하기 때문에 훨씬 편리하다.</p><p><a href=https://johngrib.github.io/wiki/No-Silver-Bullet/ target=_blank rel="noopener noreffer">은총알은 없다</a> 라는 말처럼, 정답은 없다. 하지만 이런저런 방법들을 미리 알아두면 적시적소에 사용할 수 있는. 필자가 다른글들에서도 언급을 자주하던 &ldquo;나만의 무기"가 되지 않을까?</p><h2 id=멀티모듈-셋팅하기>멀티모듈 셋팅하기</h2><p>위에서 이야기 했던 &ldquo;API&rdquo;, &ldquo;Batch"와는 별도로 공통으로 사용하는 모듈인 &ldquo;Core&rdquo; 이렇게 총 3개의 모듈을 만들예정이다.</p><blockquote><p>다른 이야기지만, 공통으로 사용할 것 &ldquo;같아서&rdquo; 미리 공통로직을 작성하는 습관은 좋지 않는것 같다. 그러다보면 쓸데없이 공통로직이 무거워지므로 실제로 사용하면서 중복코드가 발생할때 그때 공통로직으로 리펙토링 해도 늦지 않는것 같다. (꼰데인가&mldr;)</p></blockquote><p>구현하는 환경은 다음과 같다.</p><ul><li>Spring Boot 2.2.3</li><li>Maven</li><li>IntelliJ</li></ul><p>우선 IDE의 힘을 빌려 하나의 스프링 부트 프로젝트를 생성해본다.</p><figure><a class=lightgallery href=/images/spring-boot-maven-multi-module/spring_boot_init.jpg title=/images/spring-boot-maven-multi-module/spring_boot_init.jpg data-thumbnail=/images/spring-boot-maven-multi-module/spring_boot_init.jpg data-sub-html="<h2>다음 > 다음 > 다음</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-boot-maven-multi-module/spring_boot_init.jpg data-srcset="/images/spring-boot-maven-multi-module/spring_boot_init.jpg, /images/spring-boot-maven-multi-module/spring_boot_init.jpg 1.5x, /images/spring-boot-maven-multi-module/spring_boot_init.jpg 2x" data-sizes=auto alt=/images/spring-boot-maven-multi-module/spring_boot_init.jpg width=80%></a><figcaption class=image-caption>다음 > 다음 > 다음</figcaption></figure><p>그 다음 만든 프로젝트에서 우클릭 후 새로운 모듈을 선택. Maven 모듈을 선택하고 적당한 이름을 적어준다.<figure><a class=lightgallery href=/images/spring-boot-maven-multi-module/new_module.jpg title=/images/spring-boot-maven-multi-module/new_module.jpg data-thumbnail=/images/spring-boot-maven-multi-module/new_module.jpg data-sub-html="<h2>다음 > 다음 > 다음 222</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-boot-maven-multi-module/new_module.jpg data-srcset="/images/spring-boot-maven-multi-module/new_module.jpg, /images/spring-boot-maven-multi-module/new_module.jpg 1.5x, /images/spring-boot-maven-multi-module/new_module.jpg 2x" data-sizes=auto alt=/images/spring-boot-maven-multi-module/new_module.jpg width=80%></a><figcaption class=image-caption>다음 > 다음 > 다음 222</figcaption></figure></p><p>&ldquo;API&rdquo;, &ldquo;Batch&rdquo;, &ldquo;Core&rdquo; 라는 모듈을 추가하고 실제 모듈이 되는 &ldquo;API&rdquo;, &ldquo;Batch"에 <code>parent</code> 와 <code>dependencies</code> 을 설정해주자. 그렇게 하고 각 Pom.xml을 보면 아래와 같다. (&ldquo;API&rdquo; 모듈에 대해서만 집중적으로 이야기 하려 한다. &ldquo;Batch&rdquo; 모듈도 동일한 형식으로 작성하기 때문.)</p><ul><li>최 상위 Pom.xml (library)
modules 하위에 멀티모듈로 설정한 모듈들의 이름이 들어가 있는것을 확인할 수 있다.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;project</span> <span class=na>xmlns=</span><span class=s>&#34;http://maven.apache.org/POM/4.0.0&#34;</span> <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl>		 <span class=na>xsi:schemaLocation=</span><span class=s>&#34;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;modelVersion&gt;</span>4.0.0<span class=nt>&lt;/modelVersion&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;packaging&gt;</span>pom<span class=nt>&lt;/packaging&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;modules&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;module&gt;</span>api<span class=nt>&lt;/module&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;module&gt;</span>core<span class=nt>&lt;/module&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;module&gt;</span>batch<span class=nt>&lt;/module&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/modules&gt;</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=nt>&lt;parent&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;groupId&gt;</span>org.springframework.boot<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;artifactId&gt;</span>spring-boot-starter-parent<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;version&gt;</span>2.2.3.RELEASE<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;relativePath/&gt;</span> <span class=c>&lt;!-- lookup parent from repository --&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/parent&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;groupId&gt;</span>com.taetaetae<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;artifactId&gt;</span>library<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;version&gt;</span>0.0.1-SNAPSHOT<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;name&gt;</span>library<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;description&gt;</span>Demo project for Spring Boot<span class=nt>&lt;/description&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;properties&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;java.version&gt;</span>1.8<span class=nt>&lt;/java.version&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/properties&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;dependencies&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;groupId&gt;</span>org.springframework.boot<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;artifactId&gt;</span>spring-boot-starter-web<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;groupId&gt;</span>org.springframework.boot<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;artifactId&gt;</span>spring-boot-starter-test<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;scope&gt;</span>test<span class=nt>&lt;/scope&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;exclusions&gt;</span>
</span></span><span class=line><span class=cl>				<span class=nt>&lt;exclusion&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;groupId&gt;</span>org.junit.vintage<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;artifactId&gt;</span>junit-vintage-engine<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>				<span class=nt>&lt;/exclusion&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;/exclusions&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/dependencies&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/project&gt;</span>
</span></span></code></pre></div><ul><li>API Pom.xml
parent 부분이 설정되어 있는 모습을 볼수 있고, core 모듈을 사용하기 위해 dependency 에 추가를 해준다.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;project</span> <span class=na>xmlns=</span><span class=s>&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
</span></span><span class=line><span class=cl>		 <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl>		 <span class=na>xsi:schemaLocation=</span><span class=s>&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;parent&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;artifactId&gt;</span>library<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;groupId&gt;</span>com.taetaetae<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;version&gt;</span>0.0.1-SNAPSHOT<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/parent&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;modelVersion&gt;</span>4.0.0<span class=nt>&lt;/modelVersion&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;packaging&gt;</span>jar<span class=nt>&lt;/packaging&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;artifactId&gt;</span>api<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;dependencies&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;groupId&gt;</span>com.taetaetae<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;artifactId&gt;</span>core<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;version&gt;</span>0.0.1-SNAPSHOT<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/dependencies&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;build&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;finalName&gt;</span>library-api<span class=nt>&lt;/finalName&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;plugins&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;plugin&gt;</span>
</span></span><span class=line><span class=cl>				<span class=nt>&lt;groupId&gt;</span>org.springframework.boot<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>				<span class=nt>&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;/plugin&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;/plugins&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/build&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/project&gt;</span>
</span></span></code></pre></div><ul><li>Core Pom.xml
Core 모듈은 &ldquo;jar"로 패키징 되어 다른 곳에서 사용되어야 하기 때문에 packaging 만 설정해준다.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;project</span> <span class=na>xmlns=</span><span class=s>&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
</span></span><span class=line><span class=cl>		 <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl>		 <span class=na>xsi:schemaLocation=</span><span class=s>&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;parent&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;artifactId&gt;</span>library<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;groupId&gt;</span>com.taetaetae<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;version&gt;</span>0.0.1-SNAPSHOT<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/parent&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;modelVersion&gt;</span>4.0.0<span class=nt>&lt;/modelVersion&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;packaging&gt;</span>jar<span class=nt>&lt;/packaging&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;artifactId&gt;</span>core<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;version&gt;</span>0.0.1-SNAPSHOT<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/project&gt;</span>
</span></span></code></pre></div><p>이렇게 하고서 Core 모듈에 공통으로 사용될 로직을 작성하고, API 모듈에서 이를 사용하는 로직을 작성한뒤, 빌드를 해보면 에러 없이 정상 작동을 하는 모습을 볼 수 있다.</p></div><div class=post-footer><a href=/2020/01/19/spring-boot-maven-multi-module/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/spring-boot/>Spring Boot</a>,&nbsp;<a href=/tags/module/>Module</a>,&nbsp;<a href=/tags/structure/>Structure</a>,&nbsp;<a href=/tags/maven/>Maven</a>,&nbsp;<a href=/tags/archives-2020/>Archives-2020</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2019/12/29/review-2019/><img class=lazyload src=/svg/loading.min.svg data-src=/images/review-2019/think.jpg data-srcset="/images/review-2019/think.jpg, /images/review-2019/think.jpg 1.5x, /images/review-2019/think.jpg 2x" data-sizes=auto alt=/images/review-2019/think.jpg title=/images/review-2019/think.jpg></a></div><h1 class=single-title itemprop="name headline"><a href=/2019/12/29/review-2019/>조금은 무거운 2019 회고</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2019-12-29>2019-12-29</time></span>&nbsp;<span class=post-category>included in <a href=/categories/review/><i class="far fa-folder fa-fw" aria-hidden=true></i>Review</a></span></div><div class=content><p>&ldquo;회고"는 비단 개발 블로그 뿐만 아니라 어떠한 과정의 마지막에는 꼭 해야할 중요한 시간인 것 같다. 앞만보고 달려가자! 닥공! 라는 말이 있지만 사실 이 말이 성립되기 위해선 지난 과거에 대한 정리와 반성 그리고 무엇을 하려고 했는데 어떤 이유로 못했는지와 그 동안의 나 자신을 바라볼 수 있는 이 &ldquo;회고&rdquo; 시간이 필요하다. 벌써 2019년도 마무리가 되어간다. 작년보다 더 정신없이 달려온 올해. 내년엔 올해보다 더 멋지고 힘차게 출발하기 위해 필자의 한 해를 돌아보고자 한다.</p><p>그렇다면 회고는 어떻게 하는게 가장 좋을까? 무작정 타임라인 기반으로 1월엔 뭐했고 2월엔 뭐했고&mldr; 이 방법이 틀린건 아니지만 타임라인 기반으로 정리를 한 뒤 키워드별로 다시 정리하는 방식이 가장 맞을것 같다는 생각이다. 무엇을 했고, 뭐가 좋았고 어떤건 아쉬웠고. 그래서 내년엔 어떻게 할 것이고. 각자의 회고 방식에는 차이가 있겠지만 회고를 하는 이유, 그리고 회고라는 목표 중에 공통점은 &ldquo;뒤를 돌아보고, 앞을 보기위한 힘을 찾는것&rdquo; 이 아닐까 싶다.</p><figure><a class=lightgallery href=/images/review-2019/back_no_hae.png title=/images/review-2019/back_no_hae.png data-thumbnail=/images/review-2019/back_no_hae.png data-sub-html="<h2>내년 회고를 할때는 흑백이 아닌 컬러 사진을 넣을 수 있는 분위기가 될까?&mldr; 출처 : http://www.nanum.com/site/poet_walk/820914</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/review-2019/back_no_hae.png data-srcset="/images/review-2019/back_no_hae.png, /images/review-2019/back_no_hae.png 1.5x, /images/review-2019/back_no_hae.png 2x" data-sizes=auto alt=/images/review-2019/back_no_hae.png width=80%></a><figcaption class=image-caption>내년 회고를 할때는 흑백이 아닌 컬러 사진을 넣을 수 있는 분위기가 될까?&mldr;<br>출처 : <a href=http://www.nanum.com/site/poet_walk/820914 target=_blank rel="noopener noreffer">http://www.nanum.com/site/poet_walk/820914</a></figcaption></figure><h2 id=회사는-성장의-공간이-아닌것을-깨닳는-순간>회사는 성장의 공간이 아닌것을 깨닳는 순간.</h2><p>(이야기에 앞서 필자는 현재 서비스 개발자임을 밝힌다.)</p><p>내년이 되면 컴퓨터쟁이가 된지 벌써 8년차. 매년 성장의 그래프를 그려보면 작년까지만 해도 우상향이었다. (그래프의 기울기는 매년 달랐지만) 허나 올해는 기울기가 0 이거나 오히려 마이너스가 된 것 같은 느낌이다. 왜일까.</p><figure><a class=lightgallery href=/images/review-2019/height.jpg title=/images/review-2019/height.jpg data-thumbnail=/images/review-2019/height.jpg data-sub-html="<h2>키는 왜 더이상 성장을 안할까? (쓰읍&mldr;) 출처 : http://www.guro1318.or.kr/bbs/board.php?bo_table=data&wr_id=1723</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/review-2019/height.jpg data-srcset="/images/review-2019/height.jpg, /images/review-2019/height.jpg 1.5x, /images/review-2019/height.jpg 2x" data-sizes=auto alt=/images/review-2019/height.jpg width=80%></a><figcaption class=image-caption>키는 왜 더이상 성장을 안할까? (쓰읍&mldr;)<br>출처 : <a href="http://www.guro1318.or.kr/bbs/board.php?bo_table=data&amp;wr_id=1723" target=_blank rel="noopener noreffer">http://www.guro1318.or.kr/bbs/board.php?bo_table=data&wr_id=1723</a></figcaption></figure><p>회사를 다니다 보면 아주 일반적으로 &ldquo;시키는 일"을 하곤 한다. 주어진 업무를 정해진 기간 안에 스펙에 맞춰 개발하는. 아주 극단적으로 나쁘게 말하면 &ldquo;도구"로 전락되어버릴 수도 있는 시간들. (개발자가 도구가 된다는 말은 너무나도 듣기 싫은 말중에 하나.) 흔히 말하는 CRUD(Create, Read, Update, Delete) 성의 개발 업무를 하곤 한다. 하지만 꼭 성과에 align(더 좋은 한국말을 찾고 싶은데&mldr;) 하는 일 말고도 허드렛일(일종의 서스테이닝?)을 할 경우도 있는데 그게 만약 재미없는 일이라면 어떨까?</p><p>필자는 그렇게 &ldquo;시키는 일만 하며 재미없는 회사생활&rdquo; 보다 &ldquo;재미있게 개발하며 성장을 할 수 있는 회사생활&rdquo; 이라는 기준을 가지고 한 해를 지내온 것 같다. 즉, &ldquo;시키는 일"이 아닌 &ldquo;시키지도 않은 일"을 찾아서 해가며. 예컨대, 처음에 잡았던 서비스 구조가 사용자가 많아지고 요구사항이 많아짐에 따라 복잡하고 성능을 저해하는 상황을 발견하고 미리 구조개선을 통해 성능과 효율이라는 두마리의 토끼를 잡는다거나. 지난 외부 세미나에서 듣고 인사이트를 얻어 팀내에도 적용해본 <a href=https://taetaetae.github.io/2019/10/13/batch-nondisruptive-deploy/ target=_blank rel="noopener noreffer">배치 무중단 배포 기능</a>. 팀 내 코드리뷰의 활성화와 수동으로 해야할 업무들을 메신저 봇을 활용하여 자동화 한다거나. 서비스 지표 대시보드를 만들어 한눈에 서비스 상황을 볼 수 있게 별도의 개발 페이지를 만들어 보는 등. 다양한 업무 내/외 적으로 일을 찾아가며 + 필자의 개인 시간을 할애해 가면서 정말 재미있게 보내온 것 같다.</p><p>하지만 뒤를 돌아보면 &ldquo;성장 했는가?&rdquo; 라는 질문이 있다면 &ldquo;그렇게 하고있는것 같아서 신나게 해왔는데 돌아보니 막상 뭘했나 하는 느낌이 든다&rdquo; 라고 말할 수 있을 정도로 여러가지를 많이 하며 다양한 &ldquo;경험"을 얻긴 했지만 실질적인 &ldquo;성장"은 아쉽지만 부족한 한 해 였던것 같다.</p><p>회사가 원하는, 연차에 맞는 업무 역량과 개발 팀에서의 위치를 충족시키기엔 회사 안에서 성장하기엔 한계가 있다고 판단이 들었다. (이 생각이 왜 이제서야 들었을까.) 오픈소스나 새로운 언어를 회사 밖에서 혼자서 공부 하던지 여러명이서 스터디를 통해 습득을 해야하고 토이프로젝트 또한 회사와 별도로 진행하며 개발 스킬을 늘려야 할것 같다. 그 이유는 회사에서의 성장이 결국 나의 성과로 잡힐 수는 없는데 괜시리 기대를 하게 되기도 하고 특히 서비스를 운영하는 팀에서는 요즘 핫 하다는 개발 방법론이나 솔루션을 도입하기에는 다소 무리가 있기 때문이다. (물론 회사일도 하면서 성장을 할 수 있는 상황이라면 금상첨화. 이를 찾는건 정말 어려운 일 같다.)</p></div><div class=post-footer><a href=/2019/12/29/review-2019/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/review/>Review</a>,&nbsp;<a href=/tags/archives-2019/>Archives-2019</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2019/10/27/a-reason-for-writing/><img class=lazyload src=/svg/loading.min.svg data-src=/images/a-reason-for-writing/idea.jpg data-srcset="/images/a-reason-for-writing/idea.jpg, /images/a-reason-for-writing/idea.jpg 1.5x, /images/a-reason-for-writing/idea.jpg 2x" data-sizes=auto alt=/images/a-reason-for-writing/idea.jpg title=/images/a-reason-for-writing/idea.jpg></a></div><h1 class=single-title itemprop="name headline"><a href=/2019/10/27/a-reason-for-writing/>개발하기 바쁜데 글까지 쓰라고? (글쓰는 개발자가 되자.)</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2019-10-27>2019-10-27</time></span>&nbsp;<span class=post-category>included in <a href=/categories/blog/><i class="far fa-folder fa-fw" aria-hidden=true></i>Blog</a></span></div><div class=content><p>신입시절. 배워야 할 것도 회사 업무도 많아 허우적대던 때가 있었다. 그렇게 하루에 3<del>4시간 자며 정신없이 하루를 보내던 날 문득 동기 형이 &ldquo;개발자는 기술 블로그를 해야 돼!&ldquo;라는 전혀 이해가 안 되는 말을 해온다. 이렇게 바빠 죽겠는데 블로그에 글까지 쓰라고? 말이 되는 소릴 하라며 반박하다 못내 이기는 척 하나 둘 글을 쓰기 시작했고, 다른 유명 블로거처럼 엄청나진 않지만 하루에 1,000</del>2,000명 정도 들어오며 점점 성장해 가는 나만의 기술 블로그가 되었다.</p><figure><a class=lightgallery href=/images/a-reason-for-writing/blog_graph.jpg title=/images/a-reason-for-writing/blog_graph.jpg data-thumbnail=/images/a-reason-for-writing/blog_graph.jpg data-sub-html="<h2>미약하지만 처음보다는 성장하고 있는 블로그 PV(Page View)</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/a-reason-for-writing/blog_graph.jpg data-srcset="/images/a-reason-for-writing/blog_graph.jpg, /images/a-reason-for-writing/blog_graph.jpg 1.5x, /images/a-reason-for-writing/blog_graph.jpg 2x" data-sizes=auto alt=/images/a-reason-for-writing/blog_graph.jpg width=80%></a><figcaption class=image-caption>미약하지만 처음보다는 성장하고 있는 블로그 PV(Page View)</figcaption></figure><p>또한 필자의 개발자 경력(?)을 돌이켜 보자면 기술 블로그를 하기 전과 하고 난 후로 나뉠 만큼 기술 블로그는 개인적으로 엄청난 영향력이 되었다.</p><blockquote><p>이 기회를 빌어 동기 형에게 감사의 인사를 전하고 싶다. 형. 보고 있죠? ;]</p></blockquote><p>이번 포스팅은 꼭 &ldquo;블로그를 하자&rdquo; 라기 보다 &ldquo;글을 왜 써야 하고 어떻게 써야 하는지"에 대해 이야기해보고자 한다. 처음 이 글을 쓰려고 마음먹었을 땐 개발자라는 직군에 국한되지 않고 누구에게나 적용될 정도의 범용적인 글을 쓰려 했으나 &ldquo;S"의 조언으로 독자(타깃)을 최대한 개발자에 맞춰 써보고자 한다. thanks to &ldquo;S&rdquo;</p><p>사실 조금만 검색을 해보면 특히 개발자에게 글쓰기가 얼마나 중요한지 찾아볼 수 있을 정도로 다양한 글들에서 &ldquo;개발자가 왜 글을 써야 하는가"에 대한 내용이 언급이 되곤 했었다. 글을 쓰지 않던 개발자. 하지만 지금은 글쓰기가 정말 중요하다고 느끼며 적어도 2주에 하나 이상의 글을 쓰려는 현업 개발자의 시선에서 정리를 해보고자 한다.
그리고 마침 멘토링 해주고 있는 분께도 글 쓰는것에 대한 중요성을 알려주고 싶었고, 팀 내에도 공유를 하고 싶어 겸사겸사.</p><h2 id=왜-글을-써야-할까>왜 글을 써야 할까?</h2><h3 id=비로소-내-것이-되기-위한-과정>비로소 내 것이 되기 위한 과정</h3><p>프로그래밍 언어를 처음 배울때 꼭 만나는 문구 <code>Hello World를 출력하시오</code>. 이게 의미하는 의미가 무엇일까? 정말 새로운 세계를 알려주려 하는 것 일까?(그럴수도 있다&mldr;) 우리가 살아가며 &ldquo;배움"이라는 과정은 대부분 비슷하겠지만 특히 IT 기술은 책을 다 읽었다든지, 동영상 강의를 다 들었다고 해서 내 것이 되었다고 말하기는 어려울 것 같다. 직접 키보드를 두드려 가며 거기서 얻을 수 있는 또 다른 &ldquo;인사이트&rdquo; 가 생길 수도 있기 때문이다.</p><p>다른 예로, 운영하던 시스템이나 서비스에서 장애를 맞았다고 가정해보자. 하지만 우리는 늘 그래왔듯 어떻게든 장애를 해결할 것이다. 이러한 상황에서 분명 &ldquo;문제의 원인"이 있었을 테고 &ldquo;해결 과정"이 있기 마련인데 이곳에서도 &ldquo;인사이트"가 분명 있을 것이다.</p><p>이러한 &ldquo;인사이트"를 글로 적다 보면 그냥 &ldquo;아~ 그렇구나, 그랬었지&rdquo; 하는 머릿속에서의 기억보다는 훨씬 더 오래 남을 것이고 혹여 글에서 정리를 잘못해 다른 사람들의 피드백이 있다면 더할 나위 없이 좋은 효과라고 생각이 된다. (이것이 바로 공유의 힘!)</p><p>더불어 글을 쓸 때 올바른 정보에 기반하여 쓰는 습관이 중요한데 그러다 보면 원래 쓰려고 했던 내용보다 더 깊게 알아가는 과정 속에서 또 다른 배움을 얻을 수 있는 반강제적 기회가 생길 수 있다. 누가 시키지 않았어도 배운 것에 대한 활용을 하고 싶은 생각이 들고 이를 또 글로 쓰고. 긍정적인 순환 속에 생겨나는 작은 발자국일지라도 성장해가는 자신을 느낄 수 있을 것이다.</p><h3 id=몸이-기억하는-정리하는-습관>몸이 기억하는 정리하는 습관</h3><p>개발을 하다 보면 정말 간단한 &ldquo;CRUD&rdquo;(Create, Read, Update, Delete) 부터 시작해서 엄청나게 복잡한 도메인 지식에 기반하여 개발을 해야 하는 상황이 생긴다. 그럴 때면 머릿속으로 정리하는 것보다 그림이나 글을 써가면서 정리하는 게 좋다는 건 굳이 말하지 않아도 아는 사실. 글을 쓰다 보면 기승전결의 정리 방법과 목적이 무엇이고 근거가 무엇인지에 대해 구분하는 스킬이 늘어나는 것 같다.(적어도 필자는 기술 블로그를 운영하면서 정리하는 스킬이 그전보다 엄청나게 늘어났다고 자부한다.)</p></div><div class=post-footer><a href=/2019/10/27/a-reason-for-writing/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/writing/>Writing</a>,&nbsp;<a href=/tags/blog/>Blog</a>,&nbsp;<a href=/tags/archives-2019/>Archives-2019</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2019/10/13/batch-nondisruptive-deploy/><img class=lazyload src=/svg/loading.min.svg data-src=/images/batch-nondisruptive-deploy/wait_illustration.jpg data-srcset="/images/batch-nondisruptive-deploy/wait_illustration.jpg, /images/batch-nondisruptive-deploy/wait_illustration.jpg 1.5x, /images/batch-nondisruptive-deploy/wait_illustration.jpg 2x" data-sizes=auto alt=/images/batch-nondisruptive-deploy/wait_illustration.jpg title=/images/batch-nondisruptive-deploy/wait_illustration.jpg></a></div><h1 class=single-title itemprop="name headline"><a href=/2019/10/13/batch-nondisruptive-deploy/>더이상 기다리지 않아도 되는 배치 무중단 배포</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2019-10-13>2019-10-13</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><p><a href=https://taetaetae.github.io/2019/09/29/woowabros-spring-batch/ target=_blank rel="noopener noreffer">지난 포스팅</a>, 그러니까 우아한 형제들에서 초대를 받아 Spring batch 에 대한 테크세미나에 다녀 왔다. 그 중 가장 인상깊었던 부분이 바로 <code>무중단 배포</code>. 차일피일 미루다 필자가 속한 팀에서도 배포때마다 가장 불편을 느끼고 있었던 부분이었기도 했고, <code>그런가보다</code> 하며 개념만 알고 넘어가기엔 무언가 양심에 찔려 직접 무중단 배포를 할 수 있도록 구성을 해보고 테스트까지 해보고자 한다.</p><h2 id=상황-및-문제점>상황 및 문제점</h2><p>리눅스 서버에 Jenkins가 설치되어 있고, Spring batch 모듈을 실행시키고 있다. 수동으로 실행을 하거나, Jenkins RestApi를 이용해서 실행을 할 수 있지만 주로 정해진 시간 즉, 스케쥴링에 의해 실행되곤 한다. 스케쥴링의 가장 작은 단위는 1분단위 배치도 있기 때문에 24시간 멈추지 않고 실행되고 있다고 무방하다. 하지만 배치 모듈이 수정되고, 배포를 하기 위해서는 다음과 같은 시나리오로 진행이 된다.</p><ol><li>Jenkins 설정의 <code>끄기전 준비</code> 를 실행하여 더이상 Jenkins에 의해 Spring batch 모듈(이하 Job)이 실행되지 않도록 한다.</li><li>새로운 Job은 더이상 실행되지 않지만 이미 실행중이였던 Job 은 강제로 중단을 하거나 Job 이 끝날때까지 기다린다.</li><li>실행중인 Job이 없을 경우 이제 배포를 진행한다.</li><li>배포가 완료되면 Jenkins 설정의 <code>끄기전 준비</code>를 해제한다.</li></ol><figure><a class=lightgallery href=/images/batch-nondisruptive-deploy/wait.jpg title=/images/batch-nondisruptive-deploy/wait.jpg data-thumbnail=/images/batch-nondisruptive-deploy/wait.jpg data-sub-html="<h2>실행중인 Job이 안끝나면 마냥 기다릴텐가? 출처 : https://m.post.naver.com/viewer/postView.nhn?volumeNo=14100660&memberNo=2032633</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/batch-nondisruptive-deploy/wait.jpg data-srcset="/images/batch-nondisruptive-deploy/wait.jpg, /images/batch-nondisruptive-deploy/wait.jpg 1.5x, /images/batch-nondisruptive-deploy/wait.jpg 2x" data-sizes=auto alt=/images/batch-nondisruptive-deploy/wait.jpg width=80%></a><figcaption class=image-caption>실행중인 Job이 안끝나면 마냥 기다릴텐가?<br>출처 : <a href="https://m.post.naver.com/viewer/postView.nhn?volumeNo=14100660&amp;memberNo=2032633" target=_blank rel="noopener noreffer">https://m.post.naver.com/viewer/postView.nhn?volumeNo=14100660&memberNo=2032633</a></figcaption></figure><p>실행되는 Job을 중단하지 못하는 상황 즉, 실행중에 중단하면 트랜잭션이 깨져 무조건 기다려야만 하는 상황이라면 배포 또한 계속 지연될 수 밖에 없는 상황인 것이다. Spring boot에 java config 를 활용하고 딱 <code>jar</code> 파일 하나를 실행하는 방식이라면 <code>jar</code>파일을 바꿔치기 하는 식으로 고민을 해볼수도 있을것 같다. 하지만 Legacy 코드가 아직 존재하여 일반 Spring 에 xml 로 config 하는 방식으로 운영중이라 <code>jar</code>파일 하나만 바꿔치기 하기엔 무리가 있는 상황.</p><p>은총알처럼 어디에서나 사용이 가능한 만병통치약 같은 방법은 없다. 언제나 그랬듯 현재 시스템(xml config 방식)에 가장 최적화된 방법, 그리고 java config 방식에서도 사용이 가능할것 같은 방법을 생각해 보았다.</p><h2 id=무중단-배포를-가능케-하는-3가지-핵심>무중단 배포를 가능케 하는 3가지 핵심</h2><p><strong>1. 배포를 매번 새로운 경로에 배포한다.</strong>
각 회사마다, 그리고 서비스마다 정말 다양한 배포 시스템이 있다. 그들의 공통점은 원격서버의 <code>특정 경로</code>에 빌드된 파일들을 밀어 넣어준다는 것. 시나리오는 다음과 같다.</p><ol><li>배포할때마다 별도의 디렉토리를 생성한뒤 심볼릭 링크를 연결해준다.</li><li>배포는 <code>1</code>에서 연결한 심볼릭 링크에 배포되도록 설정, 결국 매번 만들어지는 디렉토리에 배포가 되게 된다.</li></ol><p>여기서 중요한점은 &ldquo;배포할 때마다 새로운 디렉토리에 배포가 된다&rdquo; 와 배포시에는 항상 심볼릭 링크에만 배포를 하면 되기 때문에 &ldquo;배포시스템이 새로 만들어지는 디렉토리의 경로를 몰라도 무방하다"는 점이다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/sh
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=nb>cd</span> /~~~/deploy/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 임시 디렉토리</span>
</span></span><span class=line><span class=cl><span class=nv>DIRECTORY_NAME</span><span class=o>=</span>batch_<span class=k>$(</span>/bin/date +%Y%m%d%H%M%S<span class=k>)</span>
</span></span><span class=line><span class=cl>mkdir <span class=nv>$DIRECTORY_NAME</span>
</span></span></code></pre></div><p>위 쉘 스크립트를 실행하면 batch_20191012205218 와 같은 디렉토리가 생성이 된다. 심볼릭 링크 관련해서는 바로 아래 이어서 설명하겠다.</p><p><strong>2. 심볼릭 링크의 원래 링크를 즉시 변경</strong>
보통 심볼릭 링크 (즉, 바로가기) 의 경로를 변경하기 위해서는 아래처럼 지웠다가 삭제하는 식으로 했었는데</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mkdir directory_a
</span></span><span class=line><span class=cl>$ mkdir directory_b
</span></span><span class=line><span class=cl>$ ln -s directory_a asdf
</span></span><span class=line><span class=cl>$ ll
</span></span><span class=line><span class=cl>asdf -&gt; directory_a
</span></span><span class=line><span class=cl>directory_a
</span></span><span class=line><span class=cl>directory_b
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># directory_a 에서 directory_b 로 바꾸는 경우 (심볼릭 링크 자체를 삭제하고 다시 심볼릭 링크 생성)</span>
</span></span><span class=line><span class=cl>$ rm asdf
</span></span><span class=line><span class=cl>$ ln -s directory_b asdf
</span></span><span class=line><span class=cl>$ ll
</span></span><span class=line><span class=cl>asdf -&gt; directory_b
</span></span><span class=line><span class=cl>directory_a
</span></span><span class=line><span class=cl>directory_b
</span></span></code></pre></div><p>이렇게 되면 삭제하고 ~ 다시 만들어지는 타이밍에 배포가 되거나 실행이 되는 즉, 해당 경로에 엑세스 하는 경우 이전의 경로를 바라본다거나 의도했던 방식으로 실행이 되지 않는 상황이 발생한다. (찰나의 타이밍 이지만 필자는 이러한 문제로 이전의 경로를 바라보는 문제가 발생했었다.) 그래서 ln 의 옵션중인 <code>-Tfs</code>옵션으로 즉시 변경을 해주도록 하자. (<a href=https://linux.die.net/man/1/ln target=_blank rel="noopener noreffer">ln man 참고</a>)</p></div><div class=post-footer><a href=/2019/10/13/batch-nondisruptive-deploy/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/batch/>Batch</a>,&nbsp;<a href=/tags/jenkins/>Jenkins</a>,&nbsp;<a href=/tags/linux/>Linux</a>,&nbsp;<a href=/tags/archives-2019/>Archives-2019</a></div></div></article><ul class=pagination><li class=page-item><span class=page-link><a href=/>1</a></span></li><li class=page-item><span class=page-link aria-hidden=true>&mldr;</span></li><li class=page-item><span class=page-link><a href=/page/4/>4</a></span></li><li class=page-item><span class=page-link><a href=/page/5/>5</a></span></li><li class="page-item active"><span class=page-link><a href=/page/6/>6</a></span></li><li class=page-item><span class=page-link><a href=/page/7/>7</a></span></li><li class=page-item><span class=page-link><a href=/page/8/>8</a></span></li><li class=page-item><span class=page-link aria-hidden=true>&mldr;</span></li><li class=page-item><span class=page-link><a href=/page/18/>18</a></span></li></ul></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.147.9">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2016 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://taetaetae.github.io/resume target=_blank>태태태</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:500},data:{"id-1":"Software development engineer"},lightgallery:!0,typeit:{cursorChar:"|",cursorSpeed:500,data:{"id-1":["id-1"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-86432198-1",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-86432198-1" async></script></body></html>