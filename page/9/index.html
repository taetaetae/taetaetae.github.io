<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.147.9"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title></title><meta name=Description content="This is my cool site"><meta property="og:url" content="https://taetaetae.github.io/"><meta property="og:site_name" content="My cool site"><meta property="og:title" content="My cool site"><meta property="og:description" content="This is my cool site"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="My cool site"><meta name=twitter:description content="This is my cool site"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><meta name=naver-site-verification content="2d1cdbb963ba178aa7cbf58500afc668cae1e645"><meta name=google-site-verification content="vvFCdv0-GuQhEWG8vtNJfA7YSY2HYQ1hpHh9P-a6Pv8"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://taetaetae.github.io/><link rel=alternate href=/index.xml type=application/rss+xml title><link rel=feed href=/index.xml type=application/rss+xml title><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","url":"https:\/\/taetaetae.github.io\/","inLanguage":"en","author":{"@type":"Person","name":"태태태"},"description":"This is my cool site","name":""}</script></head><body data-header-desktop=auto data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title>👨‍💻꿈꾸는 태태태의 공간</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title>👨‍💻꿈꾸는 태태태의 공간</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class="page home" data-home=posts><div class=home-profile><div class=home-avatar><a href=/posts/ title=Posts><img class=lazyload src=/svg/loading.min.svg data-src=/images/profile.png data-srcset="/images/profile.png, /images/profile.png 1.5x, /images/profile.png 2x" data-sizes=auto alt=/images/profile.png title=/images/profile.png></a></div><div class=home-subtitle><div id=id-1 class=typeit></div></div><div class=links><a href=https://github.com/taetaetae title=GitHub target=_blank rel="noopener noreffer me"><i class="fab fa-github fa-fw" aria-hidden=true></i></a><a href=https://linkedin.com/in/taetaetae title=LinkedIn target=_blank rel="noopener noreffer me"><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=https://www.instagram.com/_taetaetae title=Instagram target=_blank rel="noopener noreffer me"><i class="fab fa-instagram fa-fw" aria-hidden=true></i></a><a href=https://facebook.com/taetaetae0 title=facebook target=_blank rel="noopener noreffer me"><i class="fab fa-facebook fa-fw" aria-hidden=true></i></a><a href=mailto:taetaetae_@naver.com title=Email rel=me><i class="far fa-envelope fa-fw" aria-hidden=true></i></a><a href=/index.xml title=RSS target=_blank rel="noopener noreffer me"><i class="fas fa-rss fa-fw" aria-hidden=true></i></a></div></div><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2019/03/17/jenkins-upgrade-master-slave/><img class=lazyload src=/svg/loading.min.svg data-src=/images/jenkins-upgrade-master-slave/jenkins.jpg data-srcset="/images/jenkins-upgrade-master-slave/jenkins.jpg, /images/jenkins-upgrade-master-slave/jenkins.jpg 1.5x, /images/jenkins-upgrade-master-slave/jenkins.jpg 2x" data-sizes=auto alt=/images/jenkins-upgrade-master-slave/jenkins.jpg title=/images/jenkins-upgrade-master-slave/jenkins.jpg></a></div><h1 class=single-title itemprop="name headline"><a href=/2019/03/17/jenkins-upgrade-master-slave/>Jenkins 업그레이드 및 Master-Slave 구성</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2019-03-17>2019-03-17</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><p>어떠한 작업(Job)이 있다고 가정해보자. 이를 &ldquo;정해진 시간에 주기적&rdquo; 이나 &ldquo;필요할때&rdquo; 작업을 수행하고 싶다면 어떤 툴(Tool)이 떠오르는가? 그리고 이 작업(Job)들의 실행이력 등 전체적으로 관리하고 필요에 따라 다양한 플러그인을 활용하여 입맛에 맞는 작업(Job)으로 구성하고 싶을때 가장 첫번째로 떠오르는 툴은 바로 &ldquo;Jenkins&rdquo; 다. (극히 필자 개인적인 생각일수도 있지만&mldr; ) 물론 리눅스 기반의 crontab 이나 다른 스케쥴러를 활용할수도 있다. 다만 필자 개인적인 느낌으로 나만의 Jarvis(?)처럼 내가 원하는데로 설정만 해두면 정해진 시간에 수행하고 그 결과를 로그로 남겨놓고 문제가 발생했을때 알림도 받을수 있으니 너무 좋은 툴이라 생각이 든다.</p><figure><a class=lightgallery href=/images/jenkins-upgrade-master-slave/ColossalSociableBuffalo-size_restricted.gif title=/images/jenkins-upgrade-master-slave/ColossalSociableBuffalo-size_restricted.gif data-thumbnail=/images/jenkins-upgrade-master-slave/ColossalSociableBuffalo-size_restricted.gif data-sub-html="<h2>실제로 Jarvis가 있다면 얼마나 편할까출처 : https://gfycat.com/ko/colossalsociablebuffalo</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/jenkins-upgrade-master-slave/ColossalSociableBuffalo-size_restricted.gif data-srcset="/images/jenkins-upgrade-master-slave/ColossalSociableBuffalo-size_restricted.gif, /images/jenkins-upgrade-master-slave/ColossalSociableBuffalo-size_restricted.gif 1.5x, /images/jenkins-upgrade-master-slave/ColossalSociableBuffalo-size_restricted.gif 2x" data-sizes=auto alt=/images/jenkins-upgrade-master-slave/ColossalSociableBuffalo-size_restricted.gif width=80%></a><figcaption class=image-caption>실제로 Jarvis가 있다면 얼마나 편할까<br>출처 : <a href=https://gfycat.com/ko/colossalsociablebuffalo target=_blank rel="noopener noreffer">https://gfycat.com/ko/colossalsociablebuffalo</a></figcaption></figure><p>지난 <a href=https://taetaetae.github.io/2018/12/02/jenkins-install/ target=_blank rel="noopener noreffer">포스팅</a>에서는 Jenkins 를 설치하는 방법에 대해 알아보았다. (정확히 말하면 치트키 수준의&mldr; ) 이번 포스팅에서는 Jenkins에 노드를 추가하여 master-slave 분산환경으로 구성하는 방법과 Jenkins 버전을 업그레이드 하는 방법에 대해 정리해보고자 한다.</p><blockquote><p>마침 필자의 팀에서 젠킨스를 분산환경으로 운영하고 있었는데 버전은 1.x &mldr; 간헐적으로 Jenkins 버전 이슈로 에러가 발생해서 업그레이드를 해야하는 상황이 생긴것이다. 시키지도 않은 일을 하면서 팀에 도움도 될겸, 포스팅도 할겸, 1석 2조 효과. 서버 환경은 CentOS 7.4 64Bit 에서 테스트 하였다.</p></blockquote><h2 id=jenkins-버전-업그레이드-하기>Jenkins 버전 업그레이드 하기</h2><p>Jenkins를 업그레이드 하게되면 기존에 있었던 Jenkins의 환경설정은 어떻게 마이그레이션 할까? Job 실행기록들은 그냥 날려버려야 하나? 걱정을 하며 구글링을 해본다. 그러면 &ldquo;안해본것에 대한 두려움&rdquo; 을 갖는 필자의 마음이 무색할 정도로 너무 간단하게도 그냥 기존에 있던 war 파일을 최신버전으로 교체하고 재시작 하라고 나온다. 읭? 뭐이리 간단해? 대부분의 문제들은 지레 겁부터 먹고 실행에 옮기지 <del>못해서</del> 않아서 해결을 하지 못하는게 절반 이상같다. 자, 바로 실행에 옮겨보자.
우선 버전 업그레이드를 테스트 하기 위해 일부러 <a href=http://mirrors.jenkins.io/war-stable/ target=_blank rel="noopener noreffer">낮은버전</a>으로 설치를 해둔다. (필자는 1.609.1로 설치해봤다.) 그리고 버전 업그레이드 후 설정이 그대로 옮겨지는지를 확인하기위해 Security 설정을 해서 Jenkins 접근시 로그인 여부를 물어보록 설정해둔다.</p><figure><a class=lightgallery href=/images/jenkins-upgrade-master-slave/old_jenkins.jpg title=/images/jenkins-upgrade-master-slave/old_jenkins.jpg data-thumbnail=/images/jenkins-upgrade-master-slave/old_jenkins.jpg data-sub-html="<h2>우측 하단에 빨간영역으로 낮은버전이 설치된것을 확인할수 있다.</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/jenkins-upgrade-master-slave/old_jenkins.jpg data-srcset="/images/jenkins-upgrade-master-slave/old_jenkins.jpg, /images/jenkins-upgrade-master-slave/old_jenkins.jpg 1.5x, /images/jenkins-upgrade-master-slave/old_jenkins.jpg 2x" data-sizes=auto alt=/images/jenkins-upgrade-master-slave/old_jenkins.jpg width=80%></a><figcaption class=image-caption>우측 하단에 빨간영역으로 낮은버전이 설치된것을 확인할수 있다.</figcaption></figure><p>설정이 완료되었으면 최신버전의 war를 다운받아 교체하고 재시작을 해준다. 그러면 너무나도 간단하게 버전이 업그레이드가 된것을 확인할수 있다. 그리고 처음에 설정한 Security 설정까지 그대로 유지되는것 또한 확인이 가능하다. 물론 구 버전에서 설치되었던 플러그인들이 버전업이 되며 그에 따라 지원하지 않는 문제들이 생길 수 있는데 이 부분은 플러그인을 업그레이드를 해준다거나 각 상황에 맞는 대응을 해줘야 한다. 이렇게 해서 생각보다(?) 너무 간단하게 버전업이 완료되었다.</p><figure><a class=lightgallery href=/images/jenkins-upgrade-master-slave/upgrade_complete.jpg title=/images/jenkins-upgrade-master-slave/upgrade_complete.jpg data-thumbnail=/images/jenkins-upgrade-master-slave/upgrade_complete.jpg data-sub-html="<h2>업그레이드 후 플러그인 업그레이드도 동일하게 맞춰주는게 중요하다.</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/jenkins-upgrade-master-slave/upgrade_complete.jpg data-srcset="/images/jenkins-upgrade-master-slave/upgrade_complete.jpg, /images/jenkins-upgrade-master-slave/upgrade_complete.jpg 1.5x, /images/jenkins-upgrade-master-slave/upgrade_complete.jpg 2x" data-sizes=auto alt=/images/jenkins-upgrade-master-slave/upgrade_complete.jpg width=80%></a><figcaption class=image-caption>업그레이드 후 플러그인 업그레이드도 동일하게 맞춰주는게 중요하다.</figcaption></figure><h2 id=jenkins-분산환경-구성하기-노드-추가하기>Jenkins 분산환경 구성하기 (노드 추가하기)</h2><p>이번엔 Jenkins를 분산환경으로 구성해보고자 한다. 이렇게 노드를 추가하며 분산환경을 구성하는 이유는 마스터-슬레이브(Master-Slave) 패턴의 장점을 얻고자 함이다. 마스터는 작업을 쪼개고 슬레이브로 구성된 노드에게 분배를 하게되면 슬레이브 서버는 마스터의 요청을 처리하고 리턴하게 된다. 마치 스타크래프트에서 일꾼을 늘려서 미네랄과 가스를 더 빨리 얻는것처럼 말이다.</p><p>여기서 필자가 가장 많이 삽질한 부분. 슬레이브 서버를 추가하는데 슬레이브 서버가 되는 서버에 동일하게 젠킨스를 설치하고 그들을 모두 연결하려 했던것&mldr; 마치 클러스터링 하는것처럼&mldr; 당연히 Jenkins 들의 묶음형태(?) 가 되야 할것같은 생각으로 시도하였지만 엄청난 삽질의 연속이 되어버렸다. 알고보니 마스터 Jenkins에서 슬레이브 서버에 작업을 전달할수 있도록 연동만 시켜주면 자동으로 Agent를 마스터 Jenkins가 슬레이브 서버에 설치/실행을 하고 작업을 분할하는것을 확인할 수 있었다. 자, 그럼 시작해보자.</p><ol><li>마스터 서버에서 공개키와 개인키 생성
먼저 마스터 서버와 슬레이브 서버를 SSH로 통신할수 있도록 SSH 키 설정을 해준다. 통상 홈 디렉토리 하위 .ssh 폴더에서 생성한다.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ssh 키 생성
</span></span><span class=line><span class=cl>$ ssh-keygen -t rsa
</span></span><span class=line><span class=cl>Generating public/private rsa key pair.
</span></span><span class=line><span class=cl>Enter file in which to save the key <span class=o>(</span>/~/.ssh/id_rsa<span class=o>)</span>:
</span></span><span class=line><span class=cl>Enter passphrase <span class=o>(</span>empty <span class=k>for</span> no passphrase<span class=o>)</span>:
</span></span><span class=line><span class=cl>Enter same passphrase again:
</span></span><span class=line><span class=cl>Your identification has been saved in /~/.ssh/id_rsa.
</span></span><span class=line><span class=cl>Your public key has been saved in /~/.ssh/id_rsa.pub.
</span></span><span class=line><span class=cl>The key fingerprint is:
</span></span><span class=line><span class=cl>SHA256:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ user@hostname
</span></span><span class=line><span class=cl>The key<span class=err>&#39;</span>s randomart image is:
</span></span><span class=line><span class=cl>+---<span class=o>[</span>RSA 2048<span class=o>]</span>----+
</span></span><span class=line><span class=cl><span class=p>|</span>oo. .            <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>o... o  +        <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>. .o  o+.o       <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>.++++. +o+o..    <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>o.+*<span class=o>=</span>.o.SEoo<span class=o>=</span>    <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> .  o+.*...+ +   <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   .. + +.  +    <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     + .     .   <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>      ...        <span class=p>|</span>
</span></span><span class=line><span class=cl>+----<span class=o>[</span>SHA256<span class=o>]</span>-----+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>공개키 확인
</span></span><span class=line><span class=cl>$ cat id_rsa.pub
</span></span><span class=line><span class=cl>ssh-rsa AAAAB3Nza~~~~~~~~eQKcx8B6uAflRm1J8In1 user@hostname
</span></span></code></pre></div><ol start=2><li>슬레이브 서버에서 마스터 서버에서 만든 공개키를 등록
슬레이브 서버에서는 마스터 서버에서 SSH 접속을 허용해야 하기때문에 마스터 서버에서 생성한 공개키를 등록해준다. 슬레이브 서버의 홈 디렉토리 하위 .ssh 폴더아래 파일을 만들고 위 공개키를 넣어주자.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ vi authorized_keys
</span></span><span class=line><span class=cl>ssh-rsa AAAAB3Nza~~~~~~~~eQKcx8B6uAflRm1J8In1 user@hostname
</span></span></code></pre></div><ol start=3><li>Jenkins 에서 Credentials 을 만들때 Private Key 설정을 &ldquo;From the Jenkins master ~/.ssh"으로 설정한다. 나중에 이 정보로 인증을 처리한다.</li></ol><a class=lightgallery href=/images/jenkins-upgrade-master-slave/jenkins_upgrade_3.jpg title=/images/jenkins-upgrade-master-slave/jenkins_upgrade_3.jpg data-thumbnail=/images/jenkins-upgrade-master-slave/jenkins_upgrade_3.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/jenkins-upgrade-master-slave/jenkins_upgrade_3.jpg data-srcset="/images/jenkins-upgrade-master-slave/jenkins_upgrade_3.jpg, /images/jenkins-upgrade-master-slave/jenkins_upgrade_3.jpg 1.5x, /images/jenkins-upgrade-master-slave/jenkins_upgrade_3.jpg 2x" data-sizes=auto alt=/images/jenkins-upgrade-master-slave/jenkins_upgrade_3.jpg width=80%></a><ol start=4><li>노드를 추가하고 조금 있으면 마스터 노드가 슬레이브 서버에 에이전트를 설치/실행하고 연동이 된것을 확인할수 있다.</li></ol><a class=lightgallery href=/images/jenkins-upgrade-master-slave/jenkins_upgrade_4.jpg title=/images/jenkins-upgrade-master-slave/jenkins_upgrade_4.jpg data-thumbnail=/images/jenkins-upgrade-master-slave/jenkins_upgrade_4.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/jenkins-upgrade-master-slave/jenkins_upgrade_4.jpg data-srcset="/images/jenkins-upgrade-master-slave/jenkins_upgrade_4.jpg, /images/jenkins-upgrade-master-slave/jenkins_upgrade_4.jpg 1.5x, /images/jenkins-upgrade-master-slave/jenkins_upgrade_4.jpg 2x" data-sizes=auto alt=/images/jenkins-upgrade-master-slave/jenkins_upgrade_4.jpg width=80%></a><p>실제로 슬레이브 서버에서 프로세스를 확인하면 아래처럼 에이전트( slave.jar )가 설치/실행되고 있는것을 확인할수 있다.</p></div><div class=post-footer><a href=/2019/03/17/jenkins-upgrade-master-slave/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/jenkins/>Jenkins</a>,&nbsp;<a href=/tags/archives-2019/>Archives-2019</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2019/02/17/daily-dev-blog-3/><img class=lazyload src=/svg/loading.min.svg data-src=/images/daily-dev-blog-3/ddb-thumnail.jpg data-srcset="/images/daily-dev-blog-3/ddb-thumnail.jpg, /images/daily-dev-blog-3/ddb-thumnail.jpg 1.5x, /images/daily-dev-blog-3/ddb-thumnail.jpg 2x" data-sizes=auto alt=/images/daily-dev-blog-3/ddb-thumnail.jpg title=/images/daily-dev-blog-3/ddb-thumnail.jpg></a></div><h1 class=single-title itemprop="name headline"><a href=/2019/02/17/daily-dev-blog-3/>기술블로그 구독서비스 개발 후기 - 3부</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2019-02-17>2019-02-17</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><p>작년 7월 12일부터 시작한 필자의 첫 토이프로젝트인 <a href=http://daily-devblog.com target=_blank rel="noopener noreffer">기술블로그 구독서비스</a>. 오픈할 때까지만 해도 &ldquo;AWS 프리티어를 사용하고 있는 1년 안에 구독자가 설마 1,000명이 넘겠어?&rdquo; 라고 생각을 했었는데 오픈을 하고 220일째 되는 바로 어제 어느덧 벌써 구독자가 1,000명을 달성하게 되었다. 그 기념으로 그동안 미뤄두었던 <code>기술블로그 구독서비스 개발 후기</code> 시리즈의 3부를 쓰고자 한다.</p><figure><a class=lightgallery href=/images/daily-dev-blog-3/nice_minion.gif title=/images/daily-dev-blog-3/nice_minion.gif data-thumbnail=/images/daily-dev-blog-3/nice_minion.gif data-sub-html="<h2>오예~ 1,000명이다! 땡큐! 출처 : https://gfycat.com/ko/leafytorngroundbeetle</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/daily-dev-blog-3/nice_minion.gif data-srcset="/images/daily-dev-blog-3/nice_minion.gif, /images/daily-dev-blog-3/nice_minion.gif 1.5x, /images/daily-dev-blog-3/nice_minion.gif 2x" data-sizes=auto alt=/images/daily-dev-blog-3/nice_minion.gif width=70%></a><figcaption class=image-caption>오예~ 1,000명이다! 땡큐!<br>출처 : <a href=https://gfycat.com/ko/leafytorngroundbeetle target=_blank rel="noopener noreffer">https://gfycat.com/ko/leafytorngroundbeetle</a></figcaption></figure><p>혹시 전에 내용을 보고자 하면 아래 링크에서 확인할 수 있다.</p><ul><li>1부 : <a href=https://taetaetae.github.io/2018/08/05/daily-dev-blog-1/ target=_blank rel="noopener noreffer">왜 만들게 되었는가 그리고 어떤 구조로 만들었는가</a></li><li>2부 : <a href=https://taetaetae.github.io/2018/08/09/daily-dev-blog-2/ target=_blank rel="noopener noreffer">문제발생 및 Trouble Shooting</a></li><li>3부 : <a href=https://taetaetae.github.io/2019/02/17/daily-dev-blog-3/ target=_blank rel="noopener noreffer">앞으로의 계획과 방향성</a></li></ul><h2 id=그간-어떤-식으로-서비스를-운영했는가>그간 어떤 식으로 서비스를 운영했는가?</h2><p>(한마디로 정리할 순 없는 지난 220일이었지만…) 딱 한마디로 정리하자면 <code>엄청나게 많은 것을 배우고 경험할 수 있었으나 그만큼 힘들었던 시간들</code>이라고 말할 수 있을 것 같다. 2부에서 이야기한 <code>문제 발생에 따른 Trouble Shooting</code>들도 있었지만 운영을 해오다 보니 사전에 생각하지도 못한 부분에서 문제가 생기는 정말 다양한 경험을 할 수 있었기 때문이다.</p><ul><li>블로그 포스팅을 수집하는 과정에서의 문제
일부 블로그 RSS url에 접근을 할 때 요청에 대한 응답이 무한대로 멈춰버리는 현상이 간헐적으로 있었다. 이는 별도의 타임아웃을 설정하지 않았기 때문이다. 그래서 어느 정도의 타임아웃을 두고 시간 내에 응답이 없을 경우 다음 포스팅으로 넘어가도록 하였다. (타임아웃은 아주 기본적인 부분인데&mldr;)</li></ul><pre tabindex=0><code>requests.get(rss_url, timeout=10.0)
</code></pre><ul><li>메일 발송하는 과정에서의 문제
가끔 메일이 오지 않는다고 친절하게 필자 개인 메일로 연락이 오는 경우가 있었다. 그때마다 서버의 상태를 보면 서버에 직접 접속조차 안 될 정도로 메모리 사용량이 너무 많아서 그때마다 AWS 웹 콘솔에서 강제로 서버를 재부팅을 하곤 했었다. 예전에도 이야기한 것처럼 AWS 프리티어를 사용하고 있다 보니 서버의 메모리가 1기가밖에 되지 않아서 &mldr; 제한된 시스템에서 서비스 운영을 할 수밖에 없는 상황이었다.
그래서 수집/발송 상태를 로깅으로 쉽게 볼 수 있고 스케줄링을 하기 위해 띄워둔 Jenkins(tomcat)를 중단하고 crontab으로 스케줄링을 하도록 하였고, 로깅은 <a href=https://stackoverflow.com/questions/4811738/how-to-log-cron-jobs target=_blank rel="noopener noreffer">별도의 파일로 로깅</a>하도록 변경하였다.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>/usr/bin/python3.6 /home/~~~/email_send.py &gt; /home/~~~/logs/job/email_send_<span class=sb>`date +\%Y\%m\%d\%H\%M\%S`</span>.log 2&gt;<span class=err>&amp;</span>1
</span></span></code></pre></div><p>또한 기존에는 빠르게 발송하기 위해 냅다 스레드로 돌렸는데 구독자 수가 많아지다 보니 <code>RuntimeError: can't start new thread</code> 라고 스레드를 만들 수 없다는 에러가 발생하기도 했다. 그래서 Pool을 사용하는 방식의 <a href=https://docs.python.org/3.4/library/multiprocessing.html target=_blank rel="noopener noreffer">multiprocessing</a> 을 도입하여 스레드로 발송할 때보다는 엄청나게 빠른 속도는 아닐지라도 효율적인 메모리 사용으로 2분 안에 1,000명에게 안정된 메일을 보낼 수 있게 되었다. (여담이지만 메일이 안 온다고 알려주셨던 분들께 이 자리를 빌려 감사의 인사를 전하고 싶다.)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>multiprocessing</span> <span class=kn>import</span> <span class=n>Pool</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pool</span> <span class=o>=</span> <span class=n>Pool</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pool</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>sendMail</span><span class=p>,</span> <span class=n>email_list</span><span class=p>)</span>
</span></span></code></pre></div><blockquote><p><a href=https://www.heroku.com/ target=_blank rel="noopener noreffer">Heroku</a> 나 <a href=https://www.netlify.com/ target=_blank rel="noopener noreffer">Netlify</a> 같이 서버를 직접 들어가지 않고 앱 형태로 배포하는 식으로 할 수도 있다. 하지만 초기에 이 토이프로젝트를 시작할 때 실 서비스와 최대한 동일한 시스템으로 운영해보고 싶었기 때문에 라즈베리파이에 설치하는 것까지 알아보다 결국 AWS를 사용하기로 하게 되었다.
그렇다면 AWS 프리티어를 사용하지 않고 별도의 서버를 구매하면 안 될까? 하는 생각도 해봤지만 최소한의 인프라로 최대한의 성능을 내보고 싶은 욕심(?) 때문에 1년간은 프리티어로 운영하고 그다음엔 (혹은 소프트웨어적으로 한계까지 도달한다면) 서버를 구매해서 운영하게 될 것 같다. (적어도 이후에도 이 서비스를 유지한다는 가정하에&mldr;)</p></blockquote><figure><a class=lightgallery href=/images/daily-dev-blog-3/daily-ddb-check.jpg title=/images/daily-dev-blog-3/daily-ddb-check.jpg data-thumbnail=/images/daily-dev-blog-3/daily-ddb-check.jpg data-sub-html="<h2>농부의 마음으로&mldr; 출처 : http://www.iwithjesus.com/news/articleView.html?idxno=2511</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/daily-dev-blog-3/daily-ddb-check.jpg data-srcset="/images/daily-dev-blog-3/daily-ddb-check.jpg, /images/daily-dev-blog-3/daily-ddb-check.jpg 1.5x, /images/daily-dev-blog-3/daily-ddb-check.jpg 2x" data-sizes=auto alt=/images/daily-dev-blog-3/daily-ddb-check.jpg width=70%></a><figcaption class=image-caption>농부의 마음으로&mldr;<br>출처 : <a href="http://www.iwithjesus.com/news/articleView.html?idxno=2511" target=_blank rel="noopener noreffer">http://www.iwithjesus.com/news/articleView.html?idxno=2511</a></figcaption></figure><p>아침 10시가 되면 자동으로 메일이 잘 발송되었는지, 혹 어제 수집된 것이 아니라 예전에 수집된 내용이 중복 발송된 건 아닌지, 발송은 구독한 사람 전부에게 잘 보내졌는지&mldr; 거의 매일같이 Daily-DevBlog 서비스를 살피며 지낸 것 같다. (하루라도 문제가 생기면 밤을 새워서라도 원인을 파악하고 다음 발송에는 정상적으로 발송되도록 수정하기도 했다.)</p></div><div class=post-footer><a href=/2019/02/17/daily-dev-blog-3/>Read More</a></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2019/02/10/access-log-to-elastic-stack/><img class=lazyload src=/svg/loading.min.svg data-src=/images/access-log-to-elastic-stack/elastic_stack.jpg data-srcset="/images/access-log-to-elastic-stack/elastic_stack.jpg, /images/access-log-to-elastic-stack/elastic_stack.jpg 1.5x, /images/access-log-to-elastic-stack/elastic_stack.jpg 2x" data-sizes=auto alt=/images/access-log-to-elastic-stack/elastic_stack.jpg title=/images/access-log-to-elastic-stack/elastic_stack.jpg></a></div><h1 class=single-title itemprop="name headline"><a href=/2019/02/10/access-log-to-elastic-stack/>누구나 할 수 있는 엑세스 로그 분석 따라 해보기 (by Elastic Stack)</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2019-02-10>2019-02-10</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><p>필자가 Elastic Stack을 알게된건 2017년 어느 여름 동기형이 공부하고 있는것을 보고 호기심에 따라하며 시작하게 되었다. 그때까지만 해도 버전이 2.x 였는데 지금 글을 쓰고있는 2019년 2월초 최신버전이 6.6이니 정말 빠르게 변화하는것 같다. 빠르게 변화하는 버전만큼 사람들의 관심도 (드라마틱하게는 아니지만) 꾸준히 늘어나 개인적으로, 그리고 실무에서도 활용하는 범위가 많아지고 있는것 같다.</p><script type=text/javascript src=https://ssl.gstatic.com/trends_nrtr/1709_RC01/embed_loader.js></script><script type=text/javascript>trends.embed.renderExploreWidget("TIMESERIES",{comparisonItem:[{keyword:"elasticsearch",geo:"KR",time:"today 5-y"}],category:0,property:""},{exploreQuery:"date=today%205-y&geo=KR&q=elasticsearch",guestPath:"https://trends.google.co.kr:443/trends/embed/"})</script><p>그래서 그런지 최근들어 <code>(아주 코딱지만큼 조금이라도 더 해본)</code> 필자에게 Elastic Stack 사용방법에 대해 물어보는 주변 지인들이 늘어나고 있다. 그리고 예전에 한창 공부했을때의 버전보다 많이 바꼈기에 이 기회에 &ldquo;그대로 따라만 하면 Elastic Stack을 구성할 수 있을만한 글"을 써보고자 한다. 사실 필자가 예전에 &ldquo;도큐먼트를 보기엔 너무 어려워 보이는 느낌적인 느낌&rdquo; 때문에 삽질하며 구성한 힘들었던 기억을 되살려 최대한 심플하고 처음 해보는 사람도 따라하기만 하면 &ldquo;아~ 이게 Elastic Stack 이구나!&rdquo;, &ldquo;이런식으로 돌아가는 거구나!&rdquo; 하는 도움을 주고 싶다.</p><blockquote><p>+ 그러면서 최신버전도 살펴보고&mldr; 1석2조, 이런게 바로 블로그를 하는 이유이지 않을까?
다시한번 말하지만 도큐먼트가 최고 지침서이긴 하다&mldr;</p></blockquote><p><a href=https://www.elastic.co/kr/products target=_blank rel="noopener noreffer">Elastic 공식 홈페이지</a>에 가면 각 제품군들에 대해 그림으로 된 자세한 설명과 도큐먼트가 있지만 이들을 어떤식으로 조합하여 사용하는지에 대한 전체적인 흐름을 볼 수 있는 곳은 없어 보인다. (지금 보면 도큐먼트가 그 어디보다 설명이 잘되어 있다고 생각되지만 사전 지식이 전혀없는 상태에서는 봐도봐도 어려워 보였다.)
이번 포스팅에서는 <strong>Apache access log를 Elasticsearch에 인덱싱 하는 방법</strong>에 대해 설명해보고자 한다.</p><h2 id=전체적인-흐름>전체적인 흐름</h2><p>필자는 글보다는 그림을 좋아하는 편이라 전체적인 흐름을 그림으로 먼저 보자.</p><a class=lightgallery href=/images/access-log-to-elastic-stack/concept.jpg title=/images/access-log-to-elastic-stack/concept.jpg data-thumbnail=/images/access-log-to-elastic-stack/concept.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/access-log-to-elastic-stack/concept.jpg data-srcset="/images/access-log-to-elastic-stack/concept.jpg, /images/access-log-to-elastic-stack/concept.jpg 1.5x, /images/access-log-to-elastic-stack/concept.jpg 2x" data-sizes=auto alt=/images/access-log-to-elastic-stack/concept.jpg width=100%></a><ol><li>외부에서의 접근이 발생하면 apache 웹서버에서 설정한 경로에 access log가 파일로 생성이 되거나 있는 파일에 추가가 된다. 해당 파일에는 한줄당 하나의 엑세스 정보가 남게 된다.</li><li>fileBeat에서 해당 파일을 트래킹 하고 있다가 라인이 추가되면 이 정보를 logstash 에게 전달해준다.</li><li>logastsh 는 filebeat에서 전달한 정보를 특정 port로 input 받는다.</li><li>받은 정보를 filter 과정을 통해 각 정보를 분할 및 정제한다. (ip, uri, time 등)</li><li>정리된 정보를 elasticsearch 에 ouput 으로 보낸다. (정확히 말하면 인덱싱을 한다.)</li><li>elasticsearch 에 인덱싱 된 정보를 키바나를 통해 손쉽게 분석을 한다.</li></ol><p>한번의 설치고 일련의 과정이 뚝딱 된다면 너무 편하겠지만, 각각의 레이어가 나뉘어져있는 이유는 하는 역활이 전문적으로(?) 나뉘어져 있고 각 레이어에서는 세부 설정을 통해 보다 효율적으로 데이터를 관리할 수 있기 때문이다.</p><blockquote><p>beats라는 레이어가 나오기 전에는 logstash에서 직접 file을 바라보곤 했었는데 beats가 logstash 보다 가벼운 shipper 목적으로 나온 agent 이다보니 통상 logstash 앞단에 filebeat를 위치시키곤 한다고 한다.</p></blockquote><p>전체적인 그림은 위와 같고, 이제 이 글을 보고있는 여러분들이 따라할 차례이다. 각 레이어별로 하나씩 설치를 해보며 구성을 해보자. 설치순서는 데이터 흐름의 순서에 맞춰 다음과 같은 순서로 설치를 해야 효율적으로 볼수가 있다. (아래순서대로 하지 않을경우 설치/시작/종료 를 각각의 타이밍에 맞추어 해줘야 할것 같아 복잡할것같다.)</p><pre tabindex=0><code>elasticsearch → logstash → kibana → filebeat
</code></pre><p>이 포스팅은 CentOS 7.4에서 Java 1.8, apache 2.2가 설치되어있다는 가정하에 보면 될듯하다. 또한 각 레이어별 설명은 구글링을 하거나 Elastic 공식 홈페이지에 가보면 자세히 나와있으니 기본 설명은 안하는것으로 하고, 각 레이어의 세부 설정은 하지 않는것으로 한다.</p><h3 id=elasticsearch>Elasticsearch</h3><p><a href=https://www.elastic.co/kr/products/elasticsearch target=_blank rel="noopener noreffer">공식 홈페이지</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>다운받고 압축풀고 심볼릭 경로 만들고 (심볼릭 경로는 선택사항)
</span></span><span class=line><span class=cl>$ wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.6.0.tar.gz
</span></span><span class=line><span class=cl>$ tar zxvf elasticsearch-6.6.0.tar.gz
</span></span><span class=line><span class=cl>$ ln -s elasticsearch-6.6.0 elasticsearch
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>설정 파일을 열고 추가해준다.
</span></span><span class=line><span class=cl>$ cd elasticsearch/conf
</span></span><span class=line><span class=cl>$ vi elasticsearch.yml
</span></span><span class=line><span class=cl>path.data: /~~~/data/elasticsearch (기본경로에서 변경할때추가)
</span></span><span class=line><span class=cl>path.logs: /~~~/logs/elasticsearch
</span></span><span class=line><span class=cl>network.host: 0.0.0.0 # 외부에서 접근이 가능하도록 (실제 ip를 적어줘도 됨)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>elasticsearch 의 시작과 종료를 조금이나마 편하게 하기위해 스크립트를 작성해줌 (이것또한 선택사항)
</span></span><span class=line><span class=cl>$ cd ../bin
</span></span><span class=line><span class=cl>$ echo &#39;./elasticsearch -d -p es.pid&#39; &gt; start.sh
</span></span><span class=line><span class=cl>$ echo &#39;kill <span class=sb>`cat es.pid`</span>&#39; &gt; stop.sh
</span></span><span class=line><span class=cl>$ chmod 755 start.sh stop.sh
</span></span></code></pre></div><p>혹시 아래와 같은 에러가 발생할경우 <a href=https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html#docker-cli-run-prod-mode target=_blank rel="noopener noreffer">공식문서</a> 대로 진행해준다.</p></div><div class=post-footer><a href=/2019/02/10/access-log-to-elastic-stack/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/elasticsearch/>Elasticsearch</a>,&nbsp;<a href=/tags/logstash/>Logstash</a>,&nbsp;<a href=/tags/kibana/>Kibana</a>,&nbsp;<a href=/tags/filebeat/>Filebeat</a>,&nbsp;<a href=/tags/archives-2019/>Archives-2019</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2019/01/10/spring-redirect-oom/><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test1-pinpoint.jpg data-srcset="/images/spring-redirect-oom/test1-pinpoint.jpg, /images/spring-redirect-oom/test1-pinpoint.jpg 1.5x, /images/spring-redirect-oom/test1-pinpoint.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test1-pinpoint.jpg title=/images/spring-redirect-oom/test1-pinpoint.jpg></a></div><h1 class=single-title itemprop="name headline"><a href=/2019/01/10/spring-redirect-oom/>Spring MVC Redirect 처리중에 발생한 Out Of Memory 원인 분석하기</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2019-01-10>2019-01-10</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><p>초창기 신입시절에 배우거나 사용했던 기술적인 방법들이 있다. 시간이 지날수록 왠만해선 다른방법은 사용하지 않으려 하고 <code>습관</code>처럼 기존에 사용했던 방법을 고수하는 버릇이 있다. 그 이유는 과거에 사용했을때 아무 탈 없이 잘 되었기 때문에, 그리고 빠른 구현 때문이라는 핑계일 것 같다. 이러한 버릇은 비단 이 글을 적고있는 필자 뿐만이 아니라 대부분의 개발자들이 가지고 있을꺼라 조심스레 추측해본다. (아니라면&mldr;더욱 분발 해야겠다&mldr;ㅠ)
최근 운영하고 있는 서비스에서 장애 상황까지 갈수있는 위험한 상황이 있었는데 팀내 코드리뷰를 통해 문제점을 파악할 수 있었다. 그 원인은 Spring MVC Controller 레벨에서 redirect 처리를 할때 return값의 Cardinality가 높을경우 다음과 같이 사용하면 안된다고&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;/test&#34;</span><span class=p>,</span><span class=w> </span><span class=n>method</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RequestMethod</span><span class=p>.</span><span class=na>GET</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>test</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>String</span><span class=w> </span><span class=n>url</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;어떠한 로직에 의해 생성되는 url&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>return</span><span class=w> </span><span class=s>&#34;redirect:&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>url</span><span class=p>;</span><span class=w> </span><span class=c1>// &lt;- 위험 포인트!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>이 코드가 왜? 어디가 어때서?
이제까지 Controller 레벨에서 redirect 처리를 할때 아무생각없이 위에 있는 코드 형태로 구현을 했는데 저러한 코드 때문에 OOM이 발생하여 fullGC 가 여러번 발생하고, 일시적으로 서비스가 지연되는 현상이 발생했다고 한다. 자주 사용하던 방법이였는데 장애를 유발할수 있는 위험한 방법이였다니&mldr;
이번 포스팅에서는 이러한 방법이 왜 잘못되었는지 실제로 테스트를 통해 몸소(?) 체감을 해보고, 그럼 어떤 방법으로 redirect 처리를 해야 하는가와 개선을 함으로써 기존방식에 비해 어떤점이 좋아졌는지에 대해서 정리해보고자 한다.</p><blockquote><p>뭔가 <strong>내것으로 만들기</strong> 시리즈물이 나올것만 같은 느낌이다&mldr;</p></blockquote><h2 id=기존방식의-문제점-재현-및-다양한-원인분석>기존방식의 문제점 재현 및 다양한 원인분석</h2><p>기존방식으로 했을때 왜 OOM이 발생했을까? 우리는 개발자이기 때문에 이런저런 글들만 보고 추측 할것이 아니라 직접 재현을 해보고 다양한 시각에서 원인분석을 해보자.
먼저 기본적인 Spring MVC 뼈대를 만들고 redirect 하는 return 값의 Cardinality가 높도록 random string 을 만들어 주도록 한다. 즉, <code>/random</code>을 호출하면 <code>/result/ETmHfowFkU</code>처럼 random string 이 만들어 지며 redirect 처리가 되는 매우 심플한 구조이다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Spring 버전은 4.0.6.RELEASE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>TestController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@RequestMapping</span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;random&#34;</span><span class=p>,</span><span class=w> </span><span class=n>method</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RequestMethod</span><span class=p>.</span><span class=na>GET</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>random</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=s>&#34;redirect:result/&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>UUID</span><span class=p>.</span><span class=na>randomUUID</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@RequestMapping</span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;result/{message}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>method</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RequestMethod</span><span class=p>.</span><span class=na>GET</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>result</span><span class=p>(</span><span class=n>ModelMap</span><span class=w> </span><span class=n>model</span><span class=p>,</span><span class=w> </span><span class=nd>@PathVariable</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>message</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>model</span><span class=p>.</span><span class=na>addAttribute</span><span class=p>(</span><span class=s>&#34;message&#34;</span><span class=p>,</span><span class=w> </span><span class=n>message</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=s>&#34;result&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>또한 해당 프로젝트에서는 AOP를 사용하고 있었기 때문에 그때와 동일한 상황으로 재현을 하기 위해 AOP관련 설정도 추가해준다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableWebMvc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableAspectJAutoProxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@ComponentScan</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>HelloWorldConfiguration</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Bean</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s>&#34;HelloWorld&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>ViewResolver</span><span class=w> </span><span class=nf>viewResolver</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>InternalResourceViewResolver</span><span class=w> </span><span class=n>viewResolver</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>InternalResourceViewResolver</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>viewResolver</span><span class=p>.</span><span class=na>setViewClass</span><span class=p>(</span><span class=n>JstlView</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>viewResolver</span><span class=p>.</span><span class=na>setPrefix</span><span class=p>(</span><span class=s>&#34;/WEB-INF/views/&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>viewResolver</span><span class=p>.</span><span class=na>setSuffix</span><span class=p>(</span><span class=s>&#34;.jsp&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=n>viewResolver</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>이렇게 한뒤 tomcat으로 최대/최소 메모리를 256m으로 설정후 해당 모듈을 띄워준다. 그다음 메모리 상태를 보기 위해 tomcat에 pinpoint를 연동하고 마지막으로 호출테스트를 위해 nGrinder을 설정해준다. 특별한 설정은 없고 위 컨트롤러의 url (/random) 을 여러번 호출하도록 하였다. nGrinder을 설정하는대에는 <a href=https://black9p.github.io/2019/01/02/nGrinder-%EA%B0%84%ED%8E%B8-%EC%82%AC%EC%9A%A9%EA%B0%80%EC%9D%B4%EB%93%9C/ target=_blank rel="noopener noreffer">이 블로그 포스팅</a>을 참고해서 설정하였다.</p><p>자, 이제 테스트를 시작해보자. (마치 수술 집도하는것 같은 기분으로&mldr;간호사~ 칼!)</p><ol><li>nGrinder
nGrinder의 기본 스크립트에서 url만 해당 서버로 호출되도록 바꿔주고 총 가상 사용자는 2,000으로 시간은 5분으로 설정후에 테스트 시작을 하였더니 다음과 같은 그래프를 볼수 있었다.</li></ol><a class=lightgallery href=/images/spring-redirect-oom/test1-ngrinder.jpg title=/images/spring-redirect-oom/test1-ngrinder.jpg data-thumbnail=/images/spring-redirect-oom/test1-ngrinder.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test1-ngrinder.jpg data-srcset="/images/spring-redirect-oom/test1-ngrinder.jpg, /images/spring-redirect-oom/test1-ngrinder.jpg 1.5x, /images/spring-redirect-oom/test1-ngrinder.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test1-ngrinder.jpg width=100%></a><p>TPS가 불안정해지다가 어느시점부터 낮아지는것을 확인할 수 있다. 이게 서비스 였다면 사용자가 접속하는데 불편을 느꼈을꺼라 추측을 해본다. 또한 아주 간단한 random string 을 리턴하는 페이지 임에도 불구하고 에러 응답이 적지 않은것을 확인할 수 있었다.</p><ol start=2><li>pinpoint
메모리 상태는 어떤지 확인하기 위해 pinpoint를 확인해보면 다음과 같은 그래프를 볼수 있었다.</li></ol><a class=lightgallery href=/images/spring-redirect-oom/test1-pinpoint.jpg title=/images/spring-redirect-oom/test1-pinpoint.jpg data-thumbnail=/images/spring-redirect-oom/test1-pinpoint.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-redirect-oom/test1-pinpoint.jpg data-srcset="/images/spring-redirect-oom/test1-pinpoint.jpg, /images/spring-redirect-oom/test1-pinpoint.jpg 1.5x, /images/spring-redirect-oom/test1-pinpoint.jpg 2x" data-sizes=auto alt=/images/spring-redirect-oom/test1-pinpoint.jpg width=100%></a><p>보기만해도 심장이 벌렁벌렁(?) 뛸 정도로 무서운 그림이다. 실제로 서비스에 (이정도까진 아니였지만) 비슷한 상황이 발생했었다. 메모리가 테스트를 점점 하면 할수록 올라가다가 fullGC가 발생하더니 대나무 숲에 있는 대나무마냥 fullGC가 빼곡히 발생하였다. (이러니&mldr; 페이지 접근에 지연이 생긴것 같다.)</p></div><div class=post-footer><a href=/2019/01/10/spring-redirect-oom/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/spring/>Spring</a>,&nbsp;<a href=/tags/redirect/>Redirect</a>,&nbsp;<a href=/tags/out-of-memory/>Out of Memory</a>,&nbsp;<a href=/tags/heap-dump/>Heap Dump</a>,&nbsp;<a href=/tags/archives-2019/>Archives-2019</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2019/01/02/faster-parallel-processes/><img class=lazyload src=/svg/loading.min.svg data-src=/images/faster-parallel-processes/bg.jpg data-srcset="/images/faster-parallel-processes/bg.jpg, /images/faster-parallel-processes/bg.jpg 1.5x, /images/faster-parallel-processes/bg.jpg 2x" data-sizes=auto alt=/images/faster-parallel-processes/bg.jpg title=/images/faster-parallel-processes/bg.jpg></a></div><h1 class=single-title itemprop="name headline"><a href=/2019/01/02/faster-parallel-processes/>천만 명의 사용자에게 1분 내로 알림 보내기 (병렬프로세스의 최적화)</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2019-01-02>2019-01-02</time></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=content><p>만약 1번부터 10번까지 번호표가 있는 사람들 총 열명에게 혼자서 동일한 내용의 메일을 보낸다고 가정해보자. 그리고 메일 발송시 한번에 한명에게만 보내야 하는 제한사항이 있을때 과연 당신은 어떤식으로 보내겠는가? 이어서 읽지말고 한번 생각해보자.
아무것도 고려하지 않고 단순하게 생각한다면 1번 보내고 > 2번 보내고 &mldr; 9번 보내고 > 10번 보내는 방법이 먼저 떠오르게 된다. (for loop 1 to 10 &mldr; ) 하지만 보내야 할 사람들이 많아져서 백명, 천명 많게는 천만명에게 보내야 할 경우 방금과 같은 순차적인 방법을 사용하면 너무 늦게 발송된다는건 코드를 작성하지 않아도 알 수있는 문제&mldr; 그렇다면 어떤 방법으로 보내야 보다 빨리 보낼수 있을까?
이번 포스팅에서는 필자가 운영하고 있는 서비스에서 기존에 있던 병렬프로세스를 어떤식으로 최적화 했는지, 그래서 결국 얼마나 빨라졌는지에 대한 과정을 정리해 보고자 한다. 비단 메일 발송이나 앱 푸시 등 특정 도메인에 국한되지는 않고 전반적인 프로세스에 대해 이해를 한다면 다른 곳에서도 비슷한 방법으로 활용할 수 있을꺼라 기대 해본다.</p><hr><h2 id=상황파악-및-목표>상황파악 및 목표</h2><p>(원할한 이해를 돕기 위하여) 먼저 필자가 운영하고있는 서비스를 간략히 소개부터 해야겠다. (그렇다고 필자 혼자 다 하는건 아님^^;&mldr;)
셀럽의 방송이 시작되면 구독한 사용자에게 각 모바일 기기에 설치되어있는 앱으로 알림을 보내어 예정에 없던 깜짝 라이브 방송이나 VOD 영상 오픈을 보다 빠르게 확인할 수 있도록 제공하고 있다.
여기서, 알림이 늦게 발송되면 셀럽은 방송을 시작하고 팬들이 들어오기까지 기다려야 한다거나 반대로 팬들은 방송 시작하고 뒤늦게 방송을 보게되는 불편함이 생기게 된다. 그리고 중복으로 알림이 발송되거나 특정 사용자들에게 발송이 누락되면 안 되는 등 &ldquo;알림&rdquo; 이란 기능은 서비스에 있어서 중요한 기능 중에 하나라고 할수 있다.</p><blockquote><p>여기서 &ldquo;발송 시간"은 처음 발송작업 시작부터 마지막 사용자에 대해 사내 발송 플랫폼으로 발송 요청을 하기까지의 시간을 의미</p></blockquote><p>그리고 &ldquo;채널&rdquo; 이라는 샐럽단위의 그룹이 있는데 영상과 채널의 관계는 1:N이다. 즉, 하나의 영상을 여러 채널에 연결시킬수 있어서 하나의 영상에 대해 여러 채널들에게 연결을 시켜놓으면 채널을 구독하고있는 각각의 사용자에게 모두 알림을 발송 할수가 있게 된다.</p><p>우선, 알람이 사용자에게 전달되기까지의 큰 흐름은 다음과 같다.</p><figure><a class=lightgallery href=/images/faster-parallel-processes/push_process.jpg title=/images/faster-parallel-processes/push_process.jpg data-thumbnail=/images/faster-parallel-processes/push_process.jpg data-sub-html="<h2>알림 프로세스</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/faster-parallel-processes/push_process.jpg data-srcset="/images/faster-parallel-processes/push_process.jpg, /images/faster-parallel-processes/push_process.jpg 1.5x, /images/faster-parallel-processes/push_process.jpg 2x" data-sizes=auto alt=/images/faster-parallel-processes/push_process.jpg></a><figcaption class=image-caption>알림 프로세스</figcaption></figure><ol><li>서비스에서 보낼 대상과 보낼 정보를 조합하여</li><li>사내 푸시 발송 플랫폼인 사내 발송 플랫폼에게 전달을 하면 플랫폼에 따라 발송이 되고</li><li>최종적으로는 사용자의 모바일 기기에 노출이 됨</li></ol><p>간단하게 &ldquo;병렬로 발송하면 되지 않을까?&ldquo;라는 필자의 생각이 부끄러워질 정도로 이미 redis, rabbitMQ 를 활용해서 아래 그림처럼 병렬 프로세스로 구성되어 있었다.</p><figure><a class=lightgallery href=/images/faster-parallel-processes/legacy_structure.jpg title=/images/faster-parallel-processes/legacy_structure.jpg data-thumbnail=/images/faster-parallel-processes/legacy_structure.jpg data-sub-html="<h2>기존 구조</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/faster-parallel-processes/legacy_structure.jpg data-srcset="/images/faster-parallel-processes/legacy_structure.jpg, /images/faster-parallel-processes/legacy_structure.jpg 1.5x, /images/faster-parallel-processes/legacy_structure.jpg 2x" data-sizes=auto alt=/images/faster-parallel-processes/legacy_structure.jpg></a><figcaption class=image-caption>기존 구조</figcaption></figure><ol><li>라이브가 시작되거나 VOD가 오픈될 경우 api가 호출이 되고 다시 배치 서버에게 영상의 고유번호를 전달</li><li>전달받은 영상의 고유번호를 rabbitMQ의 수신자 조회 Queue에 produce</li><li>수신자 조회 Queue의 consumer인 수신자 조회 모듈에서 영상의 고유번호를 consume 후 아래 작업을 진행
3-1. 영상:채널 은 1:N 구조이기 때문에 여러 채널의 사용자들에게 알림을 발송할 수 있고, 영상에 연결된 채널들의 user를 db에서 가져온다.
3-2. 가져온 user를 (중복으로 알림이 발송되지 않기 위해) java set에 담고 모든 채널을 조회했다면 redis에 sorted set으로 담는다.
3-3. 적당한 크기로 분할하고 이 분할정보를 발송 Queue에 produce</li><li>발송 모듈에서 분할 정보를 consume 하고 아래 작업을 진행 (병렬처리)
4-1. redis 에서 user 모음을 가져오고
4-2. 조회한 user에 해당하는 deviceId를 db에서 가져옴</li><li>deviceId와 컨텐츠 정보를 활용하여 적절한 payload를 구성 후 사내 발송 플랫폼 에게 전달</li></ol><p>기존 구조에서 발송 시간은 서비스에서 구독자 수가 가장 많은 채널 기준으로 약 1.1천만 명에게 최종 11분 정도 소요되고 있었다. (맨 처음에 이야기 한 순차적인 방법이였다면&mldr; 훨씬더 오래 걸렸을꺼라 예상해본다&mldr;)</p></div><div class=post-footer><a href=/2019/01/02/faster-parallel-processes/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/parallel-precess/>Parallel Precess</a>,&nbsp;<a href=/tags/redis/>Redis</a>,&nbsp;<a href=/tags/rabbitmq/>RabbitMQ</a>,&nbsp;<a href=/tags/archives-2019/>Archives-2019</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><div class=featured-image-preview><a href=/2018/12/31/review-2018/><img class=lazyload src=/svg/loading.min.svg data-src=/images/review-2018/last_sun.jpg data-srcset="/images/review-2018/last_sun.jpg, /images/review-2018/last_sun.jpg 1.5x, /images/review-2018/last_sun.jpg 2x" data-sizes=auto alt=/images/review-2018/last_sun.jpg title=/images/review-2018/last_sun.jpg></a></div><h1 class=single-title itemprop="name headline"><a href=/2018/12/31/review-2018/>2018 회고 - Coder가 아닌 Programmer로</a></h1><div class=post-meta><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-publish>published on <time datetime=2018-12-31>2018-12-31</time></span>&nbsp;<span class=post-category>included in <a href=/categories/review/><i class="far fa-folder fa-fw" aria-hidden=true></i>Review</a></span></div><div class=content><p>매사에 행동하는 모든것들의 끝자락에서는 그동안 잘한것과 못한것을 다시 생각하며 잘한것은 보다 더 잘할수 있도록 하고 못한것은 왜 못했는지 그리고 어떻게 하면 못한 부분을 고칠수 있을지에 대한 시간을 갖으려고 노력해왔다. 그게 개발이 되었든 게임이 되었든 연인과의 데이트가 되었든 뭐든지. 이러한 시간들은 필자에게 큰 인사이트를 얻을 수 있게 되었고 지난 한해를 돌이켜 보자면 개인적으로 계획한 전부를 다 이뤄내지는 못했지만 나름의 많은 경험과 성과를 달성했다고 생각해본다.
이제 몇시간 뒤면 올해가 끝나고 새로운 한 해가 시작되는 이 시점에 <code>개발자로써의 회고</code>를 해보며 2018년 정리 및 2019년 목표를 다짐해보자.</p><h2 id=글쓰는-개발자가-되자-개인-블로그-운영>글쓰는 개발자가 되자. 개인 블로그 운영</h2><p>아주 오래전, 동기 형을 통해 <code>개발자가 글을 써야하는 중요성</code>에 대해 절실하게 배우게 되었고 그때부터 블로그를 운영하기 시작하였다. 그 동기형의 말에 조금 더 내 생각을 첨가하자면 글을 쓰다보면 누군가 내 글을 본다는 마음에 내가 알고있는 지식을 보다 더 깊게 공부하게 되고 그것들이 모여 내 개발 히스토리가 만들어 지며 포트폴리오 등 다양하게 활용할 수 있기에 블로그를 운영하는건 정말 좋은 선택지 였던것 같다. 실제로 그냥 구글링 해서 알게된 것과는 또 다른 배움이 있었기 때문이다.
회사 일 그리고 개인 공부를 하면서 적어도 한달에 한가지 이상은 배우게 되기 때문에 올해 초 한달에 한개 이상의 글을 쓰기로 결심하였다.(그 달의 글이 없다면 뭔가 놀았거나(?) 미친듯이 바빴거나 아니면 게을렀거나&mldr;) 블로그에 글을 쓴 내역을 그래프로 시각화 해보면 아래처럼 총 23개의 글을 작성하였고 월 평균 1.9개의 글을 작성하게 된것을 볼수 있다.</p><blockquote><p>9월달엔 팀 옮기자마자 엄청 바빴고, 11월엔 그 바쁜게 결실을 맺는 시간&mldr; 이라 핑계를&mldr; (나중에 블로깅 예정, 병렬 프로그래밍 관련)</p></blockquote><figure><a class=lightgallery href=/images/review-2018/post_count.jpg title=/images/review-2018/post_count.jpg data-thumbnail=/images/review-2018/post_count.jpg data-sub-html="<h2>월별 글 작성수</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/review-2018/post_count.jpg data-srcset="/images/review-2018/post_count.jpg, /images/review-2018/post_count.jpg 1.5x, /images/review-2018/post_count.jpg 2x" data-sizes=auto alt=/images/review-2018/post_count.jpg></a><figcaption class=image-caption>월별 글 작성수</figcaption></figure><p>위 결과만을 두고 봤을땐 많으면 많고 적으면 적다고 할 수 있는 결과지만 개인적으로는 자투리 시간을 활용해서 그간 배웠던것, 그리고 경험했지만 내것으로 만들지 못하고 보기만 하며 넘어간것들에 대해 귀찮지만 시간을 투자하고 정리했더라면 더 많은 글을 썼을것 같다는 조금 아쉬운 결과라고 생각이 든다.</p><figure><a class=lightgallery href=/images/review-2018/blog_ga.jpg title=/images/review-2018/blog_ga.jpg data-thumbnail=/images/review-2018/blog_ga.jpg data-sub-html="<h2>주 단위 PV, 누군가 내 글을 보고 있다는것에 뿌듯함</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/review-2018/blog_ga.jpg data-srcset="/images/review-2018/blog_ga.jpg, /images/review-2018/blog_ga.jpg 1.5x, /images/review-2018/blog_ga.jpg 2x" data-sizes=auto alt=/images/review-2018/blog_ga.jpg></a><figcaption class=image-caption>주 단위 PV, 누군가 내 글을 보고 있다는것에 뿌듯함</figcaption></figure><p>나름 열심히 글을 쓴 결과일까, GA를 통해 본 필자의 블로그에 유입량이 점점 늘어나는것을 보며 하나를 쓰더라도 좀더 자세히 독자의 입장에서 써야겠다고 다시한번 다짐하게 된다. 다만 글을 &ldquo;많이&rdquo; 쓰는것보다 하나를 작성하더라도 원인과 근거를 들어가며 문제를 정확히 파악하는데 집중을 해야하고, 단순 사용법 나열이 아닌 실제로 경험을 해가면서 &ldquo;내것"으로 만드는 과정이 필요하겠다.</p><h2 id=회사-팀-변경-그리고-토이-프로젝트>회사 팀 변경 그리고 토이 프로젝트</h2><p>기존에 아무것도 없던 환경에서 서버 발급부터 이런 저런 서비스에 도움이 되는 다양한 모니터링 툴을 개발하며 무사히 서비스를 오픈을 하였고, 약간의 매너리즘이 생겨날 즈음 좋은 기회가 생겨 성격이 전혀 다른 서비스를 하는 팀을 옮기게 되었다. 약간 이직과도 비슷한 느낌으로 팀을 옮기게 되었는데 처음엔 새로운 지식을 습득해야 하는 두려움도 있었고 기존 서비스에 애정이 많아서 고민이 많았지만 벌써 옮긴지 5개월이 지나고 돌이켜보면 올해 가장 잘한 일 중 하나가 아닐까하는 생각이 든다. 전 팀에선 서비스를 운영하는데 그쳤지만 지금 내가 있는 곳은 대용량 서비스를 성능측면에서, 그리고 아키텍쳐 측면에서 보다 효율적으로 개발하는데 집중을 하려는 모습들이 보이기 때문이다. 더불어 팀에 투입되자마자 필자 홀로 기존에 있던 병렬 프로세스를 개선하여 서비스적으로 약 90%의 개선효과를 볼수있었는데 이 부분은 추후 포스팅 할 예정이다.
그리고 팀을 옮기기 한두달 전 개인적인 여유시간이 많이 있었고, 다른사람들의 블로그를 보며 챙겨보고 싶은 마음에 <a href=http://daily-devblog.com target=_blank rel="noopener noreffer">토이 프로젝트</a>를 만들게 되었다. 7월 중순부터 시작했으니 이것도 어느덧 반년이 지나고 있는데 운영을 해가면서 기능을 추가하기 위해 종종 밤을 새는 등 올 한해있어 꽤 많은것을 얻을수 있었던 시간이였다. 간혹 버그가 생겨 메일이 발송 안되면 지인 또는 모르는 분들이 메일로 제보도 해주시고 &mldr; 색다른 경험이였다. 자세한 내용 및 후기는 <a href=https://taetaetae.github.io/2018/08/05/daily-dev-blog-1/ target=_blank rel="noopener noreffer">개발후기-1</a> 과 <a href=https://taetaetae.github.io/2018/08/09/daily-dev-blog-2/ target=_blank rel="noopener noreffer">개발후기-2</a>에서 확인 가능하다. (어서 3편을 쓰고 마무리를 지어야 할텐데&mldr;) 그리고 최근에는 <a href=http://daily-devblog.com/archive target=_blank rel="noopener noreffer">아카이빙</a> 기능을 만들어 과거 글을 조회할수 있도록 만들었는데 2% 부족한 느낌이다&mldr; (맘같아서는 형태소 분석을 해서 자동 필터링도 해보고 싶은데&mldr;)</p></div><div class=post-footer><a href=/2018/12/31/review-2018/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/review/>Review</a>,&nbsp;<a href=/tags/archives-2018/>Archives-2018</a></div></div></article><ul class=pagination><li class=page-item><span class=page-link><a href=/>1</a></span></li><li class=page-item><span class=page-link aria-hidden=true>&mldr;</span></li><li class=page-item><span class=page-link><a href=/page/7/>7</a></span></li><li class=page-item><span class=page-link><a href=/page/8/>8</a></span></li><li class="page-item active"><span class=page-link><a href=/page/9/>9</a></span></li><li class=page-item><span class=page-link><a href=/page/10/>10</a></span></li><li class=page-item><span class=page-link><a href=/page/11/>11</a></span></li><li class=page-item><span class=page-link aria-hidden=true>&mldr;</span></li><li class=page-item><span class=page-link><a href=/page/18/>18</a></span></li></ul></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.147.9">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2016 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://taetaetae.github.io/resume target=_blank>태태태</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:500},data:{"id-1":"Software development engineer"},lightgallery:!0,typeit:{cursorChar:"|",cursorSpeed:500,data:{"id-1":["id-1"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-86432198-1",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-86432198-1" async></script></body></html>