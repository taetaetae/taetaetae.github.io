<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Elastic Stack으로 코로나19 대시보드 만들기 - 2부 : 대시보드 - 👨‍💻꿈꾸는 태태태의 공간</title><meta name=Description content><meta property="og:title" content="Elastic Stack으로 코로나19 대시보드 만들기 - 2부 : 대시보드"><meta property="og:description" content="지난 포스팅에서는 ﻿데이터를 수급하며 전처리 과정을 거쳤고, Filebeat와 Logstash를 거쳐 Elasticsearch에 인덱싱 하는 것까지 알아보았다. 앞선 포스팅에서 이야기했지만 단순하게 데이터를 시각화 도구를 이용해서 대시보드를 만드는 게 아니라 데이터가 추가되면 만들어둔 대시보드에 자동으로 반영되는 흐름을 만들고 싶었다. 마침 파이프라인을 이틀 전에 만들었기 때문에 그동안의 빠진 데이터를 추가해야 하는 상황이다. 이 경우 Filebeat-Logstash-Elasticsearch 가 실행 중이라면 앞서 작성했던 파이썬 스크립트만 한번 실행해 주면 이틀 치 데이터가 파이프라인을 거쳐 Elasticsearch로 인덱싱이 된다. 즉, 별도로 데이터를 가져와서 재 가공하고 추가하는 다소 까다로운 작업이 미리 만들어둔 파이프라인 덕분에 한 번의 스크립트 실행으로 손쉽게 처리가 됨을 알 수 있다.
　이제는 쌓여있는 데이터를 가지고 시각화를 해볼 차례이다. ElasticStack에서는 Kibana라는 강력한 시각화 도구를 제공하는데 이번 포스팅에서는 Kibana를 이용해서 대시보드를 만드는 방법에 대해 알아보려 한다.
Visualize 　﻿Elasticsearch에 인덱싱 되어있는 데이터들은 기본으로 제공되는 REST API를 통해서 조회할 수 있고 JSON 형태로 결과가 나오기 때문에 이를 가지고 다양하게 시각화를 할 수도 있다. 하지만 Kibana에서는 데이터를 조회하고 UI로 표현하는 일련의 모든 행위를 클릭 몇 번으로 할 수 있게 해주기 때문에 전문가가 아니더라도 조금만 만져보면 누구나 만들 수 있다.
New Visualizaion!!&#34; New Visualizaion!!  　버전업이 되면서 비쥬얼라이즈를 만드는 첫 화면 또한 변화가 생겼다. 기존에는 어떤 유형의 비쥬얼라이즈를 선택할 것인지에 대해 선택하는 화면부터 나왔는데 만드는 걸 보다 편리하게 도와주는 Lens, TSVB 같은 기능들이 먼저 반겨준다. 이 기능을 통해서 만드는 방법도 괜찮지만 보다 명시적으로 만들고 싶으니 하단에 Aggregation based을 선택해서 원하는 비쥬얼라이즈의 타입을 선택해 보자. 이후 생성되어 있는 인덱스를 선택하면 본격적으로 비쥬얼라이즈를 그릴 수 있는 화면이 나오는데 대시보드 화면 기준으로 만들어야 할 항목별로 살펴보자.
전체 수 .&#34; .  　﻿확진자, 사망자, 격리 해제의 총합을 표현하려 한다. 이렇게 &lsquo;숫자&rsquo;를 표현하려 하는 경우 Metric을 활용하곤 한다. 우측에서 Aggregation 방법을 &lsquo;sum&rsquo;으로 설정하고 필드는 유형별로 각각 선택해 주자. 아래 &lsquo;Add&rsquo;버튼을 눌러 확진, 사망, 격리 해제 수를 모두 표시한 다음 저장을 눌러준다. Label을 지정하지 않으면 어떤 형태로 Aggregation을 했는지를 Label 영역에 보여주는데 그게 보기 싫다면 원하는 텍스트로 지정해 주는 것도 방법이다.
최근 수 .&#34; .  　﻿확진자, 사망자, 격리 해제의 &lsquo;최근 데이터&rsquo;를 보여주는 게 목적이다. 이 경우 Aggregation을 Top Hit으로 선택하면 필드를 선택할 수 있게 되는데 하루의 데이터가 총 18 row이기 때문에 (서울, 부산, &mldr;, 제주, 검역) 18 row 을 전부 더한 값이 하루 기준의 합계가 된다. 여기서 정렬을 날짜 기준 내림차순으로 해줘야 가장 최근 데이터의 합계가 되는 점도 신경 써야 한다.
각 타입별 합계 .&#34; .  　﻿지역별로 타입별 수를 보기 위해 Pie 타입으로 선택하여 진행한다. 타입별(예로 들어 확진이면 confirmed)로 합계를 구하기 위해 Aggregation을 &lsquo;sum&rsquo;으로 설정하면 빈 원이 나오지만 각 지역별로 차트를 잘라서 봐야 하기에 하단의 Buckets의 Add를 누르고 regieon의 필드를 Terms Aggregation 한다. 18 row의 데이터가 전부 보여야 하기에 정렬 개수를 늘리고 option 탭에서 보는 취향에 알맞게 설정값들을 바꿔준다.
타입별 추이 .&#34; .  　﻿확진, 사망, 격리 해제 중에 사망을 제외하고 나머지 둘은 데이터의 크기가 크고 변화량이 비슷하기 때문에 x축은 시간으로 설정해두고 사망은 막대로, 나머지 둘은 라인으로 한 화면에서 표현하면 이 3가지 데이터를 한눈에 보기 좋을 것 같았다. Vertical bar 을 선택하고 x축(Buckets > X-axis)은 데이터 타입인 convert_date로 설정한다. 다음으로 사망은 매일 몇 명 사망했는지 뚜렷하게 보기 위해 그냥 sum으로, 나머지 둘은 누적 합계가 더 의미 있어 보일 것 같아 Cumulative Sum으로 Aggregation을 한다."><meta property="og:type" content="article"><meta property="og:url" content="https://taetaetae.github.io/posts/make-dashboards-from-elasticstack-2/"><meta property="og:image" content="https://taetaetae.github.io/images/make-dashboards-from-elasticstack-2/logo.jpg"><meta property="article:published_time" content="2021-02-17T16:53:49+09:00"><meta property="article:modified_time" content="2021-02-17T16:53:49+09:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://taetaetae.github.io/images/make-dashboards-from-elasticstack-2/logo.jpg"><meta name=twitter:title content="Elastic Stack으로 코로나19 대시보드 만들기 - 2부 : 대시보드"><meta name=twitter:description content="지난 포스팅에서는 ﻿데이터를 수급하며 전처리 과정을 거쳤고, Filebeat와 Logstash를 거쳐 Elasticsearch에 인덱싱 하는 것까지 알아보았다. 앞선 포스팅에서 이야기했지만 단순하게 데이터를 시각화 도구를 이용해서 대시보드를 만드는 게 아니라 데이터가 추가되면 만들어둔 대시보드에 자동으로 반영되는 흐름을 만들고 싶었다. 마침 파이프라인을 이틀 전에 만들었기 때문에 그동안의 빠진 데이터를 추가해야 하는 상황이다. 이 경우 Filebeat-Logstash-Elasticsearch 가 실행 중이라면 앞서 작성했던 파이썬 스크립트만 한번 실행해 주면 이틀 치 데이터가 파이프라인을 거쳐 Elasticsearch로 인덱싱이 된다. 즉, 별도로 데이터를 가져와서 재 가공하고 추가하는 다소 까다로운 작업이 미리 만들어둔 파이프라인 덕분에 한 번의 스크립트 실행으로 손쉽게 처리가 됨을 알 수 있다.
　이제는 쌓여있는 데이터를 가지고 시각화를 해볼 차례이다. ElasticStack에서는 Kibana라는 강력한 시각화 도구를 제공하는데 이번 포스팅에서는 Kibana를 이용해서 대시보드를 만드는 방법에 대해 알아보려 한다.
Visualize 　﻿Elasticsearch에 인덱싱 되어있는 데이터들은 기본으로 제공되는 REST API를 통해서 조회할 수 있고 JSON 형태로 결과가 나오기 때문에 이를 가지고 다양하게 시각화를 할 수도 있다. 하지만 Kibana에서는 데이터를 조회하고 UI로 표현하는 일련의 모든 행위를 클릭 몇 번으로 할 수 있게 해주기 때문에 전문가가 아니더라도 조금만 만져보면 누구나 만들 수 있다.
New Visualizaion!!&#34; New Visualizaion!!  　버전업이 되면서 비쥬얼라이즈를 만드는 첫 화면 또한 변화가 생겼다. 기존에는 어떤 유형의 비쥬얼라이즈를 선택할 것인지에 대해 선택하는 화면부터 나왔는데 만드는 걸 보다 편리하게 도와주는 Lens, TSVB 같은 기능들이 먼저 반겨준다. 이 기능을 통해서 만드는 방법도 괜찮지만 보다 명시적으로 만들고 싶으니 하단에 Aggregation based을 선택해서 원하는 비쥬얼라이즈의 타입을 선택해 보자. 이후 생성되어 있는 인덱스를 선택하면 본격적으로 비쥬얼라이즈를 그릴 수 있는 화면이 나오는데 대시보드 화면 기준으로 만들어야 할 항목별로 살펴보자.
전체 수 .&#34; .  　﻿확진자, 사망자, 격리 해제의 총합을 표현하려 한다. 이렇게 &lsquo;숫자&rsquo;를 표현하려 하는 경우 Metric을 활용하곤 한다. 우측에서 Aggregation 방법을 &lsquo;sum&rsquo;으로 설정하고 필드는 유형별로 각각 선택해 주자. 아래 &lsquo;Add&rsquo;버튼을 눌러 확진, 사망, 격리 해제 수를 모두 표시한 다음 저장을 눌러준다. Label을 지정하지 않으면 어떤 형태로 Aggregation을 했는지를 Label 영역에 보여주는데 그게 보기 싫다면 원하는 텍스트로 지정해 주는 것도 방법이다.
최근 수 .&#34; .  　﻿확진자, 사망자, 격리 해제의 &lsquo;최근 데이터&rsquo;를 보여주는 게 목적이다. 이 경우 Aggregation을 Top Hit으로 선택하면 필드를 선택할 수 있게 되는데 하루의 데이터가 총 18 row이기 때문에 (서울, 부산, &mldr;, 제주, 검역) 18 row 을 전부 더한 값이 하루 기준의 합계가 된다. 여기서 정렬을 날짜 기준 내림차순으로 해줘야 가장 최근 데이터의 합계가 되는 점도 신경 써야 한다.
각 타입별 합계 .&#34; .  　﻿지역별로 타입별 수를 보기 위해 Pie 타입으로 선택하여 진행한다. 타입별(예로 들어 확진이면 confirmed)로 합계를 구하기 위해 Aggregation을 &lsquo;sum&rsquo;으로 설정하면 빈 원이 나오지만 각 지역별로 차트를 잘라서 봐야 하기에 하단의 Buckets의 Add를 누르고 regieon의 필드를 Terms Aggregation 한다. 18 row의 데이터가 전부 보여야 하기에 정렬 개수를 늘리고 option 탭에서 보는 취향에 알맞게 설정값들을 바꿔준다.
타입별 추이 .&#34; .  　﻿확진, 사망, 격리 해제 중에 사망을 제외하고 나머지 둘은 데이터의 크기가 크고 변화량이 비슷하기 때문에 x축은 시간으로 설정해두고 사망은 막대로, 나머지 둘은 라인으로 한 화면에서 표현하면 이 3가지 데이터를 한눈에 보기 좋을 것 같았다. Vertical bar 을 선택하고 x축(Buckets > X-axis)은 데이터 타입인 convert_date로 설정한다. 다음으로 사망은 매일 몇 명 사망했는지 뚜렷하게 보기 위해 그냥 sum으로, 나머지 둘은 누적 합계가 더 의미 있어 보일 것 같아 Cumulative Sum으로 Aggregation을 한다."><meta name=application-name content="👨‍💻꿈꾸는 태태태의 공간"><meta name=apple-mobile-web-app-title content="👨‍💻꿈꾸는 태태태의 공간"><meta name=naver-site-verification content="2d1cdbb963ba178aa7cbf58500afc668cae1e645"><meta name=google-site-verification content="vvFCdv0-GuQhEWG8vtNJfA7YSY2HYQ1hpHh9P-a6Pv8"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://taetaetae.github.io/posts/make-dashboards-from-elasticstack-2/><link rel=prev href=https://taetaetae.github.io/posts/make-dashboards-from-elasticstack-1/><link rel=next href=https://taetaetae.github.io/posts/a-good-developer-in-terms-of-mentoring/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Elastic Stack으로 코로나19 대시보드 만들기 - 2부 : 대시보드","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/taetaetae.github.io\/posts\/make-dashboards-from-elasticstack-2\/"},"genre":"posts","keywords":"elasticsearch, logstash, kibana, filebeat, dashboard, archives-2021","wordcount":847,"url":"https:\/\/taetaetae.github.io\/posts\/make-dashboards-from-elasticstack-2\/","datePublished":"2021-02-17T16:53:49+09:00","dateModified":"2021-02-17T16:53:49+09:00","publisher":{"@type":"Organization","name":"태태태"},"author":{"@type":"Person","name":"태태태"},"description":""}</script></head><body header-desktop=auto header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="👨‍💻꿈꾸는 태태태의 공간">👨‍💻꿈꾸는 태태태의 공간</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="👨‍💻꿈꾸는 태태태의 공간">👨‍💻꿈꾸는 태태태의 공간</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/>Posts</a><a class=menu-item href=/tags/>Tags</a><a class=menu-item href=/categories/>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:inline-block;width:260px;height:600px data-ad-client=ca-pub-5788330009690816 data-ad-slot=2248955907></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><article class="page single"><h1 class="single-title animated flipInX">Elastic Stack으로 코로나19 대시보드 만들기 - 2부 : 대시보드</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>태태태</a></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw"></i>Tech</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-02-17>2021-02-17</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;847 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;4 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/images/make-dashboards-from-elasticstack-2/logo.jpg data-srcset="/images/make-dashboards-from-elasticstack-2/logo.jpg, /images/make-dashboards-from-elasticstack-2/logo.jpg 1.5x, /images/make-dashboards-from-elasticstack-2/logo.jpg 2x" data-sizes=auto alt=/images/make-dashboards-from-elasticstack-2/logo.jpg title=/images/make-dashboards-from-elasticstack-2/logo.jpg></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#visualize>Visualize</a><ul><li><a href=#전체-수>전체 수</a></li><li><a href=#최근-수>최근 수</a></li><li><a href=#각-타입별-합계>각 타입별 합계</a></li><li><a href=#타입별-추이>타입별 추이</a></li><li><a href=#확진자-추이>확진자 추이</a></li></ul></li><li><a href=#dashboard>Dashboard</a></li><li><a href=#마치며>마치며</a></li></ul></nav></div></div><div class=content id=content><p>　<a href=/posts/make-dashboards-from-elasticstack-1/ rel>지난 포스팅</a>에서는 ﻿데이터를 수급하며 전처리 과정을 거쳤고, Filebeat와 Logstash를 거쳐 Elasticsearch에 인덱싱 하는 것까지 알아보았다. 앞선 포스팅에서 이야기했지만 단순하게 데이터를 시각화 도구를 이용해서 대시보드를 만드는 게 아니라 데이터가 추가되면 만들어둔 대시보드에 자동으로 반영되는 흐름을 만들고 싶었다. 마침 파이프라인을 이틀 전에 만들었기 때문에 그동안의 빠진 데이터를 추가해야 하는 상황이다. 이 경우 Filebeat-Logstash-Elasticsearch 가 실행 중이라면 앞서 작성했던 파이썬 스크립트만 한번 실행해 주면 이틀 치 데이터가 파이프라인을 거쳐 Elasticsearch로 인덱싱이 된다. 즉, 별도로 데이터를 가져와서 재 가공하고 추가하는 다소 까다로운 작업이 미리 만들어둔 파이프라인 덕분에 한 번의 스크립트 실행으로 손쉽게 처리가 됨을 알 수 있다.</p><p>　이제는 쌓여있는 데이터를 가지고 시각화를 해볼 차례이다. ElasticStack에서는 Kibana라는 강력한 시각화 도구를 제공하는데 이번 포스팅에서는 Kibana를 이용해서 대시보드를 만드는 방법에 대해 알아보려 한다.</p><h2 id=visualize>Visualize</h2><p>　﻿Elasticsearch에 인덱싱 되어있는 데이터들은 기본으로 제공되는 REST API를 통해서 조회할 수 있고 JSON 형태로 결과가 나오기 때문에 이를 가지고 다양하게 시각화를 할 수도 있다. 하지만 Kibana에서는 데이터를 조회하고 UI로 표현하는 일련의 모든 행위를 클릭 몇 번으로 할 수 있게 해주기 때문에 전문가가 아니더라도 조금만 만져보면 누구나 만들 수 있다.</p><figure><a class=lightgallery href=/images/make-dashboards-from-elasticstack-2/visualize-main.jpg title=/images/make-dashboards-from-elasticstack-2/visualize-main.jpg data-thumbnail=/images/make-dashboards-from-elasticstack-2/visualize-main.jpg data-sub-html="<h2>New Visualizaion!!</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/make-dashboards-from-elasticstack-2/visualize-main.jpg data-srcset="/images/make-dashboards-from-elasticstack-2/visualize-main.jpg, /images/make-dashboards-from-elasticstack-2/visualize-main.jpg 1.5x, /images/make-dashboards-from-elasticstack-2/visualize-main.jpg 2x" data-sizes=auto alt=/images/make-dashboards-from-elasticstack-2/visualize-main.jpg width=80%></a><figcaption class=image-caption>New Visualizaion!!</figcaption></figure><p>　버전업이 되면서 비쥬얼라이즈를 만드는 첫 화면 또한 변화가 생겼다. 기존에는 어떤 유형의 비쥬얼라이즈를 선택할 것인지에 대해 선택하는 화면부터 나왔는데 만드는 걸 보다 편리하게 도와주는 <code>Lens</code>, <code>TSVB</code> 같은 기능들이 먼저 반겨준다. 이 기능을 통해서 만드는 방법도 괜찮지만 보다 명시적으로 만들고 싶으니 하단에 <code>Aggregation based</code>을 선택해서 원하는 비쥬얼라이즈의 타입을 선택해 보자. 이후 생성되어 있는 인덱스를 선택하면 본격적으로 비쥬얼라이즈를 그릴 수 있는 화면이 나오는데 대시보드 화면 기준으로 만들어야 할 항목별로 살펴보자.</p><h3 id=전체-수>전체 수</h3><figure><a class=lightgallery href=/images/make-dashboards-from-elasticstack-2/1.jpg title=/images/make-dashboards-from-elasticstack-2/1.jpg data-thumbnail=/images/make-dashboards-from-elasticstack-2/1.jpg data-sub-html="<h2>.</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/make-dashboards-from-elasticstack-2/1.jpg data-srcset="/images/make-dashboards-from-elasticstack-2/1.jpg, /images/make-dashboards-from-elasticstack-2/1.jpg 1.5x, /images/make-dashboards-from-elasticstack-2/1.jpg 2x" data-sizes=auto alt=/images/make-dashboards-from-elasticstack-2/1.jpg width=80%></a><figcaption class=image-caption>.</figcaption></figure><p>　﻿확진자, 사망자, 격리 해제의 총합을 표현하려 한다. 이렇게 &lsquo;숫자&rsquo;를 표현하려 하는 경우 <code>Metric</code>을 활용하곤 한다. 우측에서 Aggregation 방법을 &lsquo;sum&rsquo;으로 설정하고 필드는 유형별로 각각 선택해 주자. 아래 &lsquo;Add&rsquo;버튼을 눌러 확진, 사망, 격리 해제 수를 모두 표시한 다음 저장을 눌러준다. Label을 지정하지 않으면 어떤 형태로 Aggregation을 했는지를 Label 영역에 보여주는데 그게 보기 싫다면 원하는 텍스트로 지정해 주는 것도 방법이다.</p><h3 id=최근-수>최근 수</h3><figure><a class=lightgallery href=/images/make-dashboards-from-elasticstack-2/2.jpg title=/images/make-dashboards-from-elasticstack-2/2.jpg data-thumbnail=/images/make-dashboards-from-elasticstack-2/2.jpg data-sub-html="<h2>.</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/make-dashboards-from-elasticstack-2/2.jpg data-srcset="/images/make-dashboards-from-elasticstack-2/2.jpg, /images/make-dashboards-from-elasticstack-2/2.jpg 1.5x, /images/make-dashboards-from-elasticstack-2/2.jpg 2x" data-sizes=auto alt=/images/make-dashboards-from-elasticstack-2/2.jpg width=80%></a><figcaption class=image-caption>.</figcaption></figure><p>　﻿확진자, 사망자, 격리 해제의 &lsquo;최근 데이터&rsquo;를 보여주는 게 목적이다. 이 경우 Aggregation을 Top Hit으로 선택하면 필드를 선택할 수 있게 되는데 하루의 데이터가 총 18 row이기 때문에 (서울, 부산, &mldr;, 제주, 검역) 18 row 을 전부 더한 값이 하루 기준의 합계가 된다. 여기서 정렬을 날짜 기준 내림차순으로 해줘야 가장 최근 데이터의 합계가 되는 점도 신경 써야 한다.</p><h3 id=각-타입별-합계>각 타입별 합계</h3><figure><a class=lightgallery href=/images/make-dashboards-from-elasticstack-2/3.jpg title=/images/make-dashboards-from-elasticstack-2/3.jpg data-thumbnail=/images/make-dashboards-from-elasticstack-2/3.jpg data-sub-html="<h2>.</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/make-dashboards-from-elasticstack-2/3.jpg data-srcset="/images/make-dashboards-from-elasticstack-2/3.jpg, /images/make-dashboards-from-elasticstack-2/3.jpg 1.5x, /images/make-dashboards-from-elasticstack-2/3.jpg 2x" data-sizes=auto alt=/images/make-dashboards-from-elasticstack-2/3.jpg width=80%></a><figcaption class=image-caption>.</figcaption></figure><p>　﻿지역별로 타입별 수를 보기 위해 <code>Pie</code> 타입으로 선택하여 진행한다. 타입별(예로 들어 확진이면 confirmed)로 합계를 구하기 위해 Aggregation을 &lsquo;sum&rsquo;으로 설정하면 빈 원이 나오지만 각 지역별로 차트를 잘라서 봐야 하기에 하단의 Buckets의 Add를 누르고 regieon의 필드를 Terms Aggregation 한다. 18 row의 데이터가 전부 보여야 하기에 정렬 개수를 늘리고 option 탭에서 보는 취향에 알맞게 설정값들을 바꿔준다.</p><h3 id=타입별-추이>타입별 추이</h3><figure><a class=lightgallery href=/images/make-dashboards-from-elasticstack-2/4.jpg title=/images/make-dashboards-from-elasticstack-2/4.jpg data-thumbnail=/images/make-dashboards-from-elasticstack-2/4.jpg data-sub-html="<h2>.</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/make-dashboards-from-elasticstack-2/4.jpg data-srcset="/images/make-dashboards-from-elasticstack-2/4.jpg, /images/make-dashboards-from-elasticstack-2/4.jpg 1.5x, /images/make-dashboards-from-elasticstack-2/4.jpg 2x" data-sizes=auto alt=/images/make-dashboards-from-elasticstack-2/4.jpg width=80%></a><figcaption class=image-caption>.</figcaption></figure><p>　﻿확진, 사망, 격리 해제 중에 사망을 제외하고 나머지 둘은 데이터의 크기가 크고 변화량이 비슷하기 때문에 x축은 시간으로 설정해두고 사망은 막대로, 나머지 둘은 라인으로 한 화면에서 표현하면 이 3가지 데이터를 한눈에 보기 좋을 것 같았다. <code>Vertical bar</code> 을 선택하고 x축(Buckets > X-axis)은 데이터 타입인 convert_date로 설정한다. 다음으로 사망은 매일 몇 명 사망했는지 뚜렷하게 보기 위해 그냥 sum으로, 나머지 둘은 누적 합계가 더 의미 있어 보일 것 같아 Cumulative Sum으로 Aggregation을 한다. 한 화면에서 3가지의 데이터를 보여주기엔 다소 y 축의 크기가 맞지 않으므로 확진, 격리 해제를 별도의 y 축(Y-axes)으로 &lsquo;Metrics & axes&rsquo;탭에서 설정해 준다. 다음으로 각 항목의 범례를 위로 표시하여 보다 보기 편하게 배치한다.</p><h3 id=확진자-추이>확진자 추이</h3><figure><a class=lightgallery href=/images/make-dashboards-from-elasticstack-2/5.jpg title=/images/make-dashboards-from-elasticstack-2/5.jpg data-thumbnail=/images/make-dashboards-from-elasticstack-2/5.jpg data-sub-html="<h2>.</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/make-dashboards-from-elasticstack-2/5.jpg data-srcset="/images/make-dashboards-from-elasticstack-2/5.jpg, /images/make-dashboards-from-elasticstack-2/5.jpg 1.5x, /images/make-dashboards-from-elasticstack-2/5.jpg 2x" data-sizes=auto alt=/images/make-dashboards-from-elasticstack-2/5.jpg width=80%></a><figcaption class=image-caption>.</figcaption></figure><p>　﻿시간의 흐름에 따라 확진자가 얼마나 늘었는지, 더불어 그 안에서도 어떤 지역에서 많이 발생했는지를 한눈에 보고자 한다. 위와 동일하게 <code>Vertical bar</code>을 선택하고 x축에는 시간의 흐름을 보기 위해 convert_date을 가지고 Date Histogram Aggregation을 설정한다. 다음으로 y 축은 확진자 수를 sum 하고 (max를 해도 무방, 하루에 데이터가 하나기에 큰 의미가 없다.) 마지막으로 지역별로 하루의 막대를 쪼개야 하기에 Buckets를 추가로 만들어 regieon 기준으로 Terms Aggregation 을 한다. 그렇게 해놓고 보면 코로나19 바이러스가 처음 발생했을 때 대구에서 많이 발생한 것을 확인할 수 있고 그 이후에는 대부분 인구 분포가 많은 지역 순서로 확진자가 발생한 것을 알 수 있다.</p><h2 id=dashboard>Dashboard</h2><p>　﻿하나의 대시보드는 미리 만들어둔 비쥬얼라이즈를 조합하여 만들어진다. 각 비쥬얼라이즈의 크기나 위치 또한 자유롭게 설정할 수 있는 것이 가장 큰 장점이라 생각한다. 그럼 위에서 만들었던 비쥬얼라이즈를 가지고 배치를 해보자. &lsquo;Add from libray&rsquo;을 누르면 위에서 만든 비쥬얼라이즈를 선택하는 화면이 뜨고 크기를 조절하고 적절하게 위치를 조정해서 입맛에 맞는 대시보드를 만들어 보자.</p><figure><a class=lightgallery href=/images/make-dashboards-from-elasticstack-2/6.jpg title=/images/make-dashboards-from-elasticstack-2/6.jpg data-thumbnail=/images/make-dashboards-from-elasticstack-2/6.jpg data-sub-html="<h2>우측에서 비쥬얼라이즈를 선택!</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/make-dashboards-from-elasticstack-2/6.jpg data-srcset="/images/make-dashboards-from-elasticstack-2/6.jpg, /images/make-dashboards-from-elasticstack-2/6.jpg 1.5x, /images/make-dashboards-from-elasticstack-2/6.jpg 2x" data-sizes=auto alt=/images/make-dashboards-from-elasticstack-2/6.jpg width=80%></a><figcaption class=image-caption>우측에서 비쥬얼라이즈를 선택!</figcaption></figure><figure><a class=lightgallery href=/images/make-dashboards-from-elasticstack-2/8.jpg title=/images/make-dashboards-from-elasticstack-2/8.jpg data-thumbnail=/images/make-dashboards-from-elasticstack-2/8.jpg data-sub-html="<h2>대구는 처음에 확진자가 많이 발생했고 지금은 그에 비해 적다.</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/make-dashboards-from-elasticstack-2/8.jpg data-srcset="/images/make-dashboards-from-elasticstack-2/8.jpg, /images/make-dashboards-from-elasticstack-2/8.jpg 1.5x, /images/make-dashboards-from-elasticstack-2/8.jpg 2x" data-sizes=auto alt=/images/make-dashboards-from-elasticstack-2/8.jpg width=80%></a><figcaption class=image-caption>대구는 처음에 확진자가 많이 발생했고 지금은 그에 비해 적다.</figcaption></figure><figure><a class=lightgallery href=/images/make-dashboards-from-elasticstack-2/9.jpg title=/images/make-dashboards-from-elasticstack-2/9.jpg data-thumbnail=/images/make-dashboards-from-elasticstack-2/9.jpg data-sub-html="<h2>조회 날짜를 조정해서 볼 수 있다.</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/make-dashboards-from-elasticstack-2/9.jpg data-srcset="/images/make-dashboards-from-elasticstack-2/9.jpg, /images/make-dashboards-from-elasticstack-2/9.jpg 1.5x, /images/make-dashboards-from-elasticstack-2/9.jpg 2x" data-sizes=auto alt=/images/make-dashboards-from-elasticstack-2/9.jpg width=80%></a><figcaption class=image-caption>조회 날짜를 조정해서 볼 수 있다.</figcaption></figure><p>　Kibana로 만든 대시보드가 정말 강력한 부분이 이 상태에서 특정 지역의 상태를 보고 싶을 경우 범례에 있는 지역을 선택만 하면 손쉽게 화면이 바뀐다는 점이다. 또한 조회시간을 조절하여 집중으로 볼 수도 있다. 이러한 기능을 처음부터 다 만들어야지 생각을 하면 배보다 배꼽이 커지는 건 당연한 소리인 것 같다.</p><h2 id=마치며>마치며</h2><p>　﻿필자는 이러한 기능을 활용하여 실무에서 데이터의 전체 흐름을 한눈에 볼 수 있는 대시보드도 만들어 보았고, 날짜나 필드를 조합하여 데이터를 조회해야 하는 어드민을 직접 구현하지 않고 위와 비슷한 구성으로 만들어 개발 공수를 엄청나게 절약한 경험이 있다. &lsquo;ElasticStack이 짱이에요&rsquo; 라는 말을 하고 싶은 건 아니다. 다양한 오픈소스를 적절하게 활용하면 적은 공수로 엄청난 효과를 누릴 수 있다는 장점이 있음을 말하고 싶다. 우리가 하고자 하는 건 데이터 분석이지 데이터를 어떻게 저장하고 시각화를 어떻게 해야 하는 건 둘째 문제 아니던가.</p><figure><a class=lightgallery href=/images/make-dashboards-from-elasticstack-2/7.jpg title=/images/make-dashboards-from-elasticstack-2/7.jpg data-thumbnail=/images/make-dashboards-from-elasticstack-2/7.jpg data-sub-html="<h2>아직 위험하다!</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/make-dashboards-from-elasticstack-2/7.jpg data-srcset="/images/make-dashboards-from-elasticstack-2/7.jpg, /images/make-dashboards-from-elasticstack-2/7.jpg 1.5x, /images/make-dashboards-from-elasticstack-2/7.jpg 2x" data-sizes=auto alt=/images/make-dashboards-from-elasticstack-2/7.jpg width=80%></a><figcaption class=image-caption>아직 위험하다!</figcaption></figure><p>끝으로, 코로나19 바이러스가 하루빨리 종식되기를 간절히 바라며 어디 나가지 말고 집에서 필자처럼 대시보드를 만들고 추이를 지켜보는 건 어떨까&mldr;</p></div><center><style>.bmc-button img{width:27px!important;margin-bottom:1px!important;box-shadow:none!important;border:none!important;vertical-align:middle!important}.bmc-button{line-height:29px!important;height:30px!important;text-decoration:none!important;display:inline-flex!important;color:#000!important;background-color:#fd0!important;border-radius:3px!important;border:1px solid transparent!important;padding:1px 9px!important;font-size:22px!important;letter-spacing:.6px!important;box-shadow:0 1px 2px rgba(190,190,190,.5)!important;-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;margin:0 auto!important;font-family:cookie,cursive!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;-o-transition:.3s all linear!important;-webkit-transition:.3s all linear!important;-moz-transition:.3s all linear!important;-ms-transition:.3s all linear!important;transition:.3s all linear!important}.bmc-button:hover,.bmc-button:active,.bmc-button:focus{-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;text-decoration:none!important;box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;opacity:.85!important;color:#000!important}</style><link href="https://fonts.googleapis.com/css?family=Cookie" rel=stylesheet><center><br><a class=bmc-button target=_blank href=https://www.buymeacoffee.com/taetaetae><img src=https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg alt="Buy me a coffee"><span style=margin-left:5px>Buy me a coffee</span></a>
<a href=https://bit.ly/ddbSupport target=_blank><img src=https://i.imgur.com/peaYpjh.png style=height:28px></a></center><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-02-17</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://taetaetae.github.io/posts/make-dashboards-from-elasticstack-2/ data-title="Elastic Stack으로 코로나19 대시보드 만들기 - 2부 : 대시보드" data-hashtags=elasticsearch,logstash,kibana,filebeat,dashboard,archives-2021><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://taetaetae.github.io/posts/make-dashboards-from-elasticstack-2/ data-hashtag=elasticsearch><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://taetaetae.github.io/posts/make-dashboards-from-elasticstack-2/><i class="fab fa-linkedin fa-fw"></i></a><a href=javascript:void(0); title="Share on Blogger" data-sharer=blogger data-url=https://taetaetae.github.io/posts/make-dashboards-from-elasticstack-2/ data-title="Elastic Stack으로 코로나19 대시보드 만들기 - 2부 : 대시보드" data-description><i class="fab fa-blogger fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/elasticsearch/>elasticsearch</a>,&nbsp;<a href=/tags/logstash/>logstash</a>,&nbsp;<a href=/tags/kibana/>kibana</a>,&nbsp;<a href=/tags/filebeat/>filebeat</a>,&nbsp;<a href=/tags/dashboard/>dashboard</a>,&nbsp;<a href=/tags/archives-2021/>archives-2021</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/make-dashboards-from-elasticstack-1/ class=prev rel=prev title="Elastic Stack으로 코로나19 대시보드 만들기 - 1부 : 파이프라인 구성"><i class="fas fa-angle-left fa-fw"></i>Elastic Stack으로 코로나19 대시보드 만들기 - 1부 : 파이프라인 구성</a>
<a href=/posts/a-good-developer-in-terms-of-mentoring/ class=next rel=next title="그런 개발자로 괜찮은가 - '멘토링' 편">그런 개발자로 괜찮은가 - '멘토링' 편<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=utterances></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.74.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i>LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2016 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://taetaetae.github.io/resume target=_blank>태태태</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":500},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"Comment","lightTheme":"github-light","repo":"taetaetae/blog-comment"}},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true}};</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','UA-86432198-1',{'anonymize_ip':true});</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-86432198-1" async></script></body></html>