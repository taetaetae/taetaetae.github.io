<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>oracle - Tag - ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</title><link>https://taetaetae.github.io/tags/oracle/</link><description>oracle - Tag - ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Tue, 04 Apr 2017 11:41:28 +0000</lastBuildDate><atom:link href="https://taetaetae.github.io/tags/oracle/" rel="self" type="application/rss+xml"/><item><title>mybatis insert/update ì¿¼ë¦¬ì‹¤í–‰í›„ ê²°ê³¼ ê°€ì ¸ì˜¤ê¸°</title><link>https://taetaetae.github.io/2017/04/04/mybatis-use-generated-keys/</link><pubDate>Tue, 04 Apr 2017 11:41:28 +0000</pubDate><author>Author</author><guid>https://taetaetae.github.io/2017/04/04/mybatis-use-generated-keys/</guid><description><![CDATA[<div class="featured-image">
                <img src="/images/mybatis-useGeneratedKeys/mybatis.png" referrerpolicy="no-referrer">
            </div>Selectë¬¸ì´ ì•„ë‹Œ ë‹¤ë¥¸ SQL Query(insert, update ë“±) ë¥¼ ì‹¤í–‰í•˜ê³ ì„œ ê²°ê³¼ë¥¼ ë´ì•¼í•˜ëŠ” ìƒí™©ì´ ìƒê¸´ë‹¤. ì •í™•íˆ ì˜ ìˆ˜í–‰ë˜ì—ˆë‚˜ì— ëŒ€í•œ í™•ì¸. ì–´ë–»ê²Œ ì¿¼ë¦¬ê°€ ì˜ ìˆ˜í–‰ë˜ì—ˆë‚˜ë¥¼ í™•ì¸í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. â€» ì°¸ê³  url : http://www.mybatis.org/mybatis-3/ko/sqlmap-xml.html
useGeneratedKeys, keyProperty ì˜µì…˜ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ê°€ ìë™ìƒì„±í‚¤ë¥¼ ì§€ì›í•œë‹¤ë©´(mySql ê°™ì€) í•´ë‹¹ì˜µì…˜ì„ ì´ìš©í•´ ê²°ê³¼ë¥¼ ë¦¬í„´ ë°›ì„ìˆ˜ ìˆë‹¤. ì˜ˆë¡œë“¤ì–´ íŒŒë¼ë¯¸í„°ë¡œ ì•„ë˜ ëª¨ë¸ê°ì²´ë¥¼ ë„˜ê¸´ë‹¤ê³  ê°€ì •í•˜ê³ 
public Student { int id; String name; String email; Date regist_date; } ì•„ë˜ mybatis êµ¬ë¬¸ìœ¼ë¡œ insertë¥¼ ì‹œë„í•˜ê²Œë˜ë©´, íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸´ Student ê°ì²´ì˜ idê°’ì— insert í–ˆì„ë•Œì˜ keyê°’(id)ì´ ë“¤ì–´ì˜¤ê²Œ ëœë‹¤.
Student student = new Student(); student.setName(&#39;bla&#39;); student.setEmail(&#39;bla@naver.com&#39;); mapper.insertStudents(student); // ì¿¼ë¦¬ì‹¤í–‰ student.getId(); // ì¶”ì¶œ ê°€ëŠ¥ &lt;insert id=&#34;insertStudents&#34; useGeneratedKeys=&#34;true&#34; keyProperty=&#34;id&#34; parameterType=&#34;Student&#34;&gt; insert into Students ( name, email ) values ( #{name}, #{email} ) &lt;/insert&gt; selectKey ì˜µì…˜ Oracle ê°™ì€ ê²½ìš°ëŠ” Auto Increment ê°€ ì—†ê³  Sequenceë¥¼ ì‚¬ìš©í•´ì•¼ë§Œ í•˜ê¸° ë•Œë¬¸ì— ìœ„ ì˜µì…˜ì„ ì‚¬ìš©í• ìˆ˜ê°€ ì—†ë‹¤. í•˜ì§€ë§Œ ë‹¤ë¥¸ ìš°íšŒì ì¸(?) ë°©ë²•ìœ¼ë¡œ ìœ„ì™€ê°™ì€ íš¨ê³¼ë¥¼ ë³¼ìˆ˜ê°€ ìˆë‹¤. íŒŒë¼ë¯¸í„°ì˜ ëª¨ë¸ì´ë‚˜ javaêµ¬ë¬¸ì€ ìœ„ì™€ ë™ì¼í•˜ê³  xml ì¿¼ë¦¬ ë¶€ë¶„ë§Œ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•´ì£¼ë©´ ëœë‹¤.
&lt;insert id=&#34;insertStudents&#34; parameterType=&#34;Student&#34;&gt; &lt;selectKey keyProperty=&#34;id&#34; resultType=&#34;int&#34; order=&#34;BEFORE&#34;&gt; select SEQ_ID.nexyval FROM DUAL &lt;/selectKey&gt; insert into Students (id, name , email) values (#{id}, #{name}, #{email}) &lt;/insert&gt; ìœ„ì™€ê°™ì€ ì½”ë“œì—ì„œ ì¿¼ë¦¬ê°€ ì‹¤í–‰ë˜ê¸° ì „ì— idê°’ì— Sequenceì— ì˜í•´ ê°’ì„ ì…‹íŒ…í•˜ê²Œ ë˜ê³ , ìë™ì ìœ¼ë¡œ í•´ë‹¹ ê°’ì„ Studentì˜ idì— setí•˜ê²Œ ë˜ì„œ ë™ì¼í•œ ê²°ê³¼ë¥¼ ë³¼ìˆ˜ê°€ ìˆë‹¤.
í•­ìƒ í…Œì´ë¸”ì˜ keyê°’ì—ë§Œ í•´ë‹¹í•˜ëŠ”ê²ƒì´ ì•„ë‹ˆë‹¤. keyê°’ê³¼ëŠ” ì „í˜€ ìƒê´€ì—†ëŠ” ê°’ë„ selectKey êµ¬ë¬¸ìœ¼ë¡œ ë¦¬í„´í• ìˆ˜ê°€ ìˆëŠ”ë° orderì˜µì…˜ì„ AFTERë¡œ ì£¼ê³  ë¦¬í„´í•˜ê³ ì í•˜ëŠ” ê°’ì„ ëª…ì‹œí•´ì£¼ë©´ ëœë‹¤. ì•„ë˜ ì½”ë“œì—ì„œëŠ” ì…ë ¥í• ì‹œ idê°’ì„ Sequenceì—ì„œ ê°€ì ¸ì˜¤ëŠ”ê²Œ ì•„ë‹ˆë¼ ìˆ˜ë™ìœ¼ë¡œ ë„£ì–´ì£¼ê³ , ì…ë ¥í–ˆë˜ idì— ë§ëŠ” regist_date ê°’ì„ ë¦¬í„´ë°›ì•„ ìœ„ì—ì„œì²˜ëŸ¼ ë™ì¼í•˜ê²Œ ê°’ë¥¼ ê°€ì ¸ì˜¬ìˆ˜ ìˆë‹¤.
&lt;insert id=&#34;insertStudents&#34; parameterType=&#34;Student&#34;&gt; &lt;selectKey keyProperty=&#34;regist_date&#34; resultType=&#34;java.util.Date&#34; order=&#34;AFTER&#34;&gt; select regist_date FROM students WHERE id = #{id} &lt;/selectKey&gt; insert into Students (id, name , email, regist_date) values (#{id}, #{name}, #{email}, syadate) &lt;/insert&gt; ]]></description></item><item><title>Oracle + Mybatis í™˜ê²½ì—ì„œì˜ Date ë‹¤ë£¨ê¸°</title><link>https://taetaetae.github.io/2017/03/23/oracle-mybatis-date/</link><pubDate>Thu, 23 Mar 2017 11:16:05 +0000</pubDate><author>Author</author><guid>https://taetaetae.github.io/2017/03/23/oracle-mybatis-date/</guid><description><![CDATA[<div class="featured-image">
                <img src="/images/oracle-mybatis-date/oracle_mybatis_date.png" referrerpolicy="no-referrer">
            </div>ìƒí™©  Oracle, Java 8, mybatis3 í™˜ê²½ Dateì»¬ëŸ¼ì— ë°ì´í„°ê°€ ìˆëŠ”ë° ì´ë¥¼ select queryë¡œ ì¡°íšŒí•˜ì—¬ Modelì— ë°”ì¸ë”© ì‹œí‚¤ê³ ì í•¨.   ì¿¼ë¦¬ì— ì•„ë¬´ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ì§€ ì•Šê³  Date í˜•íƒœë¡œ Modelì— ë°”ì¸ë”©ì„ í•˜ë©´ ì‹œë¶„ì´ˆê°€ ì—†ì–´ì§„ 2017-01-01 00:00:00 í˜•íƒœë¡œ ë‚¨ê²Œë¨ ê·¸ë˜ì„œ ì•„ë˜ì²˜ëŸ¼ ì¿¼ë¦¬ ì‘ì„±í•  ë•Œë§ˆë‹¤ TO_CHARë¥¼ ì‚¬ìš©í•´ì„œ í¬ë§·ì— ë§ì¶”ì–´ í˜•ë³€í™˜ì„ ì‹œí‚¤ê³  Date ë˜ëŠ” Stringìœ¼ë¡œ Modelì— ë°”ì¸ë”© í•˜ê³¤ í–ˆìŒ.  SELECT TO_CHAR(reg_ymdt, &#39;YYYY-MM-DD HH24:MI:SS&#39;) AS registDate FROM ...  ì´ë ‡ê²Œ í•˜ë‹¤ë³´ë‹ˆ query ë§Œë“¤ë•Œë§ˆë‹¤ í˜•ë³€í™˜í•˜ëŠ” ì¿¼ë¦¬ë¥¼ ë§Œë“¤ì–´ì¤˜ì•¼í•˜ê³ , ìì¹« í¬ë§·í˜•ì‹ì„ ë‹¤ë¥´ê²Œ ì ìœ¼ë©´ ì—‰ëš±í•œ ê²°ê³¼ë¥¼ ì´ˆë˜í•˜ê±°ë‚˜, Dateí˜•ì„ ê·¸ëŒ€ë¡œ ë°›ì•„ ì‚¬ìš©í•´ì•¼í•˜ëŠ” ìƒí™©ì—ì„œëŠ” ë‹¤ì‹œ í˜•ë³€í™˜í•˜ëŠ” ê³¼ì •(String to Date)ì„ í•´ì¤˜ì•¼ë§Œ í•¨. .. ê·€ì°¨ë‹ˆì¦˜ì˜ ì‹œì‘ : ì‚½ì§ˆ  1. ì‚½ì§ˆì˜ ì‹œì‘ 1-1. ì˜¤ë¼í´ì˜ DATEí˜• â†’ java.sql.Date ì˜ ê²½ìš°  mybatisì—ì„œëŠ” ìë™ì ìœ¼ë¡œ org.apache.ibatis.type.SqlDateTypeHandlerë¥¼ í˜¸ì¶œí•˜ê²Œë¨ mybatis 3 ë¬¸ì„œ ì°¸ê³  í•´ë‹¹ í•¸ë“¤ëŸ¬ì˜ ë‚´ë¶€ ë°ì´í„° ë³€í™˜ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŒ  @Override public Date getNullableResult(ResultSet rs, String columnName) throws SQLException { return rs.getDate(columnName); }  java.sql.ResultSet.getDate()ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ì‹¤ì œ &lsquo;yyyy-mm-dd&rsquo; ë§Œ ê°€ì ¸ì™€ ë¦¬í„´í•˜ê²Œë¨ (ì—¬ê¸°ì„œ ë””ë²„ê¹… í•´ë³´ë©´ rs.getTimestamp(columnName)ê°’ì€ ì‹œë¶„ì´ˆê¹Œì§€ ë‹¤ ë“¤ì–´ê°€ ìˆìŒ) ë”°ë¼ì„œ ì‹œê°„ê°’ì´ ì—†ëŠ” yyyy-mm-dd í˜•íƒœë¡œ ë¦¬í„´ì´ ë¨  1-2. ì˜¤ë¼í´ì˜ DATEí˜• â†’ java.util.Date ì˜ ê²½ìš°  mybatisì—ì„œëŠ” ìë™ì ìœ¼ë¡œ org.apache.ibatis.type.DateOnlyTypeHandlerë¥¼ í˜¸ì¶œí•˜ê²Œë¨ mybatis 3 ë¬¸ì„œ ì°¸ê³  í•´ë‹¹ í•¸ë“¤ëŸ¬ì˜ ë‚´ë¶€ ë°ì´í„° ë³€í™˜ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŒ  @Override public Date getNullableResult(ResultSet rs, String columnName) throws SQLException { java.sql.Date sqlDate = rs.getDate(columnName); if (sqlDate != null) { return new java.util.Date(sqlDate.getTime()); } return null; }  ìœ„ì˜ org.apache.ibatis.type.SqlDateTypeHandler ë³€í™˜ì½”ë“œì—ì„œ ë°œìƒí•œ ë¬¸ì œì ê³¼ ê°™ì´ yyyy-mm-dd ë§Œ ê°€ì ¸ì™€ì„œ java.sql.Date ê°ì²´ë¥¼ ë§Œë“¤ê³ , ì´ ì •ë³´ë¥¼ í† ëŒ€ë¡œ java.util.Date ê°ì²´ë¥¼ ë§Œë“¤ê²Œ ë˜ëŠ”ë° ì•ì„œ ì‹œê°„ê°’ì„ ëº€ ì •ë³´ë¡œ ë§Œë“¤ì–´ì¡Œê¸° ë•Œë¬¸ì— ê²°êµ­ ë™ì¼í•˜ê²Œ yyyy-mm-dd í˜•íƒœë¡œ ë¦¬í„´ì´ ë¨  2. ì‚½ì§ˆì™„ë£Œ, í•´ê²°ì˜ ì‹œì‘  ì˜¤ë¼í´ + mybatis í™˜ê²½ì—ì„œ Dateíƒ€ì…ì„ ë‹¤ë£¨ê¸° ìœ„í•´ì„œëŠ” íƒ€ì…í•¸ë“¤ëŸ¬ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ë§Œë“¤ì–´ì¤˜ì•¼ í•œë‹¤ëŠ”ê±¸ ì•Œê²Œë¨.  2-1. ì˜¤ë¼í´ì˜ DATEí˜• â†’ java.sql.Date ì˜ ê²½ìš°  ì•„ë˜ì²˜ëŸ¼ ì½”ë“œë¥¼ ì‘ì„±í•˜ì—¬ ì»¤ìŠ¤í…€ í•¸ë“¤ëŸ¬ë¥¼ ë§Œë“¤ì–´ ë“±ë¡ì„ ì‹œì¼œì¤€ë‹¤. mybatis-config.xml  &lt;typeHandlers&gt; &lt;typeHandler handler=&#34;com.naver.dbill.admin.common.handler.CustomDateHandler&#34;/&gt; &lt;/typeHandlers&gt;  CustomDateHandler.java  ... import java.sql.Date; ... public class CustomDateHandler extends BaseTypeHandler&lt;Date&gt; { ... @Override public Date getNullableResult(ResultSet rs, String columnName) throws SQLException { Timestamp sqlTimestamp = rs.getTimestamp(columnName); if (sqlTimestamp != null) { return new Date(sqlTimestamp.getTime()); } return null; } ... }  ìœ„ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ì‹¤í–‰í•´ë³´ë©´ ì •ìƒì ìœ¼ë¡œ ì‹œë¶„ì´ˆ ê°’ì´ ìˆëŠ” ì™„ì „í•œ Date í˜•íƒœë¥¼ ë³¼ìˆ˜ ìˆë‹¤.  2-2. ì˜¤ë¼í´ì˜ DATEí˜• â†’ java.util.Date ì˜ ê²½ìš°  ì•„ë˜ì²˜ëŸ¼ ì½”ë“œë¥¼ ì‘ì„±í•˜ì—¬ ì»¤ìŠ¤í…€ í•¸ë“¤ëŸ¬ë¥¼ ë§Œë“¤ì–´ ë“±ë¡ì„ ì‹œì¼œì¤€ë‹¤. ë‹¨, mybatis 3 ë¬¸ì„œë¥¼ ë³´ë©´ java.sql.Date ì™€ëŠ” ë‹¤ë¥´ê²Œ ê¸°ë³¸ìœ¼ë¡œ ì„¤ì •ëœ typeHandlerê°€ JDBCì— ë”°ë¼ 3ê°€ì§€ê°€ ìˆë‹¤. ë”°ë¼ì„œ ì‘ì„±í•œ ì»¤ìŠ¤í…€ í•¸ë“¤ëŸ¬ë¥¼ ì ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ëª…ì‹œì ìœ¼ë¡œ ìë°”íƒ€ì… ê³¼ JDBCíƒ€ì… ì„ ì ì–´ì¤˜ì•¼ ì •ìƒì ìœ¼ë¡œ ì˜¤ë²„ë¼ì´ë”©ì´ ë˜ì–´ í•´ë‹¹ í•¸ë“¤ëŸ¬ë¥¼ ì‚¬ìš©í•˜ê²Œ ëœë‹¤. mybatis-config.xml  &lt;typeHandlers&gt; &lt;typeHandler handler=&#34;com.naver.dbill.admin.common.handler.CustomDateHandler&#34; javaType=&#34;java.util.Date&#34; jdbcType=&#34;DATE&#34;/&gt; &lt;/typeHandlers&gt;  CustomDateHandler.java ëŠ” ìœ„ì™€ ë™ì¼í•˜ë‹¤. ( import java.util.Date; ì‚¬ìš©ìœ¼ë¡œ ë³€ê²½ )  ì‚½ì§ˆí•˜ë©° ì•Œê²Œëœ ë³´ë„ˆìŠ¤ ì§€ì‹  java.sql.Date ëŠ” java.util.Date ì„ ìƒì†ë°›ì•˜ë‹¤.  public class Date extends java.util.Date { }  ê²€ìƒ‰ì„ í•˜ë‹¤ë³´ë©´ ì•Œìˆ˜ìˆê² ì§€ë§Œ java.sql.Date ëŠ” JDBCë“±ì„ ì´ìš©í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ”ë° ì í•©í•˜ê³ , java.util.Date ì€ ë³´ë‹¤ ë²”ìš©ì ì¸ ë‚ ì§œë‚˜ ì‹œê°ì •ë³´ë¥¼ ë‹¤ë£°ë•Œ ì í•©í•˜ë‹¤ê³  í•œë‹¤. toString ë©”ì†Œë“œì˜ ë¦¬í„´ Format í˜•íƒœ  java.sql.Date : yyyy-mm-dd java.util.Date : EEE MMM dd HH:mm:ss zzz yyyy   mybatis ì—ì„œ í˜•ë³€í™˜ì€ mybatis 3 ë¬¸ì„œì— ë‚˜ì™€ìˆëŠ” ìë°”íƒ€ì…ê³¼ JDBCíƒ€ì…ì´ ì¼ì¹˜í•  ê²½ìš°ì— í•´ë‹¹ íƒ€ì… í•¸ë“¤ëŸ¬ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.  ì •ìƒí˜ ë‹˜ ì¡°ì–¸ ( http://d2.naver.com/helloworld/645609 ì‘ì„±í•˜ì‹ ë¶„ )  Oracleì˜ JDBC ë“œë¼ì´ë²„ê°€ ì˜ˆìƒ ë°–ìœ¼ë¡œ ë™ì‘í•˜ë„¤ìš”.]]></description></item></channel></rss>