<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Transaction - Tag - ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</title><link>https://taetaetae.github.io/tags/transaction/</link><description>Transaction - Tag - ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sun, 08 Jan 2017 17:19:30 +0000</lastBuildDate><atom:link href="https://taetaetae.github.io/tags/transaction/" rel="self" type="application/rss+xml"/><item><title>Spring Transactional ì„¤ì • ë° ì£¼ìš”ì†ì„±</title><link>https://taetaetae.github.io/2017/01/08/transactional-setting-and-property/</link><pubDate>Sun, 08 Jan 2017 17:19:30 +0000</pubDate><author>Author</author><guid>https://taetaetae.github.io/2017/01/08/transactional-setting-and-property/</guid><description><![CDATA[<div class="featured-image">
                <img src="/images/transactional-setting-and-property/transactional.png" referrerpolicy="no-referrer">
            </div>ì§€ë‚œë²ˆì—ëŠ” íŠ¸ëœì­ì…˜ì˜ ì„¤ì •ê°’ì— ëŒ€í•´ ì•Œì•„ë³¸ ë°” ìˆë‹¤. [ Spring Transaction ì˜µì…˜ ] ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì‹¤ì œë¡œ ìŠ¤í”„ë§ í™˜ê²½ì—ì„œ ì–´ë–¤ì‹ìœ¼ë¡œ ì„¤ì •í•´ì•¼ @Transactional ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í• ìˆ˜ ìˆëŠ”ì§€, ê·¸ë¦¬ê³  ì–´ë–¤ ì†ì„±ë“¤ì´ ìˆëŠ”ì§€ì— ëŒ€í•´ ì•Œì•„ë³´ê³ ì í•œë‹¤.ì„¤ì • ê¸°ì¡´ xmlë°©ì‹ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •ì„ í•œë‹¤.
&lt;bean id=&#34;transactionManager&#34; class=&#34;org.springframework.jdbc.datasource.DataSourceTransactionManager&#34;&gt; &lt;property name=&#34;dataSource&#34; ref=&#34;dataSource&#34;/&gt; &lt;/bean&gt; &lt;tx:annotation-driven transaction-manager=&#34;transactionManager&#34; proxy-target-class=&#34;true&#34;/&gt; í˜¹, JavaConfig ë°©ì‹ìœ¼ë¡œ ì„¤ì •í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í•œë‹¤.
@EnableTransactionManagement public class AppConfig { ... @Bean public PlatformTransactionManager transactionManager() throws URISyntaxException, GeneralSecurityException, ParseException, IOException { return new DataSourceTransactionManager(dataSource()); } } ìœ„ì™€ê°™ì´ ì„¤ì •ì„ í•´ì£¼ë©´ íŠ¸ëœì­ì…˜ì„ ì„¤ì •í•˜ê³ ì í•˜ëŠ” ê³³ ì–´ë””ì„œë“  @Transactional ì–´ë…¸í…Œì´ì…˜ì„ ì§€ì •í•´ì„œ ì ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.
public class UserService{ @Transactional public boolean insertUser(User user){ ... } } ì£¼ìš”ì†ì„± @Transactional ì–´ë…¸í…Œì´ì…˜ì˜ ì£¼ìš”ì†ì„±ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
   ì†ì„± ì„¤ ëª… ì‚¬ìš© ì˜ˆ     isolation Transactionì˜ isolation Level. ë³„ë„ë¡œ ì •ì˜í•˜ì§€ ì•Šìœ¼ë©´ DBì˜ Isolation Levelì„ ë”°ë¦„. @Transactional(isolation=Isolation.DEFAULT)   propagation íŠ¸ëœì­ì…˜ ì „íŒŒê·œì¹™ì„ ì •ì˜ , Default=REQURIED @Transactional(propagation=Propagation.REQUIRED)   readOnly í•´ë‹¹ Transactionì„ ì½ê¸° ì „ìš© ëª¨ë“œë¡œ ì²˜ë¦¬ (Default = false) @Transactional(readOnly = true)   rollbackFor ì •ì˜ëœ Exceptionì— ëŒ€í•´ì„œëŠ” rollbackì„ ìˆ˜í–‰ @Transactional(rollbackFor=Exception.class)   noRollbackFor ì •ì˜ëœ Exceptionì— ëŒ€í•´ì„œëŠ” rollbackì„ ìˆ˜í–‰í•˜ì§€ ì•ŠìŒ. @Transactional(noRollbackFor=Exception.class)   timeout ì§€ì •í•œ ì‹œê°„ ë‚´ì— í•´ë‹¹ ë©”ì†Œë“œ ìˆ˜í–‰ì´ ì™„ë£Œë˜ì§€ ì•Šì€ ê²½ìš° rollback ìˆ˜í–‰. -1ì¼ ê²½ìš° no timeout (Default = -1) @Transactional(timeout=10)    ë§ˆì¹˜ë©° ìì¹« ì˜ëª»í–ˆë‹¤ê°€ëŠ” ì›ì¹˜ì•ŠëŠ” íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì˜ëª»ëœ ê²°ê³¼ë¥¼ ì´ˆë˜í• ìˆ˜ ìˆê¸°ë•Œë¬¸ì— ê¸°ë³¸ê°’ì€ ìˆ™ì§€í•˜ëŠ”ê²Œ ì¢‹ì„ê²ƒ ê°™ë‹¤.]]></description></item><item><title>Spring Transaction ì˜µì…˜</title><link>https://taetaetae.github.io/2016/10/08/20161008/</link><pubDate>Sat, 08 Oct 2016 18:04:19 +0000</pubDate><author>Author</author><guid>https://taetaetae.github.io/2016/10/08/20161008/</guid><description><![CDATA[<div class="featured-image">
                <img src="/images/20161008/spring.png" referrerpolicy="no-referrer">
            </div>ìƒí™© ìŠ¤í”„ë§ í™˜ê²½ì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ DAO ë‚˜ BO ë ˆë²¨ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì½”ë”©ì„ í•˜ê²Œ ëœë‹¤.
@Transactional(isolation = Isolation.READ_COMMITTED, propagation = Propagation.REQUIRED, rollbackFor = Exception.class) public int method(int i) throws Exception { return sqlMapClient.delete(&#34;~~~~&#34;); } ë¬´ë¶„ë³„í•˜ê²Œ Ctrl+C,V ì‹ ê³µìœ¼ë¡œ íŠ¸ëœì­ì…˜ ì–´ë…¸í…Œì´ì…˜ì„ ê°€ì ¸ë‹¤ê°€ ì‚¬ìš©í• ìˆ˜ë„ ìˆê² ìœ¼ë‚˜, ê° ê°’ë“¤ì´ ì–´ë–¤ ì—­í™œì„ ì•„ëŠ”ì§€ì— ëŒ€í•´ ì•Œê³  ë„˜ì–´ê°ˆ í•„ìš”ì„±ì´ ìˆë‹¤.
@Transactional ìš°ì„  í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì„ ì ìš©í•˜ë©´ ì ìš©ëœ í´ë˜ìŠ¤ ë˜ëŠ” ë©”ì†Œë“œì— íŠ¸ëœì­ì…˜ì´ ì ìš©ëœë‹¤. ë”°ë¼ì„œ ë¡œì§ íë¦„ì— ë§ì¶”ì–´ ì „ì²´ì ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ì ìš©í• ê²ƒì¸ì§€, ì•„ë‹ˆë©´ íŠ¹ì • ë©”ì†Œë“œì— ì ìš©í• ê²ƒì¸ì§€ ì „ëµì„ ì˜ ì„¸ì›Œì•¼ í•œë‹¤.
isolation ê²©ë¦¬ìˆ˜ì¤€ì´ë¼ëŠ” ì˜µì…˜ì´ë‹¤. íŠ¸ëœì­ì…˜ì—ì„œ ì¼ê´€ì„±ì´ ì—†ëŠ” ë°ì´í„°ë¥¼ í—ˆìš©í•˜ë„ë¡ í•˜ëŠ” ìˆ˜ì¤€ì„ ë§í•˜ëŠ”ë° ì˜µì…˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
 READ_UNCOMMITTED (level 0)   íŠ¸ëœì­ì…˜ì— ì²˜ë¦¬ì¤‘ì¸ í˜¹ì€ ì•„ì§ ì»¤ë°‹ë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ ì½ëŠ” ê²ƒì„ í—ˆìš© ì–´ë–¤ ì‚¬ìš©ìê°€ Aë¼ëŠ” ë°ì´í„°ë¥¼ Bë¼ëŠ” ë°ì´í„°ë¡œ ë³€ê²½í•˜ëŠ” ë™ì•ˆ ë‹¤ë¥¸ ì‚¬ìš©ìëŠ” Bë¼ëŠ” ì•„ì§ ì™„ë£Œë˜ì§€ ì•Šì€(Uncommitted í˜¹ì€ Dirty) ë°ì´í„° Bë¥¼ ì½ì„ ìˆ˜ ìˆë‹¤.  Dirty read : ìœ„ì™€ ê°™ì´ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì²˜ë¦¬í•˜ëŠ” ì‘ì—…ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ëŠ”ë°ë„ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” í˜„ìƒì„ dirty read ë¼ê³  í•˜ë©°, READ UNCOMMITTED ê²©ë¦¬ìˆ˜ì¤€ì—ì„œë§Œ ì¼ì–´ë‚˜ëŠ” í˜„ìƒ
   READ_COMMITTED (level 1)   dirty read ë°©ì§€ : íŠ¸ëœì­ì…˜ì´ ì»¤ë°‹ë˜ì–´ í™•ì •ëœ ë°ì´í„°ë§Œì„ ì½ëŠ” ê²ƒì„ í—ˆìš© ì–´ë– í•œ ì‚¬ìš©ìê°€ Aë¼ëŠ” ë°ì´í„°ë¥¼ Bë¼ëŠ” ë°ì´í„°ë¡œ ë³€ê²½í•˜ëŠ” ë™ì•ˆ ë‹¤ë¥¸ ì‚¬ìš©ìëŠ” í•´ë‹¹ ë°ì´í„°ì— ì ‘ê·¼í•  ìˆ˜ ì—†ë‹¤.  REPEATABLE_READ (level 2)   íŠ¸ëœì­ì…˜ì´ ì™„ë£Œë  ë•Œê¹Œì§€ SELECT ë¬¸ì¥ì´ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ë°ì´í„°ì— shared lockì´ ê±¸ë¦¬ë¯€ë¡œ ë‹¤ë¥¸ ì‚¬ìš©ìëŠ” ê·¸ ì˜ì—­ì— í•´ë‹¹ë˜ëŠ” ë°ì´í„°ì— ëŒ€í•œ ìˆ˜ì •ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ì„ í–‰ íŠ¸ëœì­ì…˜ì´ ì½ì€ ë°ì´í„°ëŠ” íŠ¸ëœì­ì…˜ì´ ì¢…ë£Œë  ë•Œê¹Œì§€ í›„í–‰ íŠ¸ëœì­ì…˜ì´ ê°±ì‹ í•˜ê±°ë‚˜ ì‚­ì œí•˜ëŠ” ê²ƒì„ ë¶ˆí—ˆí•¨ìœ¼ë¡œì¨ ê°™ì€ ë°ì´í„°ë¥¼ ë‘ ë²ˆ ì¿¼ë¦¬í–ˆì„ ë•Œ ì¼ê´€ì„± ìˆëŠ” ê²°ê³¼ë¥¼ ë¦¬í„´í•¨  SERIALIZABLE (level 3)   ì™„ë²½í•œ ì½ê¸° ì¼ê´€ì„± ëª¨ë“œë¥¼ ì œê³µ ë°ì´í„°ì˜ ì¼ê´€ì„± ë° ë™ì‹œì„±ì„ ìœ„í•´ MVCC(Multi Version Concurrency Control)ì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ(MVCCëŠ” ë‹¤ì¤‘ ì‚¬ìš©ì ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ì„ ìœ„í•œ ê¸°ìˆ ë¡œ ë°ì´í„° ì¡°íšŒ ì‹œ LOCKì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ë°ì´í„°ì˜ ë²„ì „ì„ ê´€ë¦¬í•´ ë°ì´í„°ì˜ ì¼ê´€ì„± ë° ë™ì‹œì„±ì„ ë†’ì´ëŠ” ê¸°ìˆ ) íŠ¸ëœì­ì…˜ì´ ì™„ë£Œë  ë•Œê¹Œì§€ SELECT ë¬¸ì¥ì´ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ë°ì´í„°ì— shared lockì´ ê±¸ë¦¬ë¯€ë¡œ ë‹¤ë¥¸ ì‚¬ìš©ìëŠ” ê·¸ ì˜ì—­ì— í•´ë‹¹ë˜ëŠ” ë°ì´í„°ì— ëŒ€í•œ ìˆ˜ì • ë° ì…ë ¥ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤.  propagation ( ì „íŒŒì˜µì…˜)  REQUIRED : ë¶€ëª¨ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì‹¤í–‰í•˜ë©° ë¶€ëª¨ íŠ¸ëœì­ì…˜ì´ ì—†ì„ ê²½ìš° ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ì„ ìƒì„± REQUIRES_NEW : ë¶€ëª¨ íŠ¸ëœì­ì…˜ì„ ë¬´ì‹œí•˜ê³  ë¬´ì¡°ê±´ ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ì´ ìƒì„± SUPPORT : ë¶€ëª¨ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì‹¤í–‰í•˜ë©° ë¶€ëª¨ íŠ¸ëœì­ì…˜ì´ ì—†ì„ ê²½ìš° nontransactionallyë¡œ ì‹¤í–‰ MANDATORY : ë¶€ëª¨ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì‹¤í–‰ë˜ë©° ë¶€ëª¨ íŠ¸ëœì­ì…˜ì´ ì—†ì„ ê²½ìš° ì˜ˆì™¸ê°€ ë°œìƒ NOT_SUPPORT : nontransactionallyë¡œ ì‹¤í–‰í•˜ë©° ë¶€ëª¨ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì‹¤í–‰ë  ê²½ìš° ì¼ì‹œ ì •ì§€ NEVER : nontransactionallyë¡œ ì‹¤í–‰ë˜ë©° ë¶€ëª¨ íŠ¸ëœì­ì…˜ì´ ì¡´ì¬í•œë‹¤ë©´ ì˜ˆì™¸ê°€ ë°œìƒ NESTED : í•´ë‹¹ ë©”ì„œë“œê°€ ë¶€ëª¨ íŠ¸ëœì­ì…˜ì—ì„œ ì§„í–‰ë  ê²½ìš° ë³„ê°œë¡œ ì»¤ë°‹ë˜ê±°ë‚˜ ë¡¤ë°±ë  ìˆ˜ ìˆìŒ. ë‘˜ëŸ¬ì‹¼ íŠ¸ëœì­ì…˜ì´ ì—†ì„ ê²½ìš° REQUIREDì™€ ë™ì¼í•˜ê²Œ ì‘ë™  no-rollback-for - ì˜ˆì™¸ì²˜ë¦¬ (ê¸°ë³¸ê°’ : ì—†ìŒ) íŠ¹ì • ì˜ˆì™¸ê°€ ë°œìƒí•˜ë”ë¼ë„ ë¡¤ë°±ë˜ì§€ ì•Šë„ë¡ ì„¤ì •
ìŠ¤í”„ë§ ë°°ì¹˜ì—ì„œì˜ íŠ¸ëœì­ì…˜ (ë‚´ê°€ ë‹¹í–ˆë˜(?) ë¬¸ì œ) ìŠ¤í”„ë§ ë°°ì¹˜ì—ì„œëŠ” Tasklet ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ step ë‹¨ìœ„ íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ê³  ìˆë‹¤ê³  í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ jobì´ í•˜ë‚˜ì˜ tasklet ì˜ step ìœ¼ë¡œ ì‹¤í–‰í•˜ë‹¤ë³´ë‹ˆ ëª…ì‹œì ì´ì§„ ì•Šì§€ë§Œ ë‚´ë¶€ì ìœ¼ë¡œ ì „ì²´ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ê±¸ë ¤ìˆê²Œ ëœë‹¤. ë‚˜ê°™ì€ job ë‚´ DAO delete ë©”ì†Œë“œì—ì„œ @Transactional ì„¤ì •ì„ í•˜ê³  ê·¸ DAO ë©”ì†Œë“œë¥¼ ë°˜ë³µë¬¸ì— ì˜í•´ delete í•˜ëŠ” ë¡œì§ì„ ìˆ˜í–‰í•˜ëŠ” ë¶€ë¶„ì´ ìˆì—ˆëŠ”ë° ë¶€ëª¨ì˜ íŠ¸ëœì­ì…˜(taskletì—ì„œ ì„¤ì •ëœ íŠ¸ëœì­ì…˜)ìœ¼ë¡œ ì¸í•´ dao ë¥¼ ëª‡ë²ˆ í˜¸ì¶œí•˜ë˜ jobë‹¨ìœ„ë¡œ íŠ¸ë Œì ì…˜ì´ ê±¸ë¦¬ê²Œ ë˜ì—ˆë‹¤. (ê²°êµ­ íŠ¸ëœì­ì…˜ì€ ë°˜ë³µë¬¸ì´ ë‹¤ ëë‚˜ì•¼ ì ìš©ì´ ëœë‹¤ëŠ”ì .) ê·¸ëŸ¬ë‹¤ë³´ë‹ˆ ê°€ë” DB Query Lockì´ ê±¸ë ¸ëŠ”ë° DBë ˆë²¨ì—ì„œ undologë¥¼ ë‚¨ê¸°ëŠ”ê²Œ ë„ˆë¬´ ë¬´ê±°ì›Œì ¸ lockì´ ë°œìƒ
ë”°ë¼ì„œ ì „íŒŒì˜µì…˜ì„ ìˆ˜ì •í•´ì„œ í•´ë‹¹ ë¬¸ì œë¥¼ í•´ê²°í•˜ì˜€ë‹¤.
# ê¸°ì¡´ begin delete &lt; for ë°˜ë³µë¬¸ commit # ì „íŒŒì˜µì…˜ ìˆ˜ì • (ê¸°ì¡´ REQUIRES ì—ì„œ REQUIRES_NEW ìœ¼ë¡œ ìˆ˜ì •) for begin delete commit for end ]]></description></item></channel></rss>