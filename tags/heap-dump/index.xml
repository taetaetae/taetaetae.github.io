<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>heap dump - Tag - ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</title><link>https://taetaetae.github.io/tags/heap-dump/</link><description>heap dump - Tag - ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Thu, 10 Jan 2019 18:39:47 +0000</lastBuildDate><atom:link href="https://taetaetae.github.io/tags/heap-dump/" rel="self" type="application/rss+xml"/><item><title>Spring MVC Redirect ì²˜ë¦¬ì¤‘ì— ë°œìƒí•œ Out Of Memory ì›ì¸ ë¶„ì„í•˜ê¸°</title><link>https://taetaetae.github.io/2019/01/10/spring-redirect-oom/</link><pubDate>Thu, 10 Jan 2019 18:39:47 +0000</pubDate><author>Author</author><guid>https://taetaetae.github.io/2019/01/10/spring-redirect-oom/</guid><description><![CDATA[<div class="featured-image">
                <img src="/images/spring-redirect-oom/test1-pinpoint.jpg" referrerpolicy="no-referrer">
            </div>ì´ˆì°½ê¸° ì‹ ì…ì‹œì ˆì— ë°°ìš°ê±°ë‚˜ ì‚¬ìš©í–ˆë˜ ê¸°ìˆ ì ì¸ ë°©ë²•ë“¤ì´ ìˆë‹¤. ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ì™ ë§Œí•´ì„  ë‹¤ë¥¸ë°©ë²•ì€ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ í•˜ê³  ìŠµê´€ì²˜ëŸ¼ ê¸°ì¡´ì— ì‚¬ìš©í–ˆë˜ ë°©ë²•ì„ ê³ ìˆ˜í•˜ëŠ” ë²„ë¦‡ì´ ìˆë‹¤. ê·¸ ì´ìœ ëŠ” ê³¼ê±°ì— ì‚¬ìš©í–ˆì„ë•Œ ì•„ë¬´ íƒˆ ì—†ì´ ì˜ ë˜ì—ˆê¸° ë•Œë¬¸ì—, ê·¸ë¦¬ê³  ë¹ ë¥¸ êµ¬í˜„ ë•Œë¬¸ì´ë¼ëŠ” í•‘ê³„ì¼ ê²ƒ ê°™ë‹¤. ì´ëŸ¬í•œ ë²„ë¦‡ì€ ë¹„ë‹¨ ì´ ê¸€ì„ ì ê³ ìˆëŠ” í•„ì ë¿ë§Œì´ ì•„ë‹ˆë¼ ëŒ€ë¶€ë¶„ì˜ ê°œë°œìë“¤ì´ ê°€ì§€ê³  ìˆì„êº¼ë¼ ì¡°ì‹¬ìŠ¤ë ˆ ì¶”ì¸¡í•´ë³¸ë‹¤. (ì•„ë‹ˆë¼ë©´&hellip;ë”ìš± ë¶„ë°œ í•´ì•¼ê² ë‹¤&hellip;ã… ) ìµœê·¼ ìš´ì˜í•˜ê³  ìˆëŠ” ì„œë¹„ìŠ¤ì—ì„œ ì¥ì•  ìƒí™©ê¹Œì§€ ê°ˆìˆ˜ìˆëŠ” ìœ„í—˜í•œ ìƒí™©ì´ ìˆì—ˆëŠ”ë° íŒ€ë‚´ ì½”ë“œë¦¬ë·°ë¥¼ í†µí•´ ë¬¸ì œì ì„ íŒŒì•…í•  ìˆ˜ ìˆì—ˆë‹¤. ê·¸ ì›ì¸ì€ Spring MVC Controller ë ˆë²¨ì—ì„œ redirect ì²˜ë¦¬ë¥¼ í• ë•Œ returnê°’ì˜ Cardinalityê°€ ë†’ì„ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤ê³ &hellip;
@RequestMapping(value = &#34;/test&#34;, method = RequestMethod.GET) public String test() { String url = &#34;ì–´ë– í•œ ë¡œì§ì— ì˜í•´ ìƒì„±ë˜ëŠ” url&#34;; return &#34;redirect:&#34; + url; // &lt;- ìœ„í—˜ í¬ì¸íŠ¸! } ì´ ì½”ë“œê°€ ì™œ? ì–´ë””ê°€ ì–´ë•Œì„œ? ì´ì œê¹Œì§€ Controller ë ˆë²¨ì—ì„œ redirect ì²˜ë¦¬ë¥¼ í• ë•Œ ì•„ë¬´ìƒê°ì—†ì´ ìœ„ì— ìˆëŠ” ì½”ë“œ í˜•íƒœë¡œ êµ¬í˜„ì„ í–ˆëŠ”ë° ì €ëŸ¬í•œ ì½”ë“œ ë•Œë¬¸ì— OOMì´ ë°œìƒí•˜ì—¬ fullGC ê°€ ì—¬ëŸ¬ë²ˆ ë°œìƒí•˜ê³ , ì¼ì‹œì ìœ¼ë¡œ ì„œë¹„ìŠ¤ê°€ ì§€ì—°ë˜ëŠ” í˜„ìƒì´ ë°œìƒí–ˆë‹¤ê³  í•œë‹¤. ìì£¼ ì‚¬ìš©í•˜ë˜ ë°©ë²•ì´ì˜€ëŠ”ë° ì¥ì• ë¥¼ ìœ ë°œí• ìˆ˜ ìˆëŠ” ìœ„í—˜í•œ ë°©ë²•ì´ì˜€ë‹¤ë‹ˆ&hellip; ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì´ëŸ¬í•œ ë°©ë²•ì´ ì™œ ì˜ëª»ë˜ì—ˆëŠ”ì§€ ì‹¤ì œë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ëª¸ì†Œ(?) ì²´ê°ì„ í•´ë³´ê³ , ê·¸ëŸ¼ ì–´ë–¤ ë°©ë²•ìœ¼ë¡œ redirect ì²˜ë¦¬ë¥¼ í•´ì•¼ í•˜ëŠ”ê°€ì™€ ê°œì„ ì„ í•¨ìœ¼ë¡œì¨ ê¸°ì¡´ë°©ì‹ì— ë¹„í•´ ì–´ë–¤ì ì´ ì¢‹ì•„ì¡ŒëŠ”ì§€ì— ëŒ€í•´ì„œ ì •ë¦¬í•´ë³´ê³ ì í•œë‹¤.
 ë­”ê°€ ë‚´ê²ƒìœ¼ë¡œ ë§Œë“¤ê¸° ì‹œë¦¬ì¦ˆë¬¼ì´ ë‚˜ì˜¬ê²ƒë§Œ ê°™ì€ ëŠë‚Œì´ë‹¤&hellip;
 ê¸°ì¡´ë°©ì‹ì˜ ë¬¸ì œì  ì¬í˜„ ë° ë‹¤ì–‘í•œ ì›ì¸ë¶„ì„ ê¸°ì¡´ë°©ì‹ìœ¼ë¡œ í–ˆì„ë•Œ ì™œ OOMì´ ë°œìƒí–ˆì„ê¹Œ? ìš°ë¦¬ëŠ” ê°œë°œìì´ê¸° ë•Œë¬¸ì— ì´ëŸ°ì €ëŸ° ê¸€ë“¤ë§Œ ë³´ê³  ì¶”ì¸¡ í• ê²ƒì´ ì•„ë‹ˆë¼ ì§ì ‘ ì¬í˜„ì„ í•´ë³´ê³  ë‹¤ì–‘í•œ ì‹œê°ì—ì„œ ì›ì¸ë¶„ì„ì„ í•´ë³´ì. ë¨¼ì € ê¸°ë³¸ì ì¸ Spring MVC ë¼ˆëŒ€ë¥¼ ë§Œë“¤ê³  redirect í•˜ëŠ” return ê°’ì˜ Cardinalityê°€ ë†’ë„ë¡ random string ì„ ë§Œë“¤ì–´ ì£¼ë„ë¡ í•œë‹¤. ì¦‰, /randomì„ í˜¸ì¶œí•˜ë©´ /result/ETmHfowFkUì²˜ëŸ¼ random string ì´ ë§Œë“¤ì–´ ì§€ë©° redirect ì²˜ë¦¬ê°€ ë˜ëŠ” ë§¤ìš° ì‹¬í”Œí•œ êµ¬ì¡°ì´ë‹¤.
// Spring ë²„ì „ì€ 4.0.6.RELEASE @Controller @RequestMapping(&#34;/&#34;) public class TestController { @RequestMapping(value = &#34;random&#34;, method = RequestMethod.GET) public String random() { return &#34;redirect:result/&#34; + UUID.randomUUID(); } @RequestMapping(value = &#34;result/{message}&#34;, method = RequestMethod.GET) public String result(ModelMap model, @PathVariable String message) { model.addAttribute(&#34;message&#34;, message); return &#34;result&#34;; } } ë˜í•œ í•´ë‹¹ í”„ë¡œì íŠ¸ì—ì„œëŠ” AOPë¥¼ ì‚¬ìš©í•˜ê³  ìˆì—ˆê¸° ë•Œë¬¸ì— ê·¸ë•Œì™€ ë™ì¼í•œ ìƒí™©ìœ¼ë¡œ ì¬í˜„ì„ í•˜ê¸° ìœ„í•´ AOPê´€ë ¨ ì„¤ì •ë„ ì¶”ê°€í•´ì¤€ë‹¤.
@Configuration @EnableWebMvc @EnableAspectJAutoProxy @ComponentScan public class HelloWorldConfiguration { @Bean(name=&#34;HelloWorld&#34;) public ViewResolver viewResolver() { InternalResourceViewResolver viewResolver = new InternalResourceViewResolver(); viewResolver.setViewClass(JstlView.class); viewResolver.setPrefix(&#34;/WEB-INF/views/&#34;); viewResolver.setSuffix(&#34;.jsp&#34;); return viewResolver; } } ì´ë ‡ê²Œ í•œë’¤ tomcatìœ¼ë¡œ ìµœëŒ€/ìµœì†Œ ë©”ëª¨ë¦¬ë¥¼ 256mìœ¼ë¡œ ì„¤ì •í›„ í•´ë‹¹ ëª¨ë“ˆì„ ë„ì›Œì¤€ë‹¤. ê·¸ë‹¤ìŒ ë©”ëª¨ë¦¬ ìƒíƒœë¥¼ ë³´ê¸° ìœ„í•´ tomcatì— pinpointë¥¼ ì—°ë™í•˜ê³  ë§ˆì§€ë§‰ìœ¼ë¡œ í˜¸ì¶œí…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ nGrinderì„ ì„¤ì •í•´ì¤€ë‹¤. íŠ¹ë³„í•œ ì„¤ì •ì€ ì—†ê³  ìœ„ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ url (/random) ì„ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œí•˜ë„ë¡ í•˜ì˜€ë‹¤. nGrinderì„ ì„¤ì •í•˜ëŠ”ëŒ€ì—ëŠ” ì´ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ ì°¸ê³ í•´ì„œ ì„¤ì •í•˜ì˜€ë‹¤.
ì, ì´ì œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•´ë³´ì. (ë§ˆì¹˜ ìˆ˜ìˆ  ì§‘ë„í•˜ëŠ”ê²ƒ ê°™ì€ ê¸°ë¶„ìœ¼ë¡œ&hellip;ê°„í˜¸ì‚¬~ ì¹¼!)
 nGrinder nGrinderì˜ ê¸°ë³¸ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ urlë§Œ í•´ë‹¹ ì„œë²„ë¡œ í˜¸ì¶œë˜ë„ë¡ ë°”ê¿”ì£¼ê³  ì´ ê°€ìƒ ì‚¬ìš©ìëŠ” 2,000ìœ¼ë¡œ ì‹œê°„ì€ 5ë¶„ìœ¼ë¡œ ì„¤ì •í›„ì— í…ŒìŠ¤íŠ¸ ì‹œì‘ì„ í•˜ì˜€ë”ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ ê·¸ë˜í”„ë¥¼ ë³¼ìˆ˜ ìˆì—ˆë‹¤.   TPSê°€ ë¶ˆì•ˆì •í•´ì§€ë‹¤ê°€ ì–´ëŠì‹œì ë¶€í„° ë‚®ì•„ì§€ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ê²Œ ì„œë¹„ìŠ¤ ì˜€ë‹¤ë©´ ì‚¬ìš©ìê°€ ì ‘ì†í•˜ëŠ”ë° ë¶ˆí¸ì„ ëŠê¼ˆì„êº¼ë¼ ì¶”ì¸¡ì„ í•´ë³¸ë‹¤. ë˜í•œ ì•„ì£¼ ê°„ë‹¨í•œ random string ì„ ë¦¬í„´í•˜ëŠ” í˜ì´ì§€ ì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ì—ëŸ¬ ì‘ë‹µì´ ì ì§€ ì•Šì€ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.
pinpoint ë©”ëª¨ë¦¬ ìƒíƒœëŠ” ì–´ë–¤ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ pinpointë¥¼ í™•ì¸í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê·¸ë˜í”„ë¥¼ ë³¼ìˆ˜ ìˆì—ˆë‹¤.   ë³´ê¸°ë§Œí•´ë„ ì‹¬ì¥ì´ ë²Œë ë²Œë (?) ë›¸ ì •ë„ë¡œ ë¬´ì„œìš´ ê·¸ë¦¼ì´ë‹¤. ì‹¤ì œë¡œ ì„œë¹„ìŠ¤ì— (ì´ì •ë„ê¹Œì§„ ì•„ë‹ˆì˜€ì§€ë§Œ) ë¹„ìŠ·í•œ ìƒí™©ì´ ë°œìƒí–ˆì—ˆë‹¤. ë©”ëª¨ë¦¬ê°€ í…ŒìŠ¤íŠ¸ë¥¼ ì ì  í•˜ë©´ í• ìˆ˜ë¡ ì˜¬ë¼ê°€ë‹¤ê°€ fullGCê°€ ë°œìƒí•˜ë”ë‹ˆ ëŒ€ë‚˜ë¬´ ìˆ²ì— ìˆëŠ” ëŒ€ë‚˜ë¬´ë§ˆëƒ¥ fullGCê°€ ë¹¼ê³¡íˆ ë°œìƒí•˜ì˜€ë‹¤. (ì´ëŸ¬ë‹ˆ&hellip; í˜ì´ì§€ ì ‘ê·¼ì— ì§€ì—°ì´ ìƒê¸´ê²ƒ ê°™ë‹¤.]]></description></item></channel></rss>