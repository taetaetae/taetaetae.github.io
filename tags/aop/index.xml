<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>AOP - Tag - ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</title><link>https://taetaetae.github.io/tags/aop/</link><description>AOP - Tag - ğŸ‘¨â€ğŸ’»ê¿ˆê¾¸ëŠ” íƒœíƒœíƒœì˜ ê³µê°„</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sun, 30 Jun 2019 18:39:47 +0000</lastBuildDate><atom:link href="https://taetaetae.github.io/tags/aop/" rel="self" type="application/rss+xml"/><item><title>Springì—ì„œ Requestë¥¼ ìš°ì•„í•˜ê²Œ ë¡œê¹…í•˜ê¸°</title><link>https://taetaetae.github.io/2019/06/30/controller-common-logging/</link><pubDate>Sun, 30 Jun 2019 18:39:47 +0000</pubDate><author>Author</author><guid>https://taetaetae.github.io/2019/06/30/controller-common-logging/</guid><description><![CDATA[<div class="featured-image">
                <img src="/images/controller-common-logging/spring_boot_logging.png" referrerpolicy="no-referrer">
            </div>ìŠ¤í”„ë§ ê¸°ë°˜ì˜ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ë‹¤ ë³´ë©´ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ”ë° ë§¨ ì²˜ìŒì— ìœ„ì¹˜í•˜ê³  ìˆëŠ” Controller(ì´í•˜ ì»¨íŠ¸ë¡¤ëŸ¬)ë¼ëŠ” ë ˆì´ì–´ë¥¼ ë§Œë“¤ê²Œ ëœë‹¤. ê·¸ëŸ´ë•Œë©´ ì‚¬ìš©ìê°€ ì–´ë–¤ ìš”ì²­(Request)ì„ í•˜ì˜€ëŠ”ì§€ì— ëŒ€í•´ í™•ì¸ì´ í•„ìš”í•  ìˆ˜ ìˆë‹¤. ë¬¼ë¡  í™•ì¸ì„ ì•ˆí•´ë„ ë¬´ë°©í•˜ì§€ë§Œ ê°€ê¸‰ì  ë¡œê¹…ì€ ì‹œìŠ¤í…œ ë¡œì§ì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ” ë²”ìœ„ì—ì„œ ìµœëŒ€í•œ ë‹¤ì–‘í•˜ê²Œ ë¯¸ë¦¬ í•´ë‘ëŠ”ê²Œ ë‚˜ì¤‘ì— ìœ ì§€ë³´ìˆ˜ì‹œ í¸í•  ìˆ˜ ìˆë‹¤. (ì˜ˆì „ ì¡°ì§ì¥ë‹˜ê»˜ì„œ ë§ì”€í•˜ì‹ ê²Œ ì•„ì§ë„ ë¨¸ë¦¿ì†ì— ê½‰ ìë¦¬ì¡ê³  ìˆë‹¤&hellip;) ì•„~ì£¼ ì¼ë°˜ì ìœ¼ë¡œ, ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë©”ì†Œë“œ ë‹¨ìœ„ë¡œ íŒŒë¼ë¯¸í„°ë¥¼ ì§ì ‘ ë¡œê¹…í•˜ê²Œ ëœë‹¤.
@Slf4j @RestController public class SampleController { @GetMapping(&#34;/test1&#34;) public String test1(@RequestParam String id) { log.info(&#34;id : {}&#34;, id); return &#34;length : &#34; + id.length(); } } ì´ë ‡ê²Œ ë˜ë©´ ì‚¬ìš©ìê°€ GET /test1 ì´ë¼ëŠ” ìš”ì²­ì„ ë³´ë‚¼ë•Œ ì–´ë–¤ íŒŒë¼ë¯¸í„°ë¡œ í˜¸ì¶œí•˜ì˜€ëŠ”ì§€ì— ëŒ€í•´ ë¡œê¹…ì´ ë‚¨ê²Œ ë˜ëŠ”ë° í•­ìƒ log.info(&quot;id : {}&quot;, id); ê³¼ ê°™ì´ ìˆ˜ë™ìœ¼ë¡œ ë¡œê¹…ì„ ë‚¨ê²¨ì•¼ í•˜ëŠ” ë¶ˆí¸í•¨ì´ ìƒê¸´ë‹¤. ë¬¼ë¡  ê¼¼ê¼¼í•˜ê²Œ ë©”ì†Œë“œë§ˆë‹¤ ë¡œê¹…ì„ ì ì–´ì£¼ë©´ ì „í˜€ ë¬¸ì œë ê²Œ ì—†ì§€ë§Œ ì´ëŸ¬í•œ ì»¨íŠ¸ë¡¤ëŸ¬ ~ ë©”ì†Œë“œê°€ í•œë‘ê°œê°€ ì•„ë‹Œ ìˆ˜ì‹­ ë˜ëŠ” ìˆ˜ë°±ê°œì¼ ê²½ìš°ì—” ê·¸ë•Œë§ˆë‹¤ ë¡œê¹…ì„ ì ì–´ì¤˜ì•¼ í•˜ëŠ” ë¶ˆí¸í•¨ì´ ìˆì„ ìˆ˜ ìˆë‹¤. ë˜í•œ ìì¹« ê¹œë°•í•˜ê³  ë¡œê¹…ì„ ë¹¼ë¨¹ê³  ë°°í¬ë¥¼ í•˜ê²Œ ëœ ê²½ìš° ëª¨ë‹ˆí„°ë§ì‹œ ë¡œê¹…ì„ í•˜ì§€ ì•Šì•„ì„œ ë‹¤ì‹œ ë¡œê¹…í•˜ê³  ë°°í¬ë¥¼ í•˜ëŠ”, ë³„ê²ƒë„ ì•„ë‹Œë°(?) &ldquo;ì •ë§ ë¶ˆí¸í•œ&rdquo; ìƒí™©ì´ ìˆì„ ìˆ˜ ìˆë‹¤. ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì‚¬ìš©ìì˜ ìš”ì²­ì„ ëª¨ë‹ˆí„°ë§ í•˜ê¸° ìœ„í•´ ì»¨íŠ¸ë¡¤ëŸ¬ë§ˆë‹¤ ì½”ë“œë¥¼ ì‘ì„±í•´ê°€ë©° ë¡œê¹…ì„ í•˜ëŠ”ê²ƒì´ ì•„ë‹ˆë¼ HttpServletRequestWrapper ë¼ëŠ” ê²ƒê³¼ Filter, AOPë¥¼ ì´ìš©í•˜ì—¬ Requestì˜ ì •ë³´ë¥¼ í•œê³³ì—ì„œ ìš°ì•„í•˜ê²Œ ë¡œê¹…í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ê³ ì í•œë‹¤.
ìš”êµ¬ì‚¬í•­ ì™€ ê°œë°œí•˜ìì•„!ì¶œì²˜ : https://gfycat.com/ko/brightevilaoudad" ì™€ ê°œë°œí•˜ìì•„!
ì¶œì²˜ : https://gfycat.com/ko/brightevilaoudad  íˆ¬ìš°ì‚¬ê°€ í”ë“œëŠ” ë¹¨ê°„ ì²œì„ ë³´ë©° ëŒì§„í•˜ëŠ” í™©ì†Œì²˜ëŸ¼ (ì“°ê³ ë³´ë‹ˆ ë„ˆë¬´ TMI ê°™ë‹¤&hellip;.) ë‹¹ì¥ ì½”ë”©ì„ ì‹œì‘í•˜ë©° ê°œë°œì„ í•  ìˆ˜ë„ ìˆì§€ë§Œ ì •ì‘ ì›í•˜ëŠ” ê¸°ëŠ¥ì´ ë¬´ì—‡ì¸ì§€ ì²œì²œíˆ ì •ë¦¬í•˜ê³  ë„˜ì–´ê°ˆ í•„ìš”ê°€ ìˆëŠ” ê²ƒ ê°™ë‹¤. (ì–´ì©”ë• ì˜¤íˆë ¤ í›„ìê°€ ë” ë¹ ë¥¸ ê°œë°œì„ í•˜ê²Œ ë˜ëŠ”ê²ƒ ê°™ë‹¤.)
 GET, POST ë“± ë‹¤ì–‘í•œ http method ë¡œ êµ¬í˜„ëœ ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ì˜ íŒŒë¼ë¯¸í„°ì™€ ê¸°íƒ€ Request ì •ë³´ê°€ ë¡œê¹…ì´ ë˜ì•¼ í•œë‹¤. ì»¨íŠ¸ë¡¤ëŸ¬, ë©”ì†Œë“œê°€ ëŠ˜ì–´ë‚ ë•Œë§ˆë‹¤ ë³„ë„ì˜ ì½”ë“œ ì¶”ê°€ ì—†ì´ í•œê³³ì—ì„œ ê³µí†µì ìœ¼ë¡œ ë¡œê¹…ì´ ë˜ì•¼ í•œë‹¤. URL ì¤‘ íŠ¹ì • íŒ¨í„´ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì€ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ë¡œê¹…ì„ í•˜ê±°ë‚˜, ë¡œê¹…ì—ì„œ ì œì™¸í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. ì•ì„œ ë§í–ˆë“¯ ë‹¤ë¥¸ ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì— ì˜í–¥ì„ ì£¼ì§€ ì•Šì•„ì•¼ í•œë‹¤.  êµ¬í˜„í•˜ê¸° - Request ì˜ íŒŒë¼ë¯¸í„° ì •ë¦¬ Request ì˜ ëª¨ë“  ë¡œê¹…ì„ í•œê³³ì—ì„œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ filter(í•„í„°)ë¥¼ í™œìš©í•˜ì˜€ë‹¤. í•„í„°ëŠ” Dispatcher servletì˜ ì•ë‹¨ì— ìœ„ì¹˜í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ëª¨ë“  ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° ìš©ì´í•˜ë‹¤. ë¬¼ë¡  ì¸í„°ì…‰í„°ë¥¼ í™œìš©í•´ì„œë„ ë°©ë²•ì´ ìˆê² ì§€ë§Œ ë³¸ í¬ìŠ¤íŒ… ì—ì„œëŠ” í•„í„°ë¥¼ í™œìš©í•´ì„œ êµ¬í˜„í•˜ëŠ”ê²ƒì„ ëª©ì ìœ¼ë¡œ í•œë‹¤. (ì‚¬ì‹¤ ì¸í„°ì…‰í„°ë¡œ ëª‡ë²ˆ ì‹œë„í•´ë³´ë‹¤ê°€ ì‹¤íŒ¨í•´ì„œ&hellip;ìœ ìœ  )
Spring MVC Request Life Cycleì¶œì²˜ : https://justforchangesake.wordpress.com/2014/05/07/spring-mvc-request-life-cycle/" Spring MVC Request Life Cycle
ì¶œì²˜ : https://justforchangesake.wordpress.com/2014/05/07/spring-mvc-request-life-cycle/  Filterë¥¼ ë§Œë“¤ê¸° ì „ì— Filterì—ì„œ ì‚¬ìš©í•  ì£¼ìš” í•µì‹¬(?) í´ë˜ìŠ¤ê°€ í•„ìš”í•œë° HttpServletRequest ë¥¼ Wrapping í•´ì„œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ HttpServletRequestWrapperë¥¼ ìƒì†ë°›ëŠ” í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì. Request ì— ë‹´ê²¨ìˆëŠ” param ê³¼ bodyë¡œ ìš”ì²­ì´ ë“¤ì–´ì˜¬ ê²½ìš° bodyì— ìˆëŠ” ë‚´ìš©ì„ param ì— ë‹´ëŠ” ë¡œì§ì´ë‹¤. ì£¼ìš” ì„¤ëª…ì€ ì½”ë“œ ì•ˆì—ì„œ ì£¼ì„ìœ¼ë¡œ ì„¤ëª…í•˜ê² ë‹¤.
public class ReadableRequestWrapper extends HttpServletRequestWrapper { // ìƒì† 	private final Charset encoding; private byte[] rawData; private Map&lt;String, String[]&gt; params = new HashMap&lt;&gt;(); public ReadableRequestWrapper(HttpServletRequest request) { super(request); this.params.putAll(request.getParameterMap()); // ì›ë˜ì˜ íŒŒë¼ë¯¸í„°ë¥¼ ì €ì¥  String charEncoding = request.getCharacterEncoding(); // ì¸ì½”ë”© ì„¤ì • 	this.encoding = StringUtils.isBlank(charEncoding) ? StandardCharsets.UTF_8 : Charset.forName(charEncoding); try { InputStream is = request.getInputStream(); this.rawData = IOUtils.toByteArray(is); // InputStream ì„ ë³„ë„ë¡œ ì €ì¥í•œ ë‹¤ìŒ getReader() ì—ì„œ ìƒˆ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ìƒì„±  // body íŒŒì‹± 	String collect = this.getReader().lines().collect(Collectors.joining(System.lineSeparator())); if (StringUtils.isEmpty(collect)) { // body ê°€ ì—†ì„ê²½ìš° ë¡œê¹… ì œì™¸ 	return; } if (request.getContentType() != null &amp;&amp; request.]]></description></item></channel></rss>