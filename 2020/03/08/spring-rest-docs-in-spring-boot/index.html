<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>SpringRestDocs를 SpringBoot에 적용하기 -</title><meta property="og:url" content="https://taetaetae.github.io/2020/03/08/spring-rest-docs-in-spring-boot/"><meta property="og:site_name" content="My cool site"><meta property="og:title" content="SpringRestDocs를 SpringBoot에 적용하기"><meta property="og:description" content='API를 개발하고 제공하기 위해서는 그에 해당하는 API 명세를 작성해서 사용하는 곳에 전달하게 된다. 어떤 URL에 어떤 파라미터를 사용해서 어떻게 요청을 하면 어떤 결과를 응답으로 내려주는지에 대한 관련 정보들. 이러한 “API 문서” 를 제공하는 방식은 상황에 따라 다양한 방법으로 사용되곤 한다. API 코드와 해당 문서의 동기화가 자동으로 되어야 조금 편해질것 같다는 생각이 들었다. 출처 : https://dribbble.com/shots/3386291-API-Documentation 필자는 주로 “위키”(또는 일반 문서)를 활용해서 전달하곤 했었는데 API의 형태가 달라질 때마다 해당 위키를 수정해야만 하는 번거로움이 있었다. API 수정하면 위키도 수정하고. 깜박하고 위키 수정을 안하게 될 경우 왜 API 명세가 다르냐는 문의가… 그러다 알게된 Spring Rest Docs. (아무리 좋은 기술, 좋은 툴 이라 해도 실제로 본인이 필요로 하고 사용을 해야하는 이유가 생길때 비로소 빛을 발하는것 같은 느낌이다.)
이 포스팅에서는 swegger 와 비교하는 내용은 제외할까 한다. 워낙 유명한 두 양대 산맥(?)이라 검색해보면 각각의 장단점이 자세히 나와있기에…
최근 들어 TestCode 의 중요성을 절실하게 느끼고 있었고, TestCode 를 작성하면 자연스럽게 문서를 만들어 주는 부분이 가장 매력적이라고 생각이 들었다. 이를 반대로 생각하면, TestCode 가 실패할 경우 빌드 자체가 안되기에 어쩔수 없이 TestCode를 성공시켜야만 하고, 자연스럽게 정상적인(최신화 된) API 문서가 만들어지게 된다.
이번 포스팅에서는 다음과 같은 목표를 두고 실무에서 언제든지 활용이 가능한 약간의 “가이드” 같은 내용으로 작성해 보고자 한다.
Spring Boot 최신 버전에서 Spring Rest Docs 를 설정한다. 임의의 API 를 만들고 그에 따른 TestCase 를 작성한다. Spring.profile 에 따라 Spring Rest Docs Url 을 접근 가능/불가능 할 수 있게 한다. 물론 필자의 방법이 다를수도 있지만, 이러한 방법을 토대로 보다 더 우아하고 아름다운 방법을 알아갈수 있지 않을까 하는 기대로.
Spring Boot 에 Spring Rest Docs 셋팅하고 TestCase 작성하기 우선 Spring Boot 프로젝트를 만든다. https://start.spring.io/ 에서 만들어도 되고 IDE 에서 제공하는 툴로 만들어도 되고. 만드는 방식은 무방하다. 그 다음 필요한 dependency 를 추가해 준다.
<dependency> <groupId>org.springframework.restdocs</groupId> <artifactId>spring-restdocs-mockmvc</artifactId> <scope>test</scope> </dependency> 임의로 API를 작성하고
모델 @Getter @Setter public class Book { private Integer id; private String title; private String author; } 컨트롤러 @RestController public class BookController { @GetMapping("/book/{id}") public Book getABook(@PathVariable Integer id) { Book book = new Book(); book.setId(id); book.setTitle("spring rest docs in spring boot"); book.setAuthor("taetaetae"); return book; } } 해당 컨트롤러에 대한 TestCase 를 작성하자.
@WebMvcTest(BookController.class) @AutoConfigureRestDocs // (1) public class BookControllerTest { @Autowired private MockMvc mockMvc; // (2) @Test public void test_책을_조회하면_null이_아닌_객체를_리턴한다() throws Exception { mockMvc.perform(get("/book/{id}", 1) .accept(MediaType.APPLICATION_JSON)) .andDo(MockMvcResultHandlers.print()) .andExpect(MockMvcResultMatchers.status().isOk()) .andDo(document("book", // (3) pathParameters( parameterWithName("id").description("book unique id") // (4) ), responseFields( fieldWithPath("id").description("book unique id"), fieldWithPath("title").description("title"), fieldWithPath("author").description("author") ) )) .andExpect(jsonPath("$.id", is(notNullValue()))) // (5) .andExpect(jsonPath("$.title", is(notNullValue()))) .andExpect(jsonPath("$.author", is(notNullValue()))); } } (1) Spring Boot 에서는 해당 어노테이션으로 여러줄에 걸쳐 설정해야 할 Spring Rest Docs 관련 설정을 아주 간단하게 해결할 수 있게 된다. (참고)
(2) 공식 도큐먼트 에서는 4가지 방식을 말하고 있는데 이 포스팅 에서는 “MockMvc” 을 사용하고자 한다.
(3) “book” 이라는 identifier 를 지정하면 해당 TestCase 가 수행될때 snippets 가 생성되는데 해당 identifier 묶음으로 생성이 된다.'><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-03-08T23:16:59+00:00"><meta property="article:modified_time" content="2020-03-08T23:16:59+00:00"><meta property="article:tag" content="Spring Boot"><meta property="article:tag" content="Spring Rest Docs"><meta property="article:tag" content="Archives-2020"><meta property="og:image" content="https://taetaetae.github.io/images/spring-rest-docs-in-spring-boot/logo.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://taetaetae.github.io/images/spring-rest-docs-in-spring-boot/logo.jpg"><meta name=twitter:title content="SpringRestDocs를 SpringBoot에 적용하기"><meta name=twitter:description content='API를 개발하고 제공하기 위해서는 그에 해당하는 API 명세를 작성해서 사용하는 곳에 전달하게 된다. 어떤 URL에 어떤 파라미터를 사용해서 어떻게 요청을 하면 어떤 결과를 응답으로 내려주는지에 대한 관련 정보들. 이러한 “API 문서” 를 제공하는 방식은 상황에 따라 다양한 방법으로 사용되곤 한다. API 코드와 해당 문서의 동기화가 자동으로 되어야 조금 편해질것 같다는 생각이 들었다. 출처 : https://dribbble.com/shots/3386291-API-Documentation 필자는 주로 “위키”(또는 일반 문서)를 활용해서 전달하곤 했었는데 API의 형태가 달라질 때마다 해당 위키를 수정해야만 하는 번거로움이 있었다. API 수정하면 위키도 수정하고. 깜박하고 위키 수정을 안하게 될 경우 왜 API 명세가 다르냐는 문의가… 그러다 알게된 Spring Rest Docs. (아무리 좋은 기술, 좋은 툴 이라 해도 실제로 본인이 필요로 하고 사용을 해야하는 이유가 생길때 비로소 빛을 발하는것 같은 느낌이다.)
이 포스팅에서는 swegger 와 비교하는 내용은 제외할까 한다. 워낙 유명한 두 양대 산맥(?)이라 검색해보면 각각의 장단점이 자세히 나와있기에…
최근 들어 TestCode 의 중요성을 절실하게 느끼고 있었고, TestCode 를 작성하면 자연스럽게 문서를 만들어 주는 부분이 가장 매력적이라고 생각이 들었다. 이를 반대로 생각하면, TestCode 가 실패할 경우 빌드 자체가 안되기에 어쩔수 없이 TestCode를 성공시켜야만 하고, 자연스럽게 정상적인(최신화 된) API 문서가 만들어지게 된다.
이번 포스팅에서는 다음과 같은 목표를 두고 실무에서 언제든지 활용이 가능한 약간의 “가이드” 같은 내용으로 작성해 보고자 한다.
Spring Boot 최신 버전에서 Spring Rest Docs 를 설정한다. 임의의 API 를 만들고 그에 따른 TestCase 를 작성한다. Spring.profile 에 따라 Spring Rest Docs Url 을 접근 가능/불가능 할 수 있게 한다. 물론 필자의 방법이 다를수도 있지만, 이러한 방법을 토대로 보다 더 우아하고 아름다운 방법을 알아갈수 있지 않을까 하는 기대로.
Spring Boot 에 Spring Rest Docs 셋팅하고 TestCase 작성하기 우선 Spring Boot 프로젝트를 만든다. https://start.spring.io/ 에서 만들어도 되고 IDE 에서 제공하는 툴로 만들어도 되고. 만드는 방식은 무방하다. 그 다음 필요한 dependency 를 추가해 준다.
<dependency> <groupId>org.springframework.restdocs</groupId> <artifactId>spring-restdocs-mockmvc</artifactId> <scope>test</scope> </dependency> 임의로 API를 작성하고
모델 @Getter @Setter public class Book { private Integer id; private String title; private String author; } 컨트롤러 @RestController public class BookController { @GetMapping("/book/{id}") public Book getABook(@PathVariable Integer id) { Book book = new Book(); book.setId(id); book.setTitle("spring rest docs in spring boot"); book.setAuthor("taetaetae"); return book; } } 해당 컨트롤러에 대한 TestCase 를 작성하자.
@WebMvcTest(BookController.class) @AutoConfigureRestDocs // (1) public class BookControllerTest { @Autowired private MockMvc mockMvc; // (2) @Test public void test_책을_조회하면_null이_아닌_객체를_리턴한다() throws Exception { mockMvc.perform(get("/book/{id}", 1) .accept(MediaType.APPLICATION_JSON)) .andDo(MockMvcResultHandlers.print()) .andExpect(MockMvcResultMatchers.status().isOk()) .andDo(document("book", // (3) pathParameters( parameterWithName("id").description("book unique id") // (4) ), responseFields( fieldWithPath("id").description("book unique id"), fieldWithPath("title").description("title"), fieldWithPath("author").description("author") ) )) .andExpect(jsonPath("$.id", is(notNullValue()))) // (5) .andExpect(jsonPath("$.title", is(notNullValue()))) .andExpect(jsonPath("$.author", is(notNullValue()))); } } (1) Spring Boot 에서는 해당 어노테이션으로 여러줄에 걸쳐 설정해야 할 Spring Rest Docs 관련 설정을 아주 간단하게 해결할 수 있게 된다. (참고)
(2) 공식 도큐먼트 에서는 4가지 방식을 말하고 있는데 이 포스팅 에서는 “MockMvc” 을 사용하고자 한다.
(3) “book” 이라는 identifier 를 지정하면 해당 TestCase 가 수행될때 snippets 가 생성되는데 해당 identifier 묶음으로 생성이 된다.'><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><meta name=naver-site-verification content="2d1cdbb963ba178aa7cbf58500afc668cae1e645"><meta name=google-site-verification content="vvFCdv0-GuQhEWG8vtNJfA7YSY2HYQ1hpHh9P-a6Pv8"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://taetaetae.github.io/2020/03/08/spring-rest-docs-in-spring-boot/><link rel=prev href=https://taetaetae.github.io/2020/02/09/jupyter-install/><link rel=next href=https://taetaetae.github.io/2020/03/22/better-rest-template-1-retryable/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"SpringRestDocs를 SpringBoot에 적용하기","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/taetaetae.github.io\/2020\/03\/08\/spring-rest-docs-in-spring-boot\/"},"genre":"posts","keywords":"spring boot, spring rest docs, archives-2020","wordcount":992,"url":"https:\/\/taetaetae.github.io\/2020\/03\/08\/spring-rest-docs-in-spring-boot\/","datePublished":"2020-03-08T23:16:59+00:00","dateModified":"2020-03-08T23:16:59+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"태태태"},"description":""}</script></head><body data-header-desktop=auto data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title>👨‍💻꿈꾸는 태태태의 공간</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title>👨‍💻꿈꾸는 태태태의 공간</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">SpringRestDocs를 SpringBoot에 적용하기</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://taetaetae.github.io/resume title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>태태태</a></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tech</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2020-03-08>2020-03-08</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;992 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;5 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-rest-docs-in-spring-boot/logo.jpg data-srcset="/images/spring-rest-docs-in-spring-boot/logo.jpg, /images/spring-rest-docs-in-spring-boot/logo.jpg 1.5x, /images/spring-rest-docs-in-spring-boot/logo.jpg 2x" data-sizes=auto alt=/images/spring-rest-docs-in-spring-boot/logo.jpg title=/images/spring-rest-docs-in-spring-boot/logo.jpg></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#spring-boot-에-spring-rest-docs-셋팅하고-testcase-작성하기>Spring Boot 에 Spring Rest Docs 셋팅하고 TestCase 작성하기</a></li><li><a href=#springprofile-에-따라-spring-rest-docs-url-을-접근-가능불가능-할-수-있게-한다>Spring.profile 에 따라 Spring Rest Docs Url 을 접근 가능/불가능 할 수 있게 한다.</a></li><li><a href=#마치며>마치며</a></li></ul></nav></div></div><div class=content id=content><p>API를 개발하고 제공하기 위해서는 그에 해당하는 API 명세를 작성해서 사용하는 곳에 전달하게 된다. 어떤 URL에 어떤 파라미터를 사용해서 어떻게 요청을 하면 어떤 결과를 응답으로 내려주는지에 대한 관련 정보들. 이러한 &ldquo;API 문서&rdquo; 를 제공하는 방식은 상황에 따라 다양한 방법으로 사용되곤 한다.</p><figure><a class=lightgallery href=/images/spring-rest-docs-in-spring-boot/api-document.jpg title=/images/spring-rest-docs-in-spring-boot/api-document.jpg data-thumbnail=/images/spring-rest-docs-in-spring-boot/api-document.jpg data-sub-html="<h2>API 코드와 해당 문서의 동기화가 자동으로 되어야 조금 편해질것 같다는 생각이 들었다. 출처 : https://dribbble.com/shots/3386291-API-Documentation</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-rest-docs-in-spring-boot/api-document.jpg data-srcset="/images/spring-rest-docs-in-spring-boot/api-document.jpg, /images/spring-rest-docs-in-spring-boot/api-document.jpg 1.5x, /images/spring-rest-docs-in-spring-boot/api-document.jpg 2x" data-sizes=auto alt=/images/spring-rest-docs-in-spring-boot/api-document.jpg width=50%></a><figcaption class=image-caption>API 코드와 해당 문서의 동기화가 자동으로 되어야 조금 편해질것 같다는 생각이 들었다.<br>출처 : <a href=https://dribbble.com/shots/3386291-API-Documentation target=_blank rel="noopener noreffer">https://dribbble.com/shots/3386291-API-Documentation</a></figcaption></figure><p>필자는 주로 &ldquo;위키&rdquo;(또는 일반 문서)를 활용해서 전달하곤 했었는데 API의 형태가 달라질 때마다 해당 위키를 수정해야만 하는 번거로움이 있었다. API 수정하면 위키도 수정하고. 깜박하고 위키 수정을 안하게 될 경우 왜 API 명세가 다르냐는 문의가&mldr; 그러다 알게된 Spring Rest Docs. (아무리 좋은 기술, 좋은 툴 이라 해도 실제로 본인이 필요로 하고 사용을 해야하는 이유가 생길때 비로소 빛을 발하는것 같은 느낌이다.)</p><blockquote><p>이 포스팅에서는 swegger 와 비교하는 내용은 제외할까 한다. 워낙 유명한 두 양대 산맥(?)이라 검색해보면 각각의 장단점이 자세히 나와있기에&mldr;</p></blockquote><p>최근 들어 TestCode 의 중요성을 절실하게 느끼고 있었고, TestCode 를 작성하면 자연스럽게 문서를 만들어 주는 부분이 가장 매력적이라고 생각이 들었다. 이를 반대로 생각하면, TestCode 가 실패할 경우 빌드 자체가 안되기에 어쩔수 없이 TestCode를 성공시켜야만 하고, 자연스럽게 정상적인(최신화 된) API 문서가 만들어지게 된다.</p><p>이번 포스팅에서는 다음과 같은 목표를 두고 실무에서 언제든지 활용이 가능한 약간의 &ldquo;가이드&rdquo; 같은 내용으로 작성해 보고자 한다.</p><ul><li>Spring Boot 최신 버전에서 Spring Rest Docs 를 설정한다.</li><li>임의의 API 를 만들고 그에 따른 TestCase 를 작성한다.</li><li>Spring.profile 에 따라 Spring Rest Docs Url 을 접근 가능/불가능 할 수 있게 한다.</li></ul><p>물론 필자의 방법이 다를수도 있지만, 이러한 방법을 토대로 보다 더 우아하고 아름다운 방법을 알아갈수 있지 않을까 하는 기대로.</p><h2 id=spring-boot-에-spring-rest-docs-셋팅하고-testcase-작성하기>Spring Boot 에 Spring Rest Docs 셋팅하고 TestCase 작성하기</h2><p>우선 Spring Boot 프로젝트를 만든다. <a href=https://start.spring.io/ target=_blank rel="noopener noreffer">https://start.spring.io/</a> 에서 만들어도 되고 IDE 에서 제공하는 툴로 만들어도 되고. 만드는 방식은 무방하다. 그 다음 필요한 dependency 를 추가해 준다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;groupId&gt;</span>org.springframework.restdocs<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;artifactId&gt;</span>spring-restdocs-mockmvc<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;scope&gt;</span>test<span class=nt>&lt;/scope&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>임의로 API를 작성하고</p><ul><li>모델</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Getter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Book</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>title</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>author</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><ul><li>컨트롤러</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RestController</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>BookController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/book/{id}&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>Book</span><span class=w> </span><span class=nf>getABook</span><span class=p>(</span><span class=nd>@PathVariable</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>Book</span><span class=w> </span><span class=n>book</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Book</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>book</span><span class=p>.</span><span class=na>setId</span><span class=p>(</span><span class=n>id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>book</span><span class=p>.</span><span class=na>setTitle</span><span class=p>(</span><span class=s>&#34;spring rest docs in spring boot&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>book</span><span class=p>.</span><span class=na>setAuthor</span><span class=p>(</span><span class=s>&#34;taetaetae&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=n>book</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>해당 컨트롤러에 대한 TestCase 를 작성하자.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@WebMvcTest</span><span class=p>(</span><span class=n>BookController</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@AutoConfigureRestDocs</span><span class=w> </span><span class=c1>// (1)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>BookControllerTest</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>MockMvc</span><span class=w> </span><span class=n>mockMvc</span><span class=p>;</span><span class=w> </span><span class=c1>// (2)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>test_책을_조회하면_null이_아닌_객체를_리턴한다</span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>mockMvc</span><span class=p>.</span><span class=na>perform</span><span class=p>(</span><span class=n>get</span><span class=p>(</span><span class=s>&#34;/book/{id}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>accept</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>APPLICATION_JSON</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>andDo</span><span class=p>(</span><span class=n>MockMvcResultHandlers</span><span class=p>.</span><span class=na>print</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>andExpect</span><span class=p>(</span><span class=n>MockMvcResultMatchers</span><span class=p>.</span><span class=na>status</span><span class=p>().</span><span class=na>isOk</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>andDo</span><span class=p>(</span><span class=n>document</span><span class=p>(</span><span class=s>&#34;book&#34;</span><span class=p>,</span><span class=w> </span><span class=c1>// (3)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=n>pathParameters</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>					</span><span class=n>parameterWithName</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>).</span><span class=na>description</span><span class=p>(</span><span class=s>&#34;book unique id&#34;</span><span class=p>)</span><span class=w> </span><span class=c1>// (4)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=n>responseFields</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>					</span><span class=n>fieldWithPath</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>).</span><span class=na>description</span><span class=p>(</span><span class=s>&#34;book unique id&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>					</span><span class=n>fieldWithPath</span><span class=p>(</span><span class=s>&#34;title&#34;</span><span class=p>).</span><span class=na>description</span><span class=p>(</span><span class=s>&#34;title&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>					</span><span class=n>fieldWithPath</span><span class=p>(</span><span class=s>&#34;author&#34;</span><span class=p>).</span><span class=na>description</span><span class=p>(</span><span class=s>&#34;author&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>andExpect</span><span class=p>(</span><span class=n>jsonPath</span><span class=p>(</span><span class=s>&#34;$.id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>is</span><span class=p>(</span><span class=n>notNullValue</span><span class=p>())))</span><span class=w> </span><span class=c1>// (5)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>andExpect</span><span class=p>(</span><span class=n>jsonPath</span><span class=p>(</span><span class=s>&#34;$.title&#34;</span><span class=p>,</span><span class=w> </span><span class=n>is</span><span class=p>(</span><span class=n>notNullValue</span><span class=p>())))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>andExpect</span><span class=p>(</span><span class=n>jsonPath</span><span class=p>(</span><span class=s>&#34;$.author&#34;</span><span class=p>,</span><span class=w> </span><span class=n>is</span><span class=p>(</span><span class=n>notNullValue</span><span class=p>())));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>(1) Spring Boot 에서는 해당 어노테이션으로 여러줄에 걸쳐 설정해야 할 Spring Rest Docs 관련 설정을 아주 간단하게 해결할 수 있게 된다. (<a href=https://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/#boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs target=_blank rel="noopener noreffer">참고</a>)</p><p>(2) <a href=https://docs.spring.io/spring-restdocs/docs/2.0.4.RELEASE/reference/html5/#getting-started-sample-applications target=_blank rel="noopener noreffer">공식 도큐먼트</a> 에서는 4가지 방식을 말하고 있는데 이 포스팅 에서는 &ldquo;MockMvc&rdquo; 을 사용하고자 한다.</p><p>(3) &ldquo;book&rdquo; 이라는 identifier 를 지정하면 해당 TestCase 가 수행될때 snippets 가 생성되는데 해당 identifier 묶음으로 생성이 된다.</p><p>(4) request의 파라미터 필드, response의 필드의 설명을 적어줌으로써 이 정보를 가지고 snippets 가 생성이 되고 결과적으로 API 문서가 만들어 진다.</p><p>(5) 필자가 가장 매력적이라 생각되는 부분. 이 부분에서 테스트를 동시에 함으로써 응답이 달라지거나 잘못된 응답이 내려올 경우 TestCase가 실패하게 되어 API문서 또한 생성되지 않게 된다.</p><p>여기까지 한 뒤 빌드시 문서가 제대로 만들어 지도록 빌드 플러그인을 추가해 준다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;build&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;plugins&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;plugin&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;groupId&gt;</span>org.asciidoctor<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;artifactId&gt;</span>asciidoctor-maven-plugin<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;version&gt;</span>1.5.8<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;executions&gt;</span>
</span></span><span class=line><span class=cl>				<span class=nt>&lt;execution&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;id&gt;</span>generate-docs<span class=nt>&lt;/id&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;phase&gt;</span>prepare-package<span class=nt>&lt;/phase&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;goals&gt;</span>
</span></span><span class=line><span class=cl>						<span class=nt>&lt;goal&gt;</span>process-asciidoc<span class=nt>&lt;/goal&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;/goals&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;configuration&gt;</span>
</span></span><span class=line><span class=cl>						<span class=nt>&lt;backend&gt;</span>html<span class=nt>&lt;/backend&gt;</span>
</span></span><span class=line><span class=cl>						<span class=nt>&lt;doctype&gt;</span>book<span class=nt>&lt;/doctype&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;/configuration&gt;</span>
</span></span><span class=line><span class=cl>				<span class=nt>&lt;/execution&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;/executions&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;dependencies&gt;</span>
</span></span><span class=line><span class=cl>				<span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;groupId&gt;</span>org.springframework.restdocs<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;artifactId&gt;</span>spring-restdocs-asciidoctor<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;version&gt;</span>${spring-restdocs.version}<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>				<span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;/dependencies&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;/plugin&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/plugins&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/build&gt;</span>
</span></span></code></pre></div><p>빌드 플러그인에 의해 snippets를 조합하여 최종 API 문서가 만들어질수 있도록 src/main/ 하위에 asciidoc 이라는 폴더를 만들고 그 하위에 적당한 이름의 adoc 파일을 작성한다. 파일 이름은 나중에 만들어질 API문서의 html 파일 이름이 된다.</p><pre tabindex=0><code class=language-adoc data-lang=adoc>= RESTful Notes API Guide
:doctype: book
:icons: font
:source-highlighter: highlightjs
:toc: left
:toclevels: 4
:sectnums:
:sectlinks:
:sectanchors:

[[api]]
== Book Api
api 에 관련된 설명을 이곳에 적습니다.

include::{snippets}/book/curl-request.adoc[]
include::{snippets}/book/http-request.adoc[]
include::{snippets}/book/path-parameters.adoc[]
include::{snippets}/book/http-response.adoc[]
include::{snippets}/book/response-fields.adoc[]
</code></pre><p>위 adoc 파일 작성은 생소하니 <a href=https://asciidoctor.org/docs/user-manual/ target=_blank rel="noopener noreffer">asscidoc document</a>를 참조하면서 작성하면 도움이 될것같다.
그 다음 메이븐 빌드를 하면 TestCase 가 돌면서 snippets 이 생성되고 이를 가지고 빌드 플러그인에 의해 최종 API 문서가 생성이 된다.</p><pre tabindex=0><code>mvn install

[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running com.taetaetae.springrestdocs.books.BookControllerTest

...

[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] 
[INFO] --- asciidoctor-maven-plugin:1.5.8:process-asciidoc (generate-docs) @ spring-rest-docs ---
[INFO] Using &#39;UTF-8&#39; encoding to copy filtered resources.
[INFO] Copying 0 resource
[INFO] Rendered 경로\spring-rest-docs\src\main\asciidoc\index.adoc
</code></pre><p>그러면 target/generated-docs 하위에 index.html 파일이 생성된 것을 확인할 수 있다.</p><figure><a class=lightgallery href=/images/spring-rest-docs-in-spring-boot/index_html.jpg title=/images/spring-rest-docs-in-spring-boot/index_html.jpg data-thumbnail=/images/spring-rest-docs-in-spring-boot/index_html.jpg data-sub-html="<h2>생성된것을 볼 수 있고 자동으로 만들어진 snippets들도 볼 수 있다.</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-rest-docs-in-spring-boot/index_html.jpg data-srcset="/images/spring-rest-docs-in-spring-boot/index_html.jpg, /images/spring-rest-docs-in-spring-boot/index_html.jpg 1.5x, /images/spring-rest-docs-in-spring-boot/index_html.jpg 2x" data-sizes=auto alt=/images/spring-rest-docs-in-spring-boot/index_html.jpg width=30%></a><figcaption class=image-caption>생성된것을 볼 수 있고 자동으로 만들어진 snippets들도 볼 수 있다.</figcaption></figure><p>이 파일을 열어보면 다음처럼 이쁘게 문서가 작성된 것을 확인할 수 있다.</p><figure><a class=lightgallery href=/images/spring-rest-docs-in-spring-boot/docs.jpg title=/images/spring-rest-docs-in-spring-boot/docs.jpg data-thumbnail=/images/spring-rest-docs-in-spring-boot/docs.jpg data-sub-html="<h2>얼마든지 입맛에 맞게 수정이 가능하다.</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/spring-rest-docs-in-spring-boot/docs.jpg data-srcset="/images/spring-rest-docs-in-spring-boot/docs.jpg, /images/spring-rest-docs-in-spring-boot/docs.jpg 1.5x, /images/spring-rest-docs-in-spring-boot/docs.jpg 2x" data-sizes=auto alt=/images/spring-rest-docs-in-spring-boot/docs.jpg width=80%></a><figcaption class=image-caption>얼마든지 입맛에 맞게 수정이 가능하다.</figcaption></figure><p>그러면 이 파일을 어떻게 사용하는 곳에 제공할 수 있을까? html 만 따로 전달해야 할까? 메이븐 플러그인 중 &ldquo;maven-resources-plugin"을 활용하여 API서버를 띄우면 외부에서 URL 로 접근할 수 있도록 설정해보자.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;build&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;plugins&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;plugin&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;artifactId&gt;</span>maven-resources-plugin<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;version&gt;</span>2.7<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;executions&gt;</span>
</span></span><span class=line><span class=cl>				<span class=nt>&lt;execution&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;id&gt;</span>copy-resources<span class=nt>&lt;/id&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;phase&gt;</span>prepare-package<span class=nt>&lt;/phase&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;goals&gt;</span>
</span></span><span class=line><span class=cl>						<span class=nt>&lt;goal&gt;</span>copy-resources<span class=nt>&lt;/goal&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;/goals&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;configuration&gt;</span>
</span></span><span class=line><span class=cl>						<span class=nt>&lt;outputDirectory&gt;</span>
</span></span><span class=line><span class=cl>							${project.build.outputDirectory}/static/docs
</span></span><span class=line><span class=cl>						<span class=nt>&lt;/outputDirectory&gt;</span>
</span></span><span class=line><span class=cl>						<span class=nt>&lt;resources&gt;</span>
</span></span><span class=line><span class=cl>							<span class=nt>&lt;resource&gt;</span>
</span></span><span class=line><span class=cl>								<span class=nt>&lt;directory&gt;</span>
</span></span><span class=line><span class=cl>									${project.build.directory}/generated-docs
</span></span><span class=line><span class=cl>								<span class=nt>&lt;/directory&gt;</span>
</span></span><span class=line><span class=cl>							<span class=nt>&lt;/resource&gt;</span>
</span></span><span class=line><span class=cl>						<span class=nt>&lt;/resources&gt;</span>
</span></span><span class=line><span class=cl>					<span class=nt>&lt;/configuration&gt;</span>
</span></span><span class=line><span class=cl>				<span class=nt>&lt;/execution&gt;</span>
</span></span><span class=line><span class=cl>			<span class=nt>&lt;/executions&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;/plugin&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/plugins&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/build&gt;</span>
</span></span></code></pre></div><p>쉽게말해, 만들어진 문서를 특정 경로로 복사하게 되면 외부에서도 해당 경로로 접근시 볼 수 있게 된다. 지금은 &ldquo;{domain}/docs/index.html&rdquo; 을 접근하면 문서를 볼 수 있다.</p><h2 id=springprofile-에-따라-spring-rest-docs-url-을-접근-가능불가능-할-수-있게-한다>Spring.profile 에 따라 Spring Rest Docs Url 을 접근 가능/불가능 할 수 있게 한다.</h2><p>필요에 따라 운영환경에서는 해당 API 명세를 보여주게 되면 보안상으로 좋지 못하므로 API 문서의 접근을 막아야 한다. 뭔가 아주 간단하게 spring boot 의 설정을 통해 처리 할 수 있을꺼라 생각했지만, 아무리 찾아봐도 그런 기능은 없어보인다.ㅠㅠ 어쩔수 없이 필터를 추가하여 해당 url을 운영환경에서는 FORBIDDEN 처리를 해보도록 하자.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Component</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@WebFilter</span><span class=p>(</span><span class=n>urlPatterns</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;/docs/index.html&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>SpringRestDocsAccessFilter</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Filter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Value</span><span class=p>(</span><span class=s>&#34;${spring.profiles.active}&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>phase</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>init</span><span class=p>(</span><span class=n>FilterConfig</span><span class=w> </span><span class=n>filterConfig</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>doFilter</span><span class=p>(</span><span class=n>ServletRequest</span><span class=w> </span><span class=n>servletRequest</span><span class=p>,</span><span class=w> </span><span class=n>ServletResponse</span><span class=w> </span><span class=n>servletResponse</span><span class=p>,</span><span class=w> </span><span class=n>FilterChain</span><span class=w> </span><span class=n>filterChain</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=kd>throws</span><span class=w> </span><span class=n>IOException</span><span class=p>,</span><span class=w> </span><span class=n>ServletException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>StringUtils</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=s>&#34;release&#34;</span><span class=p>,</span><span class=w> </span><span class=n>phase</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=c1>// (1)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>HttpServletResponse</span><span class=p>)</span><span class=n>servletResponse</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=n>response</span><span class=p>.</span><span class=na>sendError</span><span class=p>(</span><span class=n>HttpServletResponse</span><span class=p>.</span><span class=na>SC_FORBIDDEN</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=n>filterChain</span><span class=p>.</span><span class=na>doFilter</span><span class=p>(</span><span class=n>servletRequest</span><span class=p>,</span><span class=w> </span><span class=n>response</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>filterChain</span><span class=p>.</span><span class=na>doFilter</span><span class=p>(</span><span class=n>servletRequest</span><span class=p>,</span><span class=w> </span><span class=n>servletResponse</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>destroy</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>(1) spring profile 이 release 일 경우 일부러 FORBIDDEN 처리를 해준다.</p><p>이렇게 되면 개발환경에서만 접근이 가능하고 운영환경에서는 접근이 불가능한, 테스트 케이스를 성공한 동기화 + 자동화 된 API 문서를 만들 수 있게 되었다.</p><h2 id=마치며>마치며</h2><p>언제나 그렇듯, 초기 설정은 실제 비즈니스 로직 개발보다 훨씬 공수가 더 드는 건 어쩔 수없다. 하지만 약간의 노력으로 안정되고 자동화된 개발 프로세스를 구축한다면 그 작은 날갯짓이 나중엔 큰 바람을 일으킬 수 있지 않을까 하는 기대를 해본다.</p><p>참, 위에서 만든 코드는 <a href=https://github.com/taetaetae/SpringRestDocs-In-SpringBoot target=_blank rel="noopener noreffer">Github</a> 에 있으니 참고 바란다.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2020-03-08</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://taetaetae.github.io/2020/03/08/spring-rest-docs-in-spring-boot/ data-title="SpringRestDocs를 SpringBoot에 적용하기" data-hashtags="spring boot,spring rest docs,archives-2020"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://taetaetae.github.io/2020/03/08/spring-rest-docs-in-spring-boot/ data-hashtag="spring boot"><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://taetaetae.github.io/2020/03/08/spring-rest-docs-in-spring-boot/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://taetaetae.github.io/2020/03/08/spring-rest-docs-in-spring-boot/ data-title="SpringRestDocs를 SpringBoot에 적용하기"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://taetaetae.github.io/2020/03/08/spring-rest-docs-in-spring-boot/ data-title="SpringRestDocs를 SpringBoot에 적용하기"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://taetaetae.github.io/2020/03/08/spring-rest-docs-in-spring-boot/ data-title="SpringRestDocs를 SpringBoot에 적용하기" data-image=/images/spring-rest-docs-in-spring-boot/logo.jpg><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Blogger" data-sharer=blogger data-url=https://taetaetae.github.io/2020/03/08/spring-rest-docs-in-spring-boot/ data-title="SpringRestDocs를 SpringBoot에 적용하기" data-description><i class="fab fa-blogger fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/spring-boot/>Spring Boot</a>,&nbsp;<a href=/tags/spring-rest-docs/>Spring Rest Docs</a>,&nbsp;<a href=/tags/archives-2020/>Archives-2020</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2020/02/09/jupyter-install/ class=prev rel=prev title="Jupyter 설치하고 원격접속까지 (for 파.알.못)"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Jupyter 설치하고 원격접속까지 (for 파.알.못)</a>
<a href=/2020/03/22/better-rest-template-1-retryable/ class=next rel=next title="조금 더 괜찮은 Rest Template 1부 - Retryable">조금 더 괜찮은 Rest Template 1부 - Retryable<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=utterances class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.147.9">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2016 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://taetaetae.github.io/resume target=_blank>태태태</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:500},comment:{utterances:{darkTheme:"github-dark",issueTerm:"pathname",label:"Comment",lightTheme:"github-light",repo:"taetaetae/blog-comment"}},lightgallery:!0}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-86432198-1",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-86432198-1" async></script></body></html>